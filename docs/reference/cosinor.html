<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Functions for analysis of circadian or diurnal data — cosinor • psych</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>

<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">psych</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Functions for analysis of circadian or diurnal data</h1>
    </div>

    
    <p>Circadian data are periodic with a phase of 24 hours. These functions  find the best fitting phase angle (cosinor), the circular mean,  circular correlation with circadian data, and the linear by circular correlation</p>
    

    <pre class="usage"><span class='fu'>cosinor</span>(<span class='no'>angle</span>,<span class='kw'>x</span><span class='kw'>=</span><span class='kw'>NULL</span>,<span class='kw'>code</span><span class='kw'>=</span><span class='kw'>NULL</span>,<span class='kw'>data</span><span class='kw'>=</span><span class='kw'>NULL</span>,<span class='kw'>hours</span><span class='kw'>=</span><span class='fl'>TRUE</span>,<span class='kw'>period</span><span class='kw'>=</span><span class='fl'>24</span>,
            <span class='kw'>plot</span><span class='kw'>=</span><span class='fl'>FALSE</span>,<span class='kw'>opti</span><span class='kw'>=</span><span class='fl'>FALSE</span>,<span class='kw'>na.rm</span><span class='kw'>=</span><span class='fl'>TRUE</span>)
<span class='fu'>cosinor.plot</span>(<span class='no'>angle</span>,<span class='kw'>x</span><span class='kw'>=</span><span class='kw'>NULL</span>,<span class='kw'>data</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>IDloc</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>ID</span><span class='kw'>=</span><span class='kw'>NULL</span>,<span class='kw'>hours</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>period</span><span class='kw'>=</span><span class='fl'>24</span>,
 <span class='kw'>na.rm</span><span class='kw'>=</span><span class='fl'>TRUE</span>,<span class='kw'>ylim</span><span class='kw'>=</span><span class='kw'>NULL</span>,<span class='kw'>ylab</span><span class='kw'>=</span><span class='st'>"observed"</span>,<span class='kw'>xlab</span><span class='kw'>=</span><span class='st'>"Time (double plotted)"</span>,
 <span class='kw'>main</span><span class='kw'>=</span><span class='st'>"Cosine fit"</span>,<span class='kw'>add</span><span class='kw'>=</span><span class='fl'>FALSE</span>,<span class='kw'>multi</span><span class='kw'>=</span><span class='fl'>FALSE</span>,<span class='kw'>typ</span><span class='kw'>=</span><span class='st'>"l"</span>,<span class='no'>...</span>)
 <span class='fu'>cosinor.period</span>(<span class='no'>angle</span>,<span class='kw'>x</span><span class='kw'>=</span><span class='kw'>NULL</span>,<span class='kw'>code</span><span class='kw'>=</span><span class='kw'>NULL</span>,<span class='kw'>data</span><span class='kw'>=</span><span class='kw'>NULL</span>,<span class='kw'>hours</span><span class='kw'>=</span><span class='fl'>TRUE</span>,<span class='kw'>period</span><span class='kw'>=</span><span class='fu'>seq</span>(<span class='fl'>23</span>,<span class='fl'>26</span>,<span class='fl'>1</span>),
            <span class='kw'>plot</span><span class='kw'>=</span><span class='fl'>FALSE</span>,<span class='kw'>opti</span><span class='kw'>=</span><span class='fl'>FALSE</span>,<span class='kw'>na.rm</span><span class='kw'>=</span><span class='fl'>TRUE</span>)
<span class='fu'>circadian.phase</span>(<span class='no'>angle</span>,<span class='kw'>x</span><span class='kw'>=</span><span class='kw'>NULL</span>,<span class='kw'>code</span><span class='kw'>=</span><span class='kw'>NULL</span>,<span class='kw'>data</span><span class='kw'>=</span><span class='kw'>NULL</span>,<span class='kw'>hours</span><span class='kw'>=</span><span class='fl'>TRUE</span>,<span class='kw'>period</span><span class='kw'>=</span><span class='fl'>24</span>,
            <span class='kw'>plot</span><span class='kw'>=</span><span class='fl'>FALSE</span>,<span class='kw'>opti</span><span class='kw'>=</span><span class='fl'>FALSE</span>,<span class='kw'>na.rm</span><span class='kw'>=</span><span class='fl'>TRUE</span>)
<span class='fu'>circadian.mean</span>(<span class='no'>angle</span>,<span class='kw'>data</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>hours</span><span class='kw'>=</span><span class='fl'>TRUE</span>,<span class='kw'>na.rm</span><span class='kw'>=</span><span class='fl'>TRUE</span>)
<span class='fu'>circadian.sd</span>(<span class='no'>angle</span>,<span class='kw'>data</span><span class='kw'>=</span><span class='kw'>NULL</span>,<span class='kw'>hours</span><span class='kw'>=</span><span class='fl'>TRUE</span>,<span class='kw'>na.rm</span><span class='kw'>=</span><span class='fl'>TRUE</span>)
<span class='fu'>circadian.stats</span>(<span class='no'>angle</span>,<span class='kw'>data</span><span class='kw'>=</span><span class='kw'>NULL</span>,<span class='kw'>hours</span><span class='kw'>=</span><span class='fl'>TRUE</span>,<span class='kw'>na.rm</span><span class='kw'>=</span><span class='fl'>TRUE</span>)
<span class='fu'>circadian.F</span>(<span class='no'>angle</span>,<span class='no'>group</span>,<span class='kw'>data</span><span class='kw'>=</span><span class='kw'>NULL</span>,<span class='kw'>hours</span><span class='kw'>=</span><span class='fl'>TRUE</span>,<span class='kw'>na.rm</span><span class='kw'>=</span><span class='fl'>TRUE</span>)
<span class='fu'>circadian.reliability</span>(<span class='no'>angle</span>,<span class='kw'>x</span><span class='kw'>=</span><span class='kw'>NULL</span>,<span class='kw'>code</span><span class='kw'>=</span><span class='kw'>NULL</span>,<span class='kw'>data</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,<span class='kw'>min</span><span class='kw'>=</span><span class='fl'>16</span>,
         <span class='kw'>oddeven</span><span class='kw'>=</span><span class='fl'>FALSE</span>, <span class='kw'>hours</span><span class='kw'>=</span><span class='fl'>TRUE</span>,<span class='kw'>period</span><span class='kw'>=</span><span class='fl'>24</span>,<span class='kw'>plot</span><span class='kw'>=</span><span class='fl'>FALSE</span>,<span class='kw'>opti</span><span class='kw'>=</span><span class='fl'>FALSE</span>,<span class='kw'>na.rm</span><span class='kw'>=</span><span class='fl'>TRUE</span>)
<span class='fu'>circular.mean</span>(<span class='no'>angle</span>,<span class='kw'>na.rm</span><span class='kw'>=</span><span class='fl'>TRUE</span>) <span class='co'>#angles in radians</span>
<span class='fu'>circadian.cor</span>(<span class='no'>angle</span>,<span class='kw'>data</span><span class='kw'>=</span><span class='kw'>NULL</span>,<span class='kw'>hours</span><span class='kw'>=</span><span class='fl'>TRUE</span>,<span class='kw'>na.rm</span><span class='kw'>=</span><span class='fl'>TRUE</span>)  <span class='co'>#angles in radians</span>
<span class='fu'>circular.cor</span>(<span class='no'>angle</span>,<span class='kw'>na.rm</span><span class='kw'>=</span><span class='fl'>TRUE</span>) <span class='co'>#angles in radians</span>
<span class='fu'>circadian.linear.cor</span>(<span class='no'>angle</span>,<span class='kw'>x</span><span class='kw'>=</span><span class='kw'>NULL</span>,<span class='kw'>data</span><span class='kw'>=</span><span class='kw'>NULL</span>,<span class='kw'>hours</span><span class='kw'>=</span><span class='fl'>TRUE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>angle</th>
      <td><p>A data frame or matrix of observed values with the time of day as the first value (unless specified in code) angle can be specified either as hours or as radians)</p></td>
    </tr>
    <tr>
      <th>code</th>
      <td><p>A subject identification variable</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>A matrix or data frame of data.  If specified, then angle and code are variable names (or locations).  See examples.</p></td>
    </tr>
    <tr>
      <th>group</th>
      <td><p>If doing comparisons by groups, specify the group code</p></td>
    </tr>
    <tr>
      <th>min</th>
      <td><p>The minimum number of observations per subject to use when finding split half reliabilities.</p></td>
    </tr>
    <tr>
      <th>oddeven</th>
      <td><p>Reliabilities are based upon odd and even items (TRUE) or first vs. last half (FALSE).  Default is first and last half.</p></td>
    </tr>
    <tr>
      <th>period</th>
      <td><p>Although time of day is assumed to have a 24 hour rhythm, other rhythms may be fit. If calling cosinor.period, a range may be specified.</p></td>
    </tr>
    <tr>
      <th>IDloc</th>
      <td><p>Which column number is the ID field</p></td>
    </tr>
    <tr>
      <th>ID</th>
      <td><p>What specific subject number should be plotted for one variable</p></td>
    </tr>
    <tr>
      <th>plot</th>
      <td><p>if TRUE, then plot the first variable (angle)</p></td>
    </tr>
    <tr>
      <th>opti</th>
      <td><p>opti=TRUE: iterative optimization (slow) or opti=FALSE: linear fitting (fast)</p></td>
    </tr>
    <tr>
      <th>hours</th>
      <td><p>If TRUE, measures are in 24 hours to the day, otherwise, radians</p></td>
    </tr>
    <tr>
      <th>x</th>
      <td><p>A set of external variables to correlate with the phase angles</p></td>
    </tr>
    <tr>
      <th>na.rm</th>
      <td><p>Should missing data be removed?</p></td>
    </tr>
    <tr>
      <th>ylim</th>
      <td><p>Specify the range of the y axis if the defaults don't work</p></td>
    </tr>
    <tr>
      <th>ylab</th>
      <td><p>The label of the yaxis</p></td>
    </tr>
    <tr>
      <th>xlab</th>
      <td><p>Labels for the x axis</p></td>
    </tr>
    <tr>
      <th>main</th>
      <td><p>the title of the graphic</p></td>
    </tr>
    <tr>
      <th>add</th>
      <td><p>If doing multiple (spagetti) plots, set add = TRUE for the second and beyond plots</p></td>
    </tr>
    <tr>
      <th>multi</th>
      <td><p>If doing multiple (spagetti) plots, set multi=TRUE for the first and subsequent plots</p></td>
    </tr>
    <tr>
      <th>typ</th>
      <td><p>Pass the line type to graphics</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>any other graphic parameters to pass</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>When data represent angles (such as the hours of peak alertness or peak tension during the day), we need to apply circular statistics rather than the more normal linear statistics (see Jammalamadaka (2006) for a very clear set of examples of circular statistics). The generalization of the mean to circular data is to convert each angle into a vector, average the x and y coordinates, and convert the result back to an angle. A statistic that represents the compactness of the observations is R which is the (normalized) vector length found by adding all of the observations together.  This will achieve a maximum value (1) when all the phase angles are the same and a minimum (0) if the phase angles are distributed uniformly around the clock.</p>
<p>The generalization of Pearson correlation to circular statistics is straight forward and is implemented in cor.circular in the circular package and in <code>circadian.cor</code> here.  Just as the Pearson r is a ratio of covariance to the square root of the product of two variances, so is the circular correlation.  The circular covariance of two circular vectors is defined as the average product of the sines of the deviations from the circular mean.  The variance is thus the average squared sine of the angular deviations from the circular mean.  Circular statistics are used for data that vary over a period (e.g., one day) or over directions (e.g., wind direction or bird flight).  Jammalamadaka and Lund (2006)  give a very good example of the use of circular statistics in calculating wind speed and direction.</p>
<p>The code from CircStats and circular was adapted to allow for analysis of data from various studies of mood over the day.  Those two packages do not seem to handle missing data, nor do they take matrix input, but rather emphasize single vectors.</p>
    <p>The cosinor function will either iteratively fit cosines of the angle to the observed data (opti=TRUE) or use the circular by linear regression to estimate the best fitting phase angle.  If cos.t &lt;- cos(time) and sin.t = sin(time) (expressed in hours), then beta.c and beta.s may be found by regression and the phase is \(sign(beta.c) * acos(beta.c/\sqrt(beta.c^2 + beta.s^2)) * 12/pi\)</p>
<p>Simulations (see examples) suggest that with incomplete times, perhaps the optimization procedure yields slightly better fits with the correct phase than does the linear model, but the differences are very small. In the presence of noisey data, these advantages seem to reverse.  The recommendation thus seems to be to use the linear model approach (the default).  The fit statistic reported for cosinor is the correlation of the data with the model  [ cos(time - acrophase) ].</p>
<p>The <code>circadian.reliability</code> function splits the data for each subject into a first and second half (by default, or into odd and even items) and then finds the best fitting phase for each half.  These are then correlated (using <code>circadian.cor</code>) and this correlation is then adjusted for test length using the conventional Spearman-Brown formula. Returned as object in the output are the statistics for the first and second part, as well as an ANOVA to compare the two halves.
    <code>circular.mean</code> and <code>circular.cor</code> are just <code>circadian.mean</code> and <code>circadian.cor</code> but with input given in radians rather than hours.</p>
<p>The <code>circadian.linear.cor</code> function will correlate a set of circular variables with a set of linear variables.  The first (angle) variables are circular, the second (x) set of variables are linear.</p>
    <p>The <code>circadian.F</code> will compare 2 or more groups in terms of their mean position.  This is adapted from the equivalent function in the circular pacakge.  This is clearly a more powerful test the more each group is compact around its mean (large values of R).</p>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p></p>
<dt>phase </dt><dd><p>The phase angle that best fits the data (expressed in hours if hours=TRUE).</p></dd>
  <dt>fit</dt><dd><p>Value of the correlation of the fit.  This is just the correlation of the data with the phase adjusted cosine.</p></dd>
  <dt>mean.angle</dt><dd><p>A vector of mean angles</p></dd>
  <dt>n,mean,sd</dt><dd><p>The appropriate circular statistic.</p></dd>
  <dt>correl</dt><dd><p>A matrix of circular correlations or linear by circular correlations</p></dd>
  <dt>R</dt><dd><p>R is the vector length (0-1) of the mean vector when finding circadian statistics using <code>circadian.stats</code></p></dd>
  <dt>z,p</dt><dd><p>z is the number of observations x R^2.  p is the probability of a z.</p></dd>
  <dt>phase.rel</dt><dd><p>The reliability of the phase measures.  This is the circular correlation between the two halves adjusted using the Spearman-Brown correction.</p></dd>
  <dt>fit.rel</dt><dd><p>The split half reliability of the fit statistic.</p></dd>
  <dt>split.F</dt><dd><p>Do the two halves differ from each other?  One would hope not.</p></dd>
  <dt>group1,group2</dt><dd><p>The statistics from each half</p></dd>
  <dt>splits</dt><dd><p>The individual data from each half.</p></dd>
  


    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>See circular statistics 
Jammalamadaka, Sreenivasa and Lund, Ulric (2006),The effect of wind direction on ozone levels: a case study, Environmental and Ecological Statistics, 13, 287-298.</p>
    
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>These functions have been adapted from the circular package to allow for ease of use with circadian data, particularly for data sets with missing data and multiple variables of interest.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <p>See the circular and CircStats packages.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='no'>time</span> <span class='kw'>&lt;-</span> <span class='fu'>seq</span>(<span class='fl'>1</span>:<span class='fl'>24</span>) <span class='co'>#create a 24 hour time</span>
<span class='no'>pure</span> <span class='kw'>&lt;-</span> <span class='fu'>matrix</span>(<span class='no'>time</span>,<span class='fl'>24</span>,<span class='fl'>18</span>)
<span class='fu'>colnames</span>(<span class='no'>pure</span>) <span class='kw'>&lt;-</span> <span class='fu'>paste0</span>(<span class='st'>"H"</span>,<span class='fl'>1</span>:<span class='fl'>18</span>)
<span class='no'>pure</span> <span class='kw'>&lt;-</span> <span class='fu'>data.frame</span>(<span class='no'>time</span>,<span class='fu'>cos</span>((<span class='no'>pure</span> - <span class='fu'>col</span>(<span class='no'>pure</span>))*<span class='no'>pi</span>/<span class='fl'>12</span>)*<span class='fl'>3</span> + <span class='fl'>3</span>)
    <span class='co'>#18 different phases but scaled to 0-6  match mood data</span>
<span class='fu'>matplot</span>(<span class='no'>pure</span>[-<span class='fl'>1</span>],<span class='kw'>type</span><span class='kw'>=</span><span class='st'>"l"</span>,<span class='kw'>main</span><span class='kw'>=</span><span class='st'>"Pure circadian arousal rhythms"</span>,
    <span class='kw'>xlab</span><span class='kw'>=</span><span class='st'>"time of day"</span>,<span class='kw'>ylab</span><span class='kw'>=</span><span class='st'>"Arousal"</span>)</div><img src='cosinor-2.png' alt='' width='540' height='400' /><div class='input'><span class='no'>op</span> <span class='kw'>&lt;-</span> <span class='fu'>par</span>(<span class='kw'>mfrow</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>2</span>,<span class='fl'>2</span>))
 <span class='fu'>cosinor.plot</span>(<span class='fl'>1</span>,<span class='fl'>3</span>,<span class='no'>pure</span>)
 <span class='fu'>cosinor.plot</span>(<span class='fl'>1</span>,<span class='fl'>5</span>,<span class='no'>pure</span>)
 <span class='fu'>cosinor.plot</span>(<span class='fl'>1</span>,<span class='fl'>8</span>,<span class='no'>pure</span>)
 <span class='fu'>cosinor.plot</span>(<span class='fl'>1</span>,<span class='fl'>12</span>,<span class='no'>pure</span>)</div><img src='cosinor-4.png' alt='' width='540' height='400' /><div class='input'>
<span class='no'>p</span> <span class='kw'>&lt;-</span> <span class='fu'>cosinor</span>(<span class='no'>pure</span>) <span class='co'>#find the acrophases (should match the input)</span>

<span class='co'>#now, test finding the acrophases for  different subjects on 3 variables</span>
<span class='co'>#They should be the first 3, second 3, etc. acrophases of pure</span>
<span class='no'>pp</span> <span class='kw'>&lt;-</span> <span class='fu'>matrix</span>(<span class='fl'>NA</span>,<span class='kw'>nrow</span><span class='kw'>=</span><span class='fl'>6</span>*<span class='fl'>24</span>,<span class='kw'>ncol</span><span class='kw'>=</span><span class='fl'>4</span>)
<span class='no'>pure</span> <span class='kw'>&lt;-</span> <span class='fu'>as.matrix</span>(<span class='no'>pure</span>)
<span class='no'>pp</span>[,<span class='fl'>1</span>] <span class='kw'>&lt;-</span> <span class='fu'>rep</span>(<span class='no'>pure</span>[,<span class='fl'>1</span>],<span class='fl'>6</span>)
<span class='no'>pp</span>[<span class='fl'>1</span>:<span class='fl'>24</span>,<span class='fl'>2</span>:<span class='fl'>4</span>] <span class='kw'>&lt;-</span> <span class='no'>pure</span>[<span class='fl'>1</span>:<span class='fl'>24</span>,<span class='fl'>2</span>:<span class='fl'>4</span>]
<span class='no'>pp</span>[<span class='fl'>25</span>:<span class='fl'>48</span>,<span class='fl'>2</span>:<span class='fl'>4</span>] <span class='kw'>&lt;-</span> <span class='no'>pure</span>[<span class='fl'>1</span>:<span class='fl'>24</span>,<span class='fl'>5</span>:<span class='fl'>7</span>] *<span class='fl'>2</span>   <span class='co'>#to test different variances</span>
<span class='no'>pp</span>[<span class='fl'>49</span>:<span class='fl'>72</span>,<span class='fl'>2</span>:<span class='fl'>4</span>] <span class='kw'>&lt;-</span> <span class='no'>pure</span>[<span class='fl'>1</span>:<span class='fl'>24</span>,<span class='fl'>8</span>:<span class='fl'>10</span>] *<span class='fl'>3</span>
<span class='no'>pp</span>[<span class='fl'>73</span>:<span class='fl'>96</span>,<span class='fl'>2</span>:<span class='fl'>4</span>] <span class='kw'>&lt;-</span> <span class='no'>pure</span>[<span class='fl'>1</span>:<span class='fl'>24</span>,<span class='fl'>11</span>:<span class='fl'>13</span>]
<span class='no'>pp</span>[<span class='fl'>97</span>:<span class='fl'>120</span>,<span class='fl'>2</span>:<span class='fl'>4</span>] <span class='kw'>&lt;-</span> <span class='no'>pure</span>[<span class='fl'>1</span>:<span class='fl'>24</span>,<span class='fl'>14</span>:<span class='fl'>16</span>]
<span class='no'>pp</span>[<span class='fl'>121</span>:<span class='fl'>144</span>,<span class='fl'>2</span>:<span class='fl'>4</span>] <span class='kw'>&lt;-</span> <span class='no'>pure</span>[<span class='fl'>1</span>:<span class='fl'>24</span>,<span class='fl'>17</span>:<span class='fl'>19</span>]
<span class='no'>pure.df</span> <span class='kw'>&lt;-</span> <span class='fu'>data.frame</span>(<span class='kw'>ID</span> <span class='kw'>=</span> <span class='fu'>rep</span>(<span class='fl'>1</span>:<span class='fl'>6</span>,<span class='kw'>each</span><span class='kw'>=</span><span class='fl'>24</span>),<span class='no'>pp</span>)
<span class='fu'>colnames</span>(<span class='no'>pure.df</span>) <span class='kw'>&lt;-</span> <span class='fu'>c</span>(<span class='st'>"ID"</span>,<span class='st'>"Time"</span>,<span class='fu'>paste0</span>(<span class='st'>"V"</span>,<span class='fl'>1</span>:<span class='fl'>3</span>))
<span class='fu'>cosinor</span>(<span class='st'>"Time"</span>,<span class='fl'>3</span>:<span class='fl'>5</span>,<span class='st'>"ID"</span>,<span class='no'>pure.df</span>)</div><div class='output co'>#&gt;   V1.phase V2.phase V3.phase V1.fit V2.fit V3.fit V1.amp V2.amp V3.amp    V1.sd
#&gt; 1        1        2        3      1      1      1      1      1      1 2.166945
#&gt; 2        4        5        6      1      1      1      1      1      1 4.333891
#&gt; 3        7        8        9      1      1      1      1      1      1 6.500836
#&gt; 4       10       11       12      1      1      1      1      1      1 2.166945
#&gt; 5       13       14       15      1      1      1      1      1      1 2.166945
#&gt; 6       16       17       18      1      1      1      1      1      1 2.166945
#&gt;      V2.sd    V3.sd V1.mean V2.mean V3.mean V1.intercept V2.intercept
#&gt; 1 2.166945 2.166945       3       3       3    5.0931085    4.8766297
#&gt; 2 4.333891 4.333891       6       6       6    8.1669454    7.1216935
#&gt; 3 6.500836 6.500836       9       9       9    7.3174598    5.7495820
#&gt; 4 2.166945 2.166945       3       3       3    1.1233703    0.9068915
#&gt; 5 2.166945 2.166945       3       3       3    0.9068915    1.1233703
#&gt; 6 2.166945 2.166945       3       3       3    1.9165273    2.4391533
#&gt;   V3.intercept
#&gt; 1    4.5322618
#&gt; 2    6.0000000
#&gt; 3    4.4032147
#&gt; 4    0.8330546
#&gt; 5    1.4677382
#&gt; 6    3.0000000</div><div class='input'>
<span class='no'>op</span> <span class='kw'>&lt;-</span> <span class='fu'>par</span>(<span class='kw'>mfrow</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>2</span>,<span class='fl'>2</span>))
 <span class='fu'>cosinor.plot</span>(<span class='fl'>2</span>,<span class='fl'>3</span>,<span class='no'>pure.df</span>,<span class='kw'>IDloc</span><span class='kw'>=</span><span class='fl'>1</span>,<span class='kw'>ID</span><span class='kw'>=</span><span class='st'>"1"</span>)
 <span class='fu'>cosinor.plot</span>(<span class='fl'>2</span>,<span class='fl'>3</span>,<span class='no'>pure.df</span>,<span class='kw'>IDloc</span><span class='kw'>=</span><span class='fl'>1</span>,<span class='kw'>ID</span><span class='kw'>=</span><span class='st'>"2"</span>)
 <span class='fu'>cosinor.plot</span>(<span class='fl'>2</span>,<span class='fl'>3</span>,<span class='no'>pure.df</span>,<span class='kw'>IDloc</span><span class='kw'>=</span><span class='fl'>1</span>,<span class='kw'>ID</span><span class='kw'>=</span><span class='st'>"3"</span>)
 <span class='fu'>cosinor.plot</span>(<span class='fl'>2</span>,<span class='fl'>3</span>,<span class='no'>pure.df</span>,<span class='kw'>IDloc</span><span class='kw'>=</span><span class='fl'>1</span>,<span class='kw'>ID</span><span class='kw'>=</span><span class='st'>"4"</span>)</div><img src='cosinor-8.png' alt='' width='540' height='400' /><div class='input'>
 <span class='co'>#now, show those in one panel as spagetti plots</span>
<span class='no'>op</span> <span class='kw'>&lt;-</span> <span class='fu'>par</span>(<span class='kw'>mfrow</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>1</span>,<span class='fl'>1</span>))
<span class='fu'>cosinor.plot</span>(<span class='fl'>2</span>,<span class='fl'>3</span>,<span class='no'>pure.df</span>,<span class='kw'>IDloc</span><span class='kw'>=</span><span class='fl'>1</span>,<span class='kw'>ID</span><span class='kw'>=</span><span class='st'>"1"</span>,<span class='kw'>multi</span><span class='kw'>=</span><span class='fl'>TRUE</span>,<span class='kw'>ylim</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0</span>,<span class='fl'>20</span>),<span class='kw'>ylab</span><span class='kw'>=</span><span class='st'>"Modeled"</span>)</div><div class='input'> <span class='fu'>cosinor.plot</span>(<span class='fl'>2</span>,<span class='fl'>3</span>,<span class='no'>pure.df</span>,<span class='kw'>IDloc</span><span class='kw'>=</span><span class='fl'>1</span>,<span class='kw'>ID</span><span class='kw'>=</span><span class='st'>"2"</span>,<span class='kw'>multi</span><span class='kw'>=</span><span class='fl'>TRUE</span>,<span class='kw'>add</span><span class='kw'>=</span><span class='fl'>TRUE</span>,<span class='kw'>lty</span><span class='kw'>=</span><span class='st'>"dotdash"</span>)</div><div class='input'> <span class='fu'>cosinor.plot</span>(<span class='fl'>2</span>,<span class='fl'>3</span>,<span class='no'>pure.df</span>,<span class='kw'>IDloc</span><span class='kw'>=</span><span class='fl'>1</span>,<span class='kw'>ID</span><span class='kw'>=</span><span class='st'>"3"</span>,<span class='kw'>multi</span><span class='kw'>=</span><span class='fl'>TRUE</span>,<span class='kw'>add</span><span class='kw'>=</span><span class='fl'>TRUE</span>,<span class='kw'>lty</span><span class='kw'>=</span><span class='st'>"dashed"</span>)</div><div class='input'> <span class='fu'>cosinor.plot</span>(<span class='fl'>2</span>,<span class='fl'>3</span>,<span class='no'>pure.df</span>,<span class='kw'>IDloc</span><span class='kw'>=</span><span class='fl'>1</span>,<span class='kw'>ID</span><span class='kw'>=</span><span class='st'>"4"</span>,<span class='kw'>multi</span><span class='kw'>=</span><span class='fl'>TRUE</span>,<span class='kw'>add</span><span class='kw'>=</span><span class='fl'>TRUE</span>,<span class='kw'>lty</span><span class='kw'>=</span><span class='st'>"dotted"</span>)</div><img src='cosinor-13.png' alt='' width='540' height='400' /><div class='input'>
<span class='fu'>set.seed</span>(<span class='fl'>42</span>)   <span class='co'>#what else?</span>
<span class='no'>noisy</span> <span class='kw'>&lt;-</span> <span class='no'>pure</span>
<span class='no'>noisy</span>[,<span class='fl'>2</span>:<span class='fl'>19</span>]<span class='kw'>&lt;-</span> <span class='no'>noisy</span>[,<span class='fl'>2</span>:<span class='fl'>19</span>] + <span class='fu'>rnorm</span>(<span class='fl'>24</span>*<span class='fl'>18</span>,<span class='fl'>0</span>,<span class='fl'>.2</span>)

<span class='no'>n</span> <span class='kw'>&lt;-</span> <span class='fu'>cosinor</span>(<span class='no'>time</span>,<span class='no'>noisy</span>) <span class='co'>#add a bit of noise</span>

<span class='no'>small.pure</span> <span class='kw'>&lt;-</span> <span class='no'>pure</span>[<span class='fu'>c</span>(<span class='fl'>8</span>,<span class='fl'>11</span>,<span class='fl'>14</span>,<span class='fl'>17</span>,<span class='fl'>20</span>,<span class='fl'>23</span>),]
<span class='no'>small.noisy</span> <span class='kw'>&lt;-</span> <span class='no'>noisy</span>[<span class='fu'>c</span>(<span class='fl'>8</span>,<span class='fl'>11</span>,<span class='fl'>14</span>,<span class='fl'>17</span>,<span class='fl'>20</span>,<span class='fl'>23</span>),]
<span class='no'>small.time</span> <span class='kw'>&lt;-</span> <span class='fu'>c</span>(<span class='fl'>8</span>,<span class='fl'>11</span>,<span class='fl'>14</span>,<span class='fl'>17</span>,<span class='fl'>20</span>,<span class='fl'>23</span>)

<span class='fu'>cosinor.plot</span>(<span class='fl'>1</span>,<span class='fl'>3</span>,<span class='no'>small.pure</span>,<span class='kw'>multi</span><span class='kw'>=</span><span class='fl'>TRUE</span>)</div><div class='input'><span class='fu'>cosinor.plot</span>(<span class='fl'>1</span>,<span class='fl'>3</span>,<span class='no'>small.noisy</span>,<span class='kw'>multi</span><span class='kw'>=</span><span class='fl'>TRUE</span>,<span class='kw'>add</span><span class='kw'>=</span><span class='fl'>TRUE</span>,<span class='kw'>lty</span><span class='kw'>=</span><span class='st'>"dashed"</span>)</div><img src='cosinor-16.png' alt='' width='540' height='400' /><div class='input'>

<span class='co'># sp &lt;- cosinor(small.pure)</span>
<span class='co'># spo &lt;- cosinor(small.pure,opti=TRUE) #iterative fit</span>
<span class='co'># sn &lt;- cosinor(small.noisy) #linear</span>
<span class='co'># sno &lt;- cosinor(small.noisy,opti=TRUE) #iterative</span>
<span class='co'># sum.df &lt;- data.frame(pure=p,noisy = n, small=sp,small.noise = sn, </span>
<span class='co'>#         small.opt=spo,small.noise.opt=sno)</span>
<span class='co'># round(sum.df,2)</span>
<span class='co'># round(circadian.cor(sum.df[,c(1,3,5,7,9,11)]),2)  #compare alternatives </span>
<span class='co'># </span>
<span class='co'># #now, lets form three "subjects" and show how the grouping variable works</span>
<span class='co'># mixed.df &lt;- rbind(small.pure,small.noisy,noisy)</span>
<span class='co'># mixed.df &lt;- data.frame(ID=c(rep(1,6),rep(2,6),rep(3,24)),</span>
<span class='co'>#           time=c(rep(c(8,11,14,17,20,23),2),1:24),mixed.df)</span>
<span class='co'># group.df &lt;- cosinor(angle="time",x=2:20,code="ID",data=mixed.df)</span>
<span class='co'># round(group.df,2)  #compare these values to the sp,sn,and n values done separately</span></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#details">Details</a></li>

      <li><a href="#value">Value</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#note">Note</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    William Revelle 
  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by William Revelle.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
