<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Tests of significance for correlations — r.test • psych</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>

<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">psych</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Tests of significance for correlations</h1>
    </div>

    
    <p>Tests the significance of a single correlation, the difference between two independent correlations, the difference between two dependent correlations sharing one variable (Williams's Test), or the difference between two dependent correlations with different variables (Steiger Tests).</p>
    

    <pre class="usage"><span class='fu'>r.test</span>(<span class='no'>n</span>, <span class='no'>r12</span>, <span class='kw'>r34</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>r23</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>r13</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>r14</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>r24</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
          <span class='kw'>n2</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,<span class='kw'>pooled</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>twotailed</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>n</th>
      <td><p>Sample size of first group</p></td>
    </tr>
    <tr>
      <th>r12</th>
      <td><p>Correlation to be tested</p></td>
    </tr>
    <tr>
      <th>r34</th>
      <td><p>Test if this correlation is different from r12, if r23 is specified, but r13 is not, then r34 becomes r13</p></td>
    </tr>
    <tr>
      <th>r23</th>
      <td><p>if ra = r(12) and rb = r(13)  then test for differences of dependent correlations given r23</p></td>
    </tr>
    <tr>
      <th>r13</th>
      <td><p>implies  ra =r(12) and rb =r(34)  test for difference of dependent correlations</p></td>
    </tr>
    <tr>
      <th>r14</th>
      <td><p>implies   ra =r(12) and rb =r(34)</p></td>
    </tr>
    <tr>
      <th>r24</th>
      <td><p>ra =r(12) and rb =r(34)</p></td>
    </tr>
    <tr>
      <th>n2</th>
      <td><p>n2 is specified in the case of two independent correlations. n2 defaults to n if if not specified</p></td>
    </tr>
    <tr>
      <th>pooled</th>
      <td><p>use pooled estimates of correlations</p></td>
    </tr>
    <tr>
      <th>twotailed</th>
      <td><p>should a twotailed or one tailed test be used</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Depending upon the input, one of four different tests of correlations is done.
1) For a sample size n, find the t value for a single correlation where $$t = \frac{r * \sqrt(n-2)}{\sqrt(1-r^2)}
$$ and
    $$se = \sqrt{\frac{1-r^2}{n-2}}) $$.</p>
<p>2) For sample sizes of n and n2 (n2 = n if not specified) find the z of the difference between the z transformed correlations divided by the standard error of the difference of two z scores: 
$$z = \frac{z_1  - z_2}{\sqrt{\frac{1}{(n_1 - 3) + (n_2 - 3)}}}$$.</p>
<p>3) For sample size n, and correlations r12, r13 and r23 test for the difference of two dependent correlations (r12 vs r13).</p>
<p>4) For sample size n, test for the difference between two dependent correlations involving different variables.</p>
<p>For clarity, correlations may be specified by value.  If specified by location and if doing the test of dependent correlations, if three correlations are specified, they are assumed to be in the order r12, r13, r23. Consider the example  the example from Steiger: 
where Masculinity at time 1 (M1) correlates with Verbal Ability .5 (r12), femininity at time 1 (F1) correlates with Verbal ability  r13 =.4, and M1 correlates with F1 (r23= .1).  Then, given the correlations: r12 = .4, r13 = .5, and r23 = .1, t = -.89 for n =103, i.e.,
r.test(n=103, r12=.4, r13=.5,r23=.1)</p>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p></p>
<dt>test</dt><dd><p>Label of test done</p></dd>
  <dt>z</dt><dd><p>z value for tests 2 or 4</p></dd>
  <dt>t</dt><dd><p>t value for tests 1 and 3</p></dd>
  <dt>p</dt><dd><p>probability value of z or t</p></dd>


    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    
    <p>Cohen, J. and Cohen, P. and West, S.G. and Aiken, L.S. (2003) Applied multiple regression/correlation analysis for the behavioral sciences, L.Erlbaum Associates, Mahwah, N.J.</p>
<p>Olkin, I. and Finn, J. D. (1995). Correlations redux. Psychological Bulletin, 118(1):155-164.</p>
<p>Steiger, J.H. (1980), Tests for comparing elements of a correlation matrix, Psychological Bulletin, 87, 245-251.</p>
<p>Williams, E.J.  (1959) Regression analysis. Wiley, New York, 1959.</p>
    
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>Steiger specifically rejects using the Hotelling T test to test the difference between correlated correlations. Instead, he recommends Williams' test. (See also Dunn and Clark, 1971). These tests follow Steiger's advice.
The test of two independent correlations is just a z test of the difference of the  Fisher's z transformed correlations divided by the standard error of the difference.  (See Cohen et al, p 49).</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <p>See also  <code><a href='corr.test.html'>corr.test</a></code> which tests all the elements of a  correlation matrix, and <code><a href='cortest.mat.html'>cortest.mat</a></code> to compare two matrices of correlations.  r.test  extends the tests in <code><a href='paired.r.html'>paired.r</a></code>,<code><a href='fisherz.html'>r.con</a></code></p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='no'>n</span> <span class='kw'>&lt;-</span> <span class='fl'>30</span>
<span class='no'>r</span> <span class='kw'>&lt;-</span> <span class='fu'>seq</span>(<span class='fl'>0</span>,<span class='fl'>.9</span>,<span class='fl'>.1</span>)
<span class='no'>rc</span> <span class='kw'>&lt;-</span> <span class='fu'>matrix</span>(<span class='fu'><a href='fisherz.html'>r.con</a></span>(<span class='no'>r</span>,<span class='no'>n</span>),<span class='kw'>ncol</span><span class='kw'>=</span><span class='fl'>2</span>)
<span class='no'>test</span> <span class='kw'>&lt;-</span> <span class='fu'>r.test</span>(<span class='no'>n</span>,<span class='no'>r</span>)
<span class='no'>r.rc</span> <span class='kw'>&lt;-</span> <span class='fu'>data.frame</span>(<span class='kw'>r</span><span class='kw'>=</span><span class='no'>r</span>,<span class='kw'>z</span><span class='kw'>=</span><span class='fu'><a href='fisherz.html'>fisherz</a></span>(<span class='no'>r</span>),<span class='kw'>lower</span><span class='kw'>=</span><span class='no'>rc</span>[,<span class='fl'>1</span>],<span class='kw'>upper</span><span class='kw'>=</span><span class='no'>rc</span>[,<span class='fl'>2</span>],<span class='kw'>t</span><span class='kw'>=</span><span class='no'>test</span>$<span class='no'>t</span>,<span class='kw'>p</span><span class='kw'>=</span><span class='no'>test</span>$<span class='no'>p</span>)
<span class='fu'>round</span>(<span class='no'>r.rc</span>,<span class='fl'>2</span>)</div><div class='output co'>#&gt;      r    z lower upper     t    p
#&gt; 1  0.0 0.00 -0.36  0.36  0.00 1.00
#&gt; 2  0.1 0.10 -0.27  0.44  0.53 0.60
#&gt; 3  0.2 0.20 -0.17  0.52  1.08 0.29
#&gt; 4  0.3 0.31 -0.07  0.60  1.66 0.11
#&gt; 5  0.4 0.42  0.05  0.66  2.31 0.03
#&gt; 6  0.5 0.55  0.17  0.73  3.06 0.00
#&gt; 7  0.6 0.69  0.31  0.79  3.97 0.00
#&gt; 8  0.7 0.87  0.45  0.85  5.19 0.00
#&gt; 9  0.8 1.10  0.62  0.90  7.06 0.00
#&gt; 10 0.9 1.47  0.80  0.95 10.93 0.00</div><div class='input'>
<span class='fu'>r.test</span>(<span class='fl'>50</span>,<span class='no'>r</span>)</div><div class='output co'>#&gt; Correlation tests 
#&gt; Call:r.test(n = 50, r12 = r)
#&gt; Test of significance of a  correlation 
#&gt;  t value 0 0.7 1.41 2.18 3.02 4 5.2 6.79 9.24 14.3    with probability &lt; 1 0.49 0.16 0.034 0.004 0.00022 4.1e-06 1.5e-08 3.2e-12 0
#&gt;  and confidence interval  -0.28 -0.18 -0.08 0.02 0.14 0.26 0.39 0.52 0.67 0.83 0.28 0.37 0.45 0.53 0.61 0.68 0.75 0.82 0.88 0.94</div><div class='input'><span class='fu'>r.test</span>(<span class='fl'>30</span>,<span class='fl'>.4</span>,<span class='fl'>.6</span>)       <span class='co'>#test the difference between two independent correlations</span></div><div class='output co'>#&gt; Correlation tests 
#&gt; Call:r.test(n = 30, r12 = 0.4, r34 = 0.6)
#&gt; Test of difference between two independent correlations 
#&gt;  z value 0.99    with probability  0.32</div><div class='input'><span class='fu'>r.test</span>(<span class='fl'>103</span>,<span class='fl'>.4</span>,<span class='fl'>.5</span>,<span class='fl'>.1</span>)   <span class='co'>#Steiger case A of dependent correlations </span></div><div class='output co'>#&gt; Correlation tests 
#&gt; Call:[1] "r.test(n =  103 ,  r12 =  0.4 ,  r23 =  0.1 ,  r13 =  0.5 )"
#&gt; Test of difference between two correlated  correlations 
#&gt;  t value -0.89    with probability &lt; 0.37</div><div class='input'><span class='fu'>r.test</span>(<span class='kw'>n</span><span class='kw'>=</span><span class='fl'>103</span>, <span class='kw'>r12</span><span class='kw'>=</span><span class='fl'>.4</span>, <span class='kw'>r13</span><span class='kw'>=</span><span class='fl'>.5</span>,<span class='kw'>r23</span><span class='kw'>=</span><span class='fl'>.1</span>)</div><div class='output co'>#&gt; Correlation tests 
#&gt; Call:[1] "r.test(n =  103 ,  r12 =  0.4 ,  r23 =  0.1 ,  r13 =  0.5 )"
#&gt; Test of difference between two correlated  correlations 
#&gt;  t value -0.89    with probability &lt; 0.37</div><div class='input'><span class='co'>#for complicated tests, it is probably better to specify correlations by name</span>
<span class='fu'>r.test</span>(<span class='kw'>n</span><span class='kw'>=</span><span class='fl'>103</span>,<span class='kw'>r12</span><span class='kw'>=</span><span class='fl'>.5</span>,<span class='kw'>r34</span><span class='kw'>=</span><span class='fl'>.6</span>,<span class='kw'>r13</span><span class='kw'>=</span><span class='fl'>.7</span>,<span class='kw'>r23</span><span class='kw'>=</span><span class='fl'>.5</span>,<span class='kw'>r14</span><span class='kw'>=</span><span class='fl'>.5</span>,<span class='kw'>r24</span><span class='kw'>=</span><span class='fl'>.8</span>)   <span class='co'>#steiger Case B </span></div><div class='output co'>#&gt; Correlation tests 
#&gt; Call:r.test(n = 103, r12 = 0.5, r34 = 0.6, r23 = 0.5, r13 = 0.7, r14 = 0.5, 
#&gt;     r24 = 0.8)
#&gt; Test of difference between two dependent correlations 
#&gt;  z value -1.4    with probability  0.16</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#details">Details</a></li>

      <li><a href="#value">Value</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#note">Note</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    William Revelle 
  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by William Revelle.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
