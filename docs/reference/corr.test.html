<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Find the correlations, sample sizes, and probability values between elements of a matrix or data.frame. — corr.test • psych</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>

<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">psych</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Find the correlations, sample sizes, and probability values between elements of a matrix or data.frame.</h1>
    </div>

    
    <p>Although the cor function finds the correlations for a matrix, it does not report probability values. corr.test uses cor to find the correlations for either complete or pairwise data and reports the sample sizes and probability values as well. For symmetric matrices, raw probabilites are reported below the diagonal and correlations adjusted for multiple comparisons above the diagonal. In the case of different x and ys, the default is to adjust the probabilities for multiple tests.</p>
    

    <pre class="usage"><span class='fu'>corr.test</span>(<span class='no'>x</span>, <span class='kw'>y</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>use</span> <span class='kw'>=</span> <span class='st'>"pairwise"</span>,<span class='kw'>method</span><span class='kw'>=</span><span class='st'>"pearson"</span>,<span class='kw'>adjust</span><span class='kw'>=</span><span class='st'>"holm"</span>, <span class='kw'>alpha</span><span class='kw'>=</span><span class='fl'>.05</span>,<span class='kw'>ci</span><span class='kw'>=</span><span class='fl'>TRUE</span>)
<span class='fu'>corr.p</span>(<span class='no'>r</span>,<span class='no'>n</span>,<span class='kw'>adjust</span><span class='kw'>=</span><span class='st'>"holm"</span>,<span class='kw'>alpha</span><span class='kw'>=</span><span class='fl'>.05</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>A matrix or dataframe</p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>A second matrix or dataframe with the same number of rows as x</p></td>
    </tr>
    <tr>
      <th>use</th>
      <td><p>use="pairwise" is the default value and will do pairwise deletion of cases. use="complete" will select just complete cases.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>method="pearson" is the default value.  The alternatives to be passed to cor are "spearman" and "kendall"</p></td>
    </tr>
    <tr>
      <th>adjust</th>
      <td><p>What adjustment for multiple tests should be used? ("holm", "hochberg", "hommel", "bonferroni", "BH", "BY", "fdr", "none"). See <code>p.adjust</code> for details about why to use "holm" rather than "bonferroni").</p></td>
    </tr>
    <tr>
      <th>alpha</th>
      <td><p>alpha level of confidence intervals</p></td>
    </tr>
    <tr>
      <th>r</th>
      <td><p>A correlation matrix</p></td>
    </tr>
    <tr>
      <th>n</th>
      <td><p>Number of observations if using corr.p. May be either a matrix (as returned from corr.test, or a scaler. Set to n- np if finding the significance of partial correlations. (See below).</p></td>
    </tr>
    <tr>
      <th>ci</th>
      <td><p>By default, confidence intervals are found.  However, this leads to a great slowdown of speed.  So, for just the rs, ts and ps, set ci=FALSE</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>corr.test uses the <code>cor</code> function to find the correlations, and then applies a t-test to the individual correlations using the formula
$$t = \frac{r * \sqrt(n-2)}{\sqrt(1-r^2)}
$$
    $$se = \sqrt(\frac{1-r^2}{n-2}) $$</p>
<p>The t and Standard Errors are returned as objects in the result, but are not normally displayed. Confidence intervals are found and printed if using the print(short=FALSE) option.  These are found by using the fisher z transform of the correlation, and the standard error of the z transforms is $$se = \sqrt(\frac {1}{n-3}) $$.</p>
<p>The probability values may be adjusted using the Holm (or other) correction.  If the matrix is symmetric (no y data), then the original p values are reported below the diagonal and the adjusted above the diagonal.  Otherwise, all probabilities are adjusted (unless adjust="none").  This is made explicit in the output.
    <code>corr.p</code> may be applied to the results of <code><a href='partial.r.html'>partial.r</a></code> if n is set to n - s (where s is the number of variables partialed out)  Fisher, 1924.</p>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p></p>
<dt>r</dt><dd><p>The matrix of correlations</p></dd>
  <dt>n</dt><dd><p>Number of cases per correlation</p></dd>
  <dt>t</dt><dd><p>value of t-test for each correlation</p></dd>
  <dt>p</dt><dd><p>two tailed probability of t for each correlation.  For symmetric matrices, p values adjusted for multiple tests are reported above the diagonal.</p></dd>
  <dt>se</dt><dd><p>standard error of the correlation</p></dd>
  <dt>ci</dt><dd><p>the alpha/2 lower and upper values</p></dd>

    
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>For very large matrices (&gt; 200 x 200), there is a noticeable speed improvement if confidence intervals are not found.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <p><code>cor.test</code> for tests of a single correlation,  Hmisc::rcorr for an equivalant function, <code><a href='r.test.html'>r.test</a></code> to test the difference between correlations, and <code><a href='cortest.mat.html'>cortest.mat</a></code> to test for equality of two correlation matrices.</p>
<p>Also see <code><a href='cor.ci.html'>cor.ci</a></code> for bootstrapped confidence intervals of Pearson, Spearman, Kendall, tetrachoric or polychoric correlations.  In addition <code><a href='cor.ci.html'>cor.ci</a></code> will find bootstrapped estimates of composite scales based upon a set of correlations (ala <code><a href='cluster.cor.html'>cluster.cor</a></code>).</p>
<p>In particular, see <code>p.adjust</code> for a discussion of p values associated with multiple tests.</p>
<p>Other useful functions related to finding and displaying correlations include <code><a href='misc.html'>lowerCor</a></code> for finding the correlations and then displaying the lower off diagonal using the <code><a href='misc.html'>lowerMat</a></code> function. <code><a href='lowerUpper.html'>lowerUpper</a></code> to compare two correlation matrices.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='no'>ct</span> <span class='kw'>&lt;-</span> <span class='fu'>corr.test</span>(<span class='no'>attitude</span>)  <span class='co'>#find the correlations and give the probabilities</span>
<span class='no'>ct</span> <span class='co'>#show the results</span></div><div class='output co'>#&gt; Call:corr.test(x = attitude)
#&gt; Correlation matrix 
#&gt;            rating complaints privileges learning raises critical advance
#&gt; rating       1.00       0.83       0.43     0.62   0.59     0.16    0.16
#&gt; complaints   0.83       1.00       0.56     0.60   0.67     0.19    0.22
#&gt; privileges   0.43       0.56       1.00     0.49   0.45     0.15    0.34
#&gt; learning     0.62       0.60       0.49     1.00   0.64     0.12    0.53
#&gt; raises       0.59       0.67       0.45     0.64   1.00     0.38    0.57
#&gt; critical     0.16       0.19       0.15     0.12   0.38     1.00    0.28
#&gt; advance      0.16       0.22       0.34     0.53   0.57     0.28    1.00
#&gt; Sample Size 
#&gt; [1] 30
#&gt; Probability values (Entries above the diagonal are adjusted for multiple tests.) 
#&gt;            rating complaints privileges learning raises critical advance
#&gt; rating       0.00       0.00       0.19     0.00   0.01     1.00    1.00
#&gt; complaints   0.00       0.00       0.02     0.01   0.00     1.00    1.00
#&gt; privileges   0.02       0.00       0.00     0.07   0.15     1.00    0.51
#&gt; learning     0.00       0.00       0.01     0.00   0.00     1.00    0.03
#&gt; raises       0.00       0.00       0.01     0.00   0.00     0.36    0.01
#&gt; critical     0.41       0.32       0.44     0.54   0.04     0.00    0.90
#&gt; advance      0.41       0.23       0.06     0.00   0.00     0.13    0.00
#&gt; 
#&gt;  To see confidence intervals of the correlations, print with the short=FALSE option</div><div class='input'><span class='fu'>corr.test</span>(<span class='no'>attitude</span>[<span class='fl'>1</span>:<span class='fl'>3</span>],<span class='no'>attitude</span>[<span class='fl'>4</span>:<span class='fl'>6</span>]) <span class='co'>#reports all values corrected for multiple tests</span></div><div class='output co'>#&gt; Call:corr.test(x = attitude[1:3], y = attitude[4:6])
#&gt; Correlation matrix 
#&gt;            learning raises critical
#&gt; rating         0.62   0.59     0.16
#&gt; complaints     0.60   0.67     0.19
#&gt; privileges     0.49   0.45     0.15
#&gt; Sample Size 
#&gt; [1] 30
#&gt; Probability values  adjusted for multiple tests. 
#&gt;            learning raises critical
#&gt; rating         0.00   0.00     0.96
#&gt; complaints     0.00   0.00     0.96
#&gt; privileges     0.03   0.05     0.96
#&gt; 
#&gt;  To see confidence intervals of the correlations, print with the short=FALSE option</div><div class='input'>
<span class='co'>#corr.test(sat.act[1:3],sat.act[4:6],adjust="none")  #don't adjust the probabilities</span>

<span class='co'>#take correlations and show the probabilities as well as the confidence intervals</span>
<span class='fu'>print</span>(<span class='fu'>corr.p</span>(<span class='fu'>cor</span>(<span class='no'>attitude</span>[<span class='fl'>1</span>:<span class='fl'>4</span>]),<span class='fl'>30</span>),<span class='kw'>short</span><span class='kw'>=</span><span class='fl'>FALSE</span>)</div><div class='output co'>#&gt; Call:corr.p(r = cor(attitude[1:4]), n = 30)
#&gt; Correlation matrix 
#&gt;            rating complaints privileges learning
#&gt; rating       1.00       0.83       0.43     0.62
#&gt; complaints   0.83       1.00       0.56     0.60
#&gt; privileges   0.43       0.56       1.00     0.49
#&gt; learning     0.62       0.60       0.49     1.00
#&gt; Sample Size 
#&gt; [1] 30
#&gt; Probability values (Entries above the diagonal are adjusted for multiple tests.) 
#&gt;            rating complaints privileges learning
#&gt; rating       0.00          0       0.02     0.00
#&gt; complaints   0.00          0       0.00     0.00
#&gt; privileges   0.02          0       0.00     0.01
#&gt; learning     0.00          0       0.01     0.00
#&gt; 
#&gt;  To see confidence intervals of the correlations, print with the short=FALSE option
#&gt; 
#&gt;  Confidence intervals based upon normal theory.  To get bootstrapped values, try cor.ci
#&gt;             lower    r upper    p
#&gt; ratng-cmpln  0.66 0.83  0.91 0.00
#&gt; ratng-prvlg  0.08 0.43  0.68 0.02
#&gt; cmpln-prvlg  0.34 0.62  0.80 0.00
#&gt; ratng-lrnng  0.25 0.56  0.76 0.00
#&gt; cmpln-lrnng  0.30 0.60  0.79 0.00
#&gt; prvlg-lrnng  0.16 0.49  0.72 0.01</div><div class='input'>
<span class='co'>#don't adjust the probabilities</span>
<span class='fu'>print</span>(<span class='fu'>corr.test</span>(<span class='no'>sat.act</span>[<span class='fl'>1</span>:<span class='fl'>3</span>],<span class='no'>sat.act</span>[<span class='fl'>4</span>:<span class='fl'>6</span>],<span class='kw'>adjust</span><span class='kw'>=</span><span class='st'>"none"</span>),<span class='kw'>short</span><span class='kw'>=</span><span class='fl'>FALSE</span>)</div><div class='output co'>#&gt; Call:corr.test(x = sat.act[1:3], y = sat.act[4:6], adjust = "none")
#&gt; Correlation matrix 
#&gt;             ACT  SATV  SATQ
#&gt; gender    -0.04 -0.02 -0.17
#&gt; education  0.15  0.05  0.03
#&gt; age        0.11 -0.04 -0.03
#&gt; Sample Size 
#&gt;           ACT SATV SATQ
#&gt; gender    700  700  687
#&gt; education 700  700  687
#&gt; age       700  700  687
#&gt;            ACT SATV SATQ
#&gt; gender    0.33 0.62 0.00
#&gt; education 0.00 0.22 0.36
#&gt; age       0.00 0.26 0.37
#&gt; 
#&gt;  To see confidence intervals of the correlations, print with the short=FALSE option
#&gt; 
#&gt;  Confidence intervals based upon normal theory.  To get bootstrapped values, try cor.ci
#&gt;            lower     r upper    p
#&gt; gendr-ACT  -0.11 -0.04  0.04 0.33
#&gt; edctn-ACT   0.08  0.15  0.23 0.00
#&gt; age-ACT     0.04  0.11  0.18 0.00
#&gt; gendr-SATV -0.09 -0.02  0.06 0.62
#&gt; edctn-SATV -0.03  0.05  0.12 0.22
#&gt; age-SATV   -0.12 -0.04  0.03 0.26
#&gt; gendr-SATQ -0.24 -0.17 -0.09 0.00
#&gt; edctn-SATQ -0.04  0.03  0.11 0.36
#&gt; age-SATQ   -0.11 -0.03  0.04 0.37</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#details">Details</a></li>

      <li><a href="#value">Value</a></li>

      <li><a href="#note">Note</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by William Revelle.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
