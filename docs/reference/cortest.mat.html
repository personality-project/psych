<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Chi square tests of whether a single matrix is an identity matrix, or a pair of matrices are equal. — cortest.mat • psych</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>

<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">psych</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Chi square tests of whether a single matrix is an identity matrix, or a pair of matrices are equal.</h1>
    </div>

    
    <p>Steiger (1980) pointed out that the sum of the squared elements of a correlation matrix, or the Fisher z score equivalents, is distributed as chi square under the null hypothesis that the values are zero (i.e., elements of the identity matrix).  This is particularly useful for examining whether correlations in a single matrix differ from zero or for comparing two matrices. Jennrich (1970) also examined tests of differences between matrices.</p>
    

    <pre class="usage"><span class='fu'>cortest.normal</span>(<span class='no'>R1</span>, <span class='kw'>R2</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>n1</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>n2</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>fisher</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>) <span class='co'>#the steiger test</span>
<span class='fu'>cortest</span>(<span class='no'>R1</span>,<span class='kw'>R2</span><span class='kw'>=</span><span class='kw'>NULL</span>,<span class='kw'>n1</span><span class='kw'>=</span><span class='kw'>NULL</span>,<span class='kw'>n2</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>fisher</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,<span class='kw'>cor</span><span class='kw'>=</span><span class='fl'>TRUE</span>) <span class='co'>#same as cortest.normal </span>
<span class='fu'>cortest.jennrich</span>(<span class='no'>R1</span>,<span class='no'>R2</span>,<span class='kw'>n1</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>n2</span><span class='kw'>=</span><span class='kw'>NULL</span>)  <span class='co'>#the Jennrich test</span>
<span class='fu'>cortest.mat</span>(<span class='no'>R1</span>,<span class='kw'>R2</span><span class='kw'>=</span><span class='kw'>NULL</span>,<span class='kw'>n1</span><span class='kw'>=</span><span class='kw'>NULL</span>,<span class='kw'>n2</span> <span class='kw'>=</span> <span class='kw'>NULL</span>) <span class='co'>#an alternative test</span></pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>R1</th>
      <td><p>A correlation matrix. (If R1 is not rectangular, and cor=TRUE, the correlations are found).</p></td>
    </tr>
    <tr>
      <th>R2</th>
      <td><p>A correlation matrix.  If R2 is not rectangular, and cor=TRUE, the correlations are found. If R2 is NULL, then the test is just whether R1 is an identity matrix.</p></td>
    </tr>
    <tr>
      <th>n1</th>
      <td><p>Sample size of R1</p></td>
    </tr>
    <tr>
      <th>n2</th>
      <td><p>Sample size of R2</p></td>
    </tr>
    <tr>
      <th>fisher</th>
      <td><p>Fisher z transform the correlations?</p></td>
    </tr>
    <tr>
      <th>cor</th>
      <td><p>By default, if the input matrices are not symmetric, they are converted to correlation matrices.  That is, they are treated as if they were the raw data.  If cor=FALSE, then the input matrices are taken to be correlation matrices.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>There are several ways to test if a matrix is the identity matrix. The most well known is the chi square test  of Bartlett (1951) and Box (1949). A very straightforward test, discussed by Steiger (1980) is to find the sum of the squared correlations or the sum of the squared Fisher transformed correlations.  Under the null hypothesis that all the correlations are equal, this sum is distributed as chi square.  This is implemented in 
<code>cortest</code> and <code>cortest.normal</code></p>
<p>Yet another test, is the Jennrich(1970) test of the equality of two matrices. This compares the differences between two matrices to the averages of two matrices using a chi square test. This is implemented in <code>cortest.jennrich</code>.</p>
<p>Yet another option <code>cortest.mat</code> is to compare the two matrices using an approach analogous to that used in evaluating the adequacy of a factor model.  In factor analysis, the maximum likelihood fit statistic is
    \(f = log(trace ((FF'+U2)^{-1} R) -  log(|(FF'+U2)^{-1} R|) - n.items\).
    This in turn is converted to a chi square</p>
<p>\(\chi^2 = (n.obs - 1 - (2 * p + 5)/6 - (2 * factors)/3)) * f \) (see <code><a href='fa.html'>fa</a></code>.)
    That is, the model (M = FF' + U2) is compared to the original correlation matrix (R) by a function of \(M^{-1} R\).  By analogy, in the case of two matrices, A and B, <code>cortest.mat</code> finds the chi squares associated with \(A^{-1}B\) and \(A B^{-1}\).  The sum of these two \(\chi^2\) will also be a \(\chi^2\) but with twice the degrees of freedom.</p>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p></p>
<dt>chi2</dt><dd><p>The chi square statistic</p></dd>
  <dt>df</dt><dd><p>Degrees of freedom for the Chi Square</p></dd>
  <dt>prob</dt><dd><p>The probability of observing the Chi Square under the null hypothesis.</p></dd>
  

    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Steiger, James H. (1980) Testing pattern hypotheses on correlation matrices: alternative statistics and some empirical results. Multivariate Behavioral Research, 15, 335-352.</p>
<p>Jennrich, Robert I. (1970) An Asymptotic \(\chi^2\) Test for the Equality of Two Correlation Matrices. Journal of the American Statistical Association, 65, 904-912.</p>
    
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>Both the  cortest.jennrich  and cortest.normal  are probably overly stringent.  The ChiSquare values for pairs of random samples from the same population are larger than would be expected.  This is a good test for rejecting the null of no differences.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <p><code><a href='cortest.bartlett.html'>cortest.bartlett</a></code></p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='fu'>matrix</span>(<span class='fu'>rnorm</span>(<span class='fl'>1000</span>),<span class='kw'>ncol</span><span class='kw'>=</span><span class='fl'>10</span>)
<span class='fu'>cortest.normal</span>(<span class='no'>x</span>)  <span class='co'>#just test if this matrix is an identity</span></div><div class='output co'>#&gt; <span class='message'>R1 was not square, finding R from data</span></div><div class='output co'>#&gt; Tests of correlation matrices 
#&gt; Call:cortest.normal(R1 = x)
#&gt;  Chi Square value 39.11  with df =  45   with probability &lt; 0.72 </div><div class='input'><span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='sim.congeneric.html'>sim.congeneric</a></span>(<span class='kw'>loads</span> <span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>.9</span>,<span class='fl'>.8</span>,<span class='fl'>.7</span>,<span class='fl'>.6</span>,<span class='fl'>.5</span>),<span class='kw'>N</span><span class='kw'>=</span><span class='fl'>1000</span>,<span class='kw'>short</span><span class='kw'>=</span><span class='fl'>FALSE</span>)
<span class='no'>y</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='sim.congeneric.html'>sim.congeneric</a></span>(<span class='kw'>loads</span> <span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>.9</span>,<span class='fl'>.8</span>,<span class='fl'>.7</span>,<span class='fl'>.6</span>,<span class='fl'>.5</span>),<span class='kw'>N</span><span class='kw'>=</span><span class='fl'>1000</span>,<span class='kw'>short</span><span class='kw'>=</span><span class='fl'>FALSE</span>)
<span class='fu'>cortest.normal</span>(<span class='no'>x</span>$<span class='no'>r</span>,<span class='no'>y</span>$<span class='no'>r</span>,<span class='kw'>n1</span><span class='kw'>=</span><span class='fl'>1000</span>,<span class='kw'>n2</span><span class='kw'>=</span><span class='fl'>1000</span>) <span class='co'>#The Steiger test</span></div><div class='output co'>#&gt; Tests of correlation matrices 
#&gt; Call:cortest.normal(R1 = x$r, R2 = y$r, n1 = 1000, n2 = 1000)
#&gt;  Chi Square value 10.44  with df =  10   with probability &lt; 0.4 </div><div class='input'><span class='fu'>cortest.jennrich</span>(<span class='no'>x</span>$<span class='no'>r</span>,<span class='no'>y</span>$<span class='no'>r</span>,<span class='kw'>n1</span><span class='kw'>=</span><span class='fl'>100</span>,<span class='kw'>n2</span><span class='kw'>=</span><span class='fl'>1000</span>) <span class='co'># The Jennrich test</span></div><div class='output co'>#&gt; $chi2
#&gt; [1] 2.039087
#&gt; 
#&gt; $prob
#&gt; [1] 0.9960317
#&gt; </div><div class='input'><span class='fu'>cortest.mat</span>(<span class='no'>x</span>$<span class='no'>r</span>,<span class='no'>y</span>$<span class='no'>r</span>,<span class='kw'>n1</span><span class='kw'>=</span><span class='fl'>1000</span>,<span class='kw'>n2</span><span class='kw'>=</span><span class='fl'>1000</span>)   <span class='co'>#twice the degrees of freedom as the Jennrich</span></div><div class='output co'>#&gt; Tests of correlation matrices 
#&gt; Call:cortest.mat(R1 = x$r, R2 = y$r, n1 = 1000, n2 = 1000)
#&gt;  Chi Square value 22.73  with df =  20   with probability &lt; 0.3 </div><div class='input'>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#details">Details</a></li>

      <li><a href="#value">Value</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#note">Note</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
     William Revelle 
  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by William Revelle.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
