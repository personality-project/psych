<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Bootstrapped confidence intervals for raw and composite correlations — cor.ci • psych</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>

<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">psych</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Bootstrapped confidence intervals for raw and composite correlations</h1>
    </div>

    
    <p>Although normal theory provides confidence intervals for correlations, this is particularly problematic with Synthetic Aperture Personality Assessment (SAPA) data where the individual items are Massively Missing at Random.  Bootstrapped confidence intervals are found for Pearson, Spearman, Kendall, tetrachoric, or polychoric correlations and for scales made from those correlations.</p>
    

    <pre class="usage"><span class='fu'>cor.ci</span>(<span class='no'>x</span>, <span class='kw'>keys</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>n.iter</span> <span class='kw'>=</span> <span class='fl'>100</span>,  <span class='kw'>p</span> <span class='kw'>=</span> <span class='fl'>0.05</span>,<span class='kw'>overlap</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
 <span class='kw'>poly</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"pearson"</span>, <span class='kw'>plot</span><span class='kw'>=</span><span class='fl'>TRUE</span>,<span class='no'>...</span>)
 <span class='fu'>corCi</span>(<span class='no'>x</span>, <span class='kw'>keys</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>n.iter</span> <span class='kw'>=</span> <span class='fl'>100</span>,  <span class='kw'>p</span> <span class='kw'>=</span> <span class='fl'>0.05</span>,<span class='kw'>overlap</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
 <span class='kw'>poly</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"pearson"</span>, <span class='kw'>plot</span><span class='kw'>=</span><span class='fl'>TRUE</span>,<span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>The raw data</p></td>
    </tr>
    <tr>
      <th>keys</th>
      <td><p>If NULL, then the confidence intervals of the raw correlations are found.  Otherwise, composite scales are formed from the keys applied to the correlation matrix (in a logic similar to <code><a href='cluster.cor.html'>cluster.cor</a></code> but without the bells and whistles) and the confidence of those composite scales intercorrelations.</p></td>
    </tr>
    <tr>
      <th>n.iter</th>
      <td><p>The number of iterations to bootstrap over. This will be very slow if using tetrachoric/or polychoric correlations.</p></td>
    </tr>
    <tr>
      <th>p</th>
      <td><p>The upper and lower confidence region will include 1-p of the distribution.</p></td>
    </tr>
    <tr>
      <th>overlap</th>
      <td><p>If true, the correlation between overlapping scales is corrected for item overlap.</p></td>
    </tr>
    <tr>
      <th>poly</th>
      <td><p>if FALSE, then find the correlations using the method specified (defaults to Pearson).  If TRUE, the polychoric correlations will be found (slowly).  Because the polychoric function uses multicores (if available), and cor.ci does as well, the number of cores used is options("mc.cores")^2.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>"pearson","spearman", "kendall"</p></td>
    </tr>
    <tr>
      <th>plot</th>
      <td><p>Show the correlation plot with correlations scaled by the probability values.  To show the matrix in terms of the confidence intervals, use <code><a href='cor.plot.html'>cor.plot.upperLowerCi</a></code>.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Other parameters for axis (e.g., cex.axis to change the font size, srt to rotate the numbers in the plot)</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The original data are and correlations are found.  If keys are specified (the normal case), then composite scales based upon the correlations are found and reported.  This is the same procedure as done using <code><a href='cluster.cor.html'>cluster.cor</a></code> or <code><a href='score.items.html'>scoreItems</a></code>.</p>
<p>Then, n.iter times, the data are recreated by sampling subjects (rows) with replacement and the correlations (and composite scales) are found again (and again and again).  Mean and standard deviations of these values are calculated based upon the Fisher Z transform of the correlations.  Summary statistics include the original correlations and their confidence intervals.  For those who want the complete set of replications, those are available as an object in the resulting output.</p>
<p>Although particularly useful for SAPA (<a href = 'http://sapa-project.org'>http://sapa-project.org</a>) type data, this will work for any normal data set as well.</p>
<p>Although the correlations are shown automatically as a <code><a href='cor.plot.html'>cor.plot</a></code>, it is possible to show the upper and lower confidence intervals by using <code><a href='cor.plot.html'>cor.plot.upperLowerCi</a></code>. This will also return, invisibly, a matrix for printing with the lower and upper bounds of the correlations shown below and above the diagonal.</p>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    


<dt>rho </dt><dd><p>The original (composite) correlation matrix.</p></dd>
<dt>means </dt><dd><p>Mean (Fisher transformed) correlation</p></dd>
<dt>sds</dt><dd><p>Standard deviation of Fisher transformed correlations</p></dd>
<dt>ci</dt><dd><p>Mean +/- alpha/2 of the z scores as well as the alpha/2 and 1-alpha/2 quantiles. These are labeled as lower.emp(ircal), lower.norm(al), upper.norm and upper.emp.</p></dd>
<dt>replicates</dt><dd><p>The observed replication values so one can do one's own estimates</p></dd>

    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>For SAPA type data, see Revelle, W., Wilt, J.,  and Rosenthal, A. (2010)  Personality and Cognition: The Personality-Cognition Link. In Gruszka, A.  and Matthews, G. and Szymura, B. (Eds.) Handbook of Individual Differences in Cognition: Attention, Memory and Executive Control, Springer.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <p><code><a href='make.keys.html'>make.keys</a></code>, <code><a href='cluster.cor.html'>cluster.cor</a></code>, and <code><a href='score.items.html'>scoreItems</a></code> for forming synthetic correlation matrices from composites of item correlations.  See <code><a href='cluster.cor.html'>scoreOverlap</a></code> for correcting for item overlap in scales. See also <code><a href='corr.test.html'>corr.test</a></code> for standard significance testing of correlation matrices.  See also <code><a href='misc.html'>lowerCor</a></code> for finding and printing correlation matrices, as well as <code><a href='misc.html'>lowerMat</a></code> for displaying them. Also see <code><a href='cor.plot.html'>cor.plot.upperLowerCi</a></code> for displaying the confidence intervals graphically.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'>cor.ci</span>(<span class='no'>bfi</span>[<span class='fl'>1</span>:<span class='fl'>200</span>,<span class='fl'>1</span>:<span class='fl'>10</span>])  <span class='co'># just the first 10 variables</span></div><img src='cor.ci-2.png' alt='' width='540' height='400' /><div class='output co'>#&gt; Call:corCi(x = x, keys = keys, n.iter = n.iter, p = p, overlap = overlap, 
#&gt;     poly = poly, method = method, plot = plot)
#&gt; 
#&gt;  Coefficients and bootstrapped confidence intervals 
#&gt;    A1    A2    A3    A4    A5    C1    C2    C3    C4    C5   
#&gt; A1  1.00                                                      
#&gt; A2 -0.40  1.00                                                
#&gt; A3 -0.27  0.55  1.00                                          
#&gt; A4 -0.06  0.24  0.33  1.00                                    
#&gt; A5 -0.26  0.43  0.61  0.31  1.00                              
#&gt; C1 -0.10  0.19  0.15  0.10  0.06  1.00                        
#&gt; C2 -0.03  0.15  0.12  0.20  0.04  0.49  1.00                  
#&gt; C3 -0.04  0.17  0.08  0.11  0.07  0.44  0.48  1.00            
#&gt; C4  0.14 -0.24 -0.15 -0.10 -0.11 -0.34 -0.34 -0.33  1.00      
#&gt; C5  0.08 -0.10 -0.14 -0.12 -0.12 -0.26 -0.22 -0.27  0.41  1.00
#&gt; 
#&gt;  scale correlations and bootstrapped confidence intervals 
#&gt;       lower.emp lower.norm estimate upper.norm upper.emp    p
#&gt; A1-A2     -0.50      -0.51    -0.40      -0.27     -0.27 0.00
#&gt; A1-A3     -0.39      -0.41    -0.27      -0.11     -0.10 0.00
#&gt; A1-A4     -0.18      -0.19    -0.06       0.09      0.10 0.47
#&gt; A1-A5     -0.38      -0.38    -0.26      -0.11     -0.13 0.00
#&gt; A1-C1     -0.19      -0.22    -0.10       0.05      0.05 0.20
#&gt; A1-C2     -0.17      -0.17    -0.03       0.13      0.13 0.82
#&gt; A1-C3     -0.16      -0.20    -0.04       0.11      0.12 0.60
#&gt; A1-C4      0.03       0.03     0.14       0.26      0.25 0.02
#&gt; A1-C5     -0.01      -0.04     0.08       0.21      0.21 0.17
#&gt; A2-A3      0.42       0.40     0.55       0.67      0.67 0.00
#&gt; A2-A4      0.09       0.11     0.24       0.37      0.37 0.00
#&gt; A2-A5      0.31       0.30     0.43       0.55      0.54 0.00
#&gt; A2-C1      0.00       0.00     0.19       0.35      0.34 0.05
#&gt; A2-C2     -0.05      -0.04     0.15       0.30      0.30 0.13
#&gt; A2-C3      0.01       0.01     0.17       0.32      0.30 0.04
#&gt; A2-C4     -0.37      -0.38    -0.24      -0.10     -0.09 0.00
#&gt; A2-C5     -0.24      -0.24    -0.10       0.05      0.03 0.19
#&gt; A3-A4      0.19       0.19     0.33       0.47      0.50 0.00
#&gt; A3-A5      0.48       0.48     0.61       0.71      0.71 0.00
#&gt; A3-C1      0.01      -0.01     0.15       0.29      0.30 0.06
#&gt; A3-C2     -0.03      -0.06     0.12       0.26      0.24 0.21
#&gt; A3-C3     -0.07      -0.08     0.08       0.22      0.22 0.37
#&gt; A3-C4     -0.29      -0.30    -0.15       0.01      0.01 0.07
#&gt; A3-C5     -0.29      -0.29    -0.14       0.02      0.02 0.08
#&gt; A4-A5      0.14       0.14     0.31       0.47      0.47 0.00
#&gt; A4-C1     -0.02      -0.03     0.10       0.24      0.24 0.13
#&gt; A4-C2      0.06       0.05     0.20       0.34      0.34 0.01
#&gt; A4-C3      0.00      -0.02     0.11       0.24      0.26 0.09
#&gt; A4-C4     -0.21      -0.23    -0.10       0.02      0.04 0.11
#&gt; A4-C5     -0.27      -0.26    -0.12       0.01      0.01 0.08
#&gt; A5-C1     -0.10      -0.11     0.06       0.18      0.16 0.65
#&gt; A5-C2     -0.14      -0.14     0.04       0.17      0.15 0.82
#&gt; A5-C3     -0.07      -0.08     0.07       0.20      0.18 0.40
#&gt; A5-C4     -0.24      -0.25    -0.11       0.03      0.02 0.12
#&gt; A5-C5     -0.24      -0.24    -0.12       0.02      0.02 0.11
#&gt; C1-C2      0.35       0.34     0.49       0.61      0.62 0.00
#&gt; C1-C3      0.29       0.29     0.44       0.56      0.58 0.00
#&gt; C1-C4     -0.50      -0.49    -0.34      -0.15     -0.18 0.00
#&gt; C1-C5     -0.39      -0.39    -0.26      -0.10     -0.12 0.00
#&gt; C2-C3      0.37       0.36     0.48       0.58      0.59 0.00
#&gt; C2-C4     -0.51      -0.48    -0.34      -0.18     -0.20 0.00
#&gt; C2-C5     -0.34      -0.35    -0.22      -0.08     -0.08 0.00
#&gt; C3-C4     -0.48      -0.48    -0.33      -0.17     -0.19 0.00
#&gt; C3-C5     -0.38      -0.41    -0.27      -0.11     -0.10 0.00
#&gt; C4-C5      0.27       0.27     0.41       0.52      0.50 0.00</div><div class='input'><span class='co'>#The keys have overlapping scales</span>
  <span class='no'>keys.list</span> <span class='kw'>&lt;-</span> <span class='fu'>list</span>(<span class='kw'>agree</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='st'>"-A1"</span>,<span class='st'>"A2"</span>,<span class='st'>"A3"</span>,<span class='st'>"A4"</span>,<span class='st'>"A5"</span>), <span class='kw'>conscientious</span><span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"C1"</span>,
  <span class='st'>"C2"</span>,<span class='st'>"C3"</span>,<span class='st'>"-C4"</span>,<span class='st'>"-C5"</span>),<span class='kw'>extraversion</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='st'>"-E1"</span>,<span class='st'>"-E2"</span>,<span class='st'>"E3"</span>,<span class='st'>"E4"</span>,<span class='st'>"E5"</span>), <span class='kw'>neuroticism</span><span class='kw'>=</span>
  <span class='fu'>c</span>(<span class='st'>"N1"</span>, <span class='st'>"N2"</span>, <span class='st'>"N3"</span>,<span class='st'>"N4"</span>,<span class='st'>"N5"</span>), <span class='kw'>openness</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"O1"</span>,<span class='st'>"-O2"</span>,<span class='st'>"O3"</span>,<span class='st'>"O4"</span>,<span class='st'>"-O5"</span>),
  <span class='kw'>alpha</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='st'>"-A1"</span>,<span class='st'>"A2"</span>,<span class='st'>"A3"</span>,<span class='st'>"A4"</span>,<span class='st'>"A5"</span>,<span class='st'>"C1"</span>,<span class='st'>"C2"</span>,<span class='st'>"C3"</span>,<span class='st'>"-C4"</span>,<span class='st'>"-C5"</span>,<span class='st'>"N1"</span>,<span class='st'>"N2"</span>,<span class='st'>"N3"</span>,<span class='st'>"N4"</span>,<span class='st'>"N5"</span>),
<span class='kw'>beta</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"-E1"</span>,<span class='st'>"-E2"</span>,<span class='st'>"E3"</span>,<span class='st'>"E4"</span>,<span class='st'>"E5"</span>,<span class='st'>"O1"</span>,<span class='st'>"-O2"</span>,<span class='st'>"O3"</span>,<span class='st'>"O4"</span>,<span class='st'>"-O5"</span>) )
  <span class='no'>keys</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='make.keys.html'>make.keys</a></span>(<span class='no'>bfi</span>,<span class='no'>keys.list</span>)

<span class='co'>#do not correct for item overlap</span>
<span class='no'>rci</span> <span class='kw'>&lt;-</span>  <span class='fu'>cor.ci</span>(<span class='no'>bfi</span>[<span class='fl'>1</span>:<span class='fl'>200</span>,],<span class='no'>keys</span>,<span class='kw'>n.iter</span><span class='kw'>=</span><span class='fl'>10</span>,<span class='kw'>main</span><span class='kw'>=</span><span class='st'>"correlation with overlapping scales"</span>)</div><img src='cor.ci-5.png' alt='' width='540' height='400' /><div class='input'><span class='co'>#also shows the graphic -note the overlap</span>
<span class='co'>#correct for overlap</span>
<span class='no'>rci</span> <span class='kw'>&lt;-</span>  <span class='fu'>cor.ci</span>(<span class='no'>bfi</span>[<span class='fl'>1</span>:<span class='fl'>200</span>,],<span class='no'>keys</span>,<span class='kw'>overlap</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>n.iter</span><span class='kw'>=</span><span class='fl'>10</span>,<span class='kw'>main</span><span class='kw'>=</span><span class='st'>"Correct for overlap"</span>)</div><img src='cor.ci-7.png' alt='' width='540' height='400' /><div class='input'><span class='co'>#show the confidence intervals</span>
<span class='no'>ci</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='cor.plot.html'>cor.plot.upperLowerCi</a></span>(<span class='no'>rci</span>)  <span class='co'>#to show the upper and lower confidence intervals</span></div><img src='cor.ci-9.png' alt='' width='540' height='400' /><div class='input'><span class='no'>ci</span>   <span class='co'>#print the confidence intervals in matrix form</span></div><div class='output co'>#&gt; 
#&gt;  High and low confidence intervals 
#&gt;                agre cnsc  extr  nrtc  opnn alph  beta
#&gt; agree          1.00 0.38  0.52 -0.28  0.38 0.53  0.54
#&gt; conscientious  0.14 1.00  0.48 -0.17  0.38 0.58  0.48
#&gt; extraversion   0.38 0.03  1.00 -0.35  0.40 0.43  0.71
#&gt; neuroticism   -0.06 0.06 -0.15  1.00 -0.28 0.38 -0.37
#&gt; openness      -0.06 0.04  0.06  0.01  1.00 0.29  0.66
#&gt; alpha          0.25 0.39  0.04  0.27 -0.04 1.00  0.42
#&gt; beta           0.25 0.12  0.57 -0.13  0.41 0.04  1.00</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#details">Details</a></li>

      <li><a href="#value">Value</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    William Revelle
  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by William Revelle.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
