<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Apply the Very Simple Structure, MAP, and other criteria to determine the appropriate number of factors. — VSS • psych</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>

<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">psych</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Apply the Very Simple Structure, MAP, and other criteria to determine the appropriate number of factors.</h1>
    </div>

    
    <p>There are multiple ways to determine the appropriate number of factors in exploratory factor analysis. Routines for the Very Simple Structure (VSS) criterion allow one to compare solutions of varying complexity and for different number of factors. Graphic output indicates the "optimal" number of factors for different levels of complexity.  The Velicer MAP criterion is another good choice. <code>nfactors</code> finds and plots several of these alternative estimates.</p>
    

    <pre class="usage"><span class='fu'>vss</span>(<span class='no'>x</span>, <span class='kw'>n</span> <span class='kw'>=</span> <span class='fl'>8</span>, <span class='kw'>rotate</span> <span class='kw'>=</span> <span class='st'>"varimax"</span>, <span class='kw'>diagonal</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>fm</span> <span class='kw'>=</span> <span class='st'>"minres"</span>,
<span class='kw'>n.obs</span><span class='kw'>=</span><span class='kw'>NULL</span>,<span class='kw'>plot</span><span class='kw'>=</span><span class='fl'>TRUE</span>,<span class='kw'>title</span><span class='kw'>=</span><span class='st'>"Very Simple Structure"</span>,<span class='kw'>use</span><span class='kw'>=</span><span class='st'>"pairwise"</span>,<span class='kw'>cor</span><span class='kw'>=</span><span class='st'>"cor"</span>,<span class='no'>...</span>)
<span class='fu'>VSS</span>(<span class='no'>x</span>, <span class='kw'>n</span> <span class='kw'>=</span> <span class='fl'>8</span>, <span class='kw'>rotate</span> <span class='kw'>=</span> <span class='st'>"varimax"</span>, <span class='kw'>diagonal</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>fm</span> <span class='kw'>=</span> <span class='st'>"minres"</span>,
<span class='kw'>n.obs</span><span class='kw'>=</span><span class='kw'>NULL</span>,<span class='kw'>plot</span><span class='kw'>=</span><span class='fl'>TRUE</span>,<span class='kw'>title</span><span class='kw'>=</span><span class='st'>"Very Simple Structure"</span>,<span class='kw'>use</span><span class='kw'>=</span><span class='st'>"pairwise"</span>,<span class='kw'>cor</span><span class='kw'>=</span><span class='st'>"cor"</span>,<span class='no'>...</span>)
<span class='fu'>nfactors</span>(<span class='no'>x</span>,<span class='kw'>n</span><span class='kw'>=</span><span class='fl'>20</span>,<span class='kw'>rotate</span><span class='kw'>=</span><span class='st'>"varimax"</span>,<span class='kw'>diagonal</span><span class='kw'>=</span><span class='fl'>FALSE</span>,<span class='kw'>fm</span><span class='kw'>=</span><span class='st'>"minres"</span>,<span class='kw'>n.obs</span><span class='kw'>=</span><span class='kw'>NULL</span>,
             <span class='kw'>title</span><span class='kw'>=</span><span class='st'>"Number of Factors"</span>,<span class='kw'>pch</span><span class='kw'>=</span><span class='fl'>16</span>,<span class='kw'>use</span><span class='kw'>=</span><span class='st'>"pairwise"</span>, <span class='kw'>cor</span><span class='kw'>=</span><span class='st'>"cor"</span>,<span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>a correlation matrix or a data matrix</p></td>
    </tr>
    <tr>
      <th>n</th>
      <td><p>Number of factors to extract -- should be more than hypothesized!</p></td>
    </tr>
    <tr>
      <th>rotate</th>
      <td><p>what rotation to use c("none", "varimax",  "oblimin","promax")</p></td>
    </tr>
    <tr>
      <th>diagonal</th>
      <td><p>Should we fit the diagonal as well</p></td>
    </tr>
    <tr>
      <th>fm</th>
      <td><p>factoring method -- fm="pa"  Principal Axis Factor Analysis, fm = "minres" minimum residual (OLS) factoring fm="mle"  Maximum Likelihood FA, fm="pc" Principal Components"</p></td>
    </tr>
    <tr>
      <th>n.obs</th>
      <td><p>Number of observations if doing a factor analysis of correlation matrix.  This value is ignored by VSS but is necessary for the ML factor analysis package.</p></td>
    </tr>
    <tr>
      <th>plot</th>
      <td><p>plot=TRUE  Automatically call VSS.plot with the VSS output, otherwise don't plot</p></td>
    </tr>
    <tr>
      <th>title</th>
      <td><p>a title to be passed on to VSS.plot</p></td>
    </tr>
    <tr>
      <th>pch</th>
      <td><p>the plot character for the nfactors plots</p></td>
    </tr>
    <tr>
      <th>use</th>
      <td><p>If doing covariances or Pearson R, should we use "pairwise" or "complete cases"</p></td>
    </tr>
    <tr>
      <th>cor</th>
      <td><p>What kind of correlation to find, defaults to Pearson but see fa for the choices</p></td>
    </tr>
    <tr>
      <th>&#8230;</th>
      <td><p>parameters to pass to the factor analysis program 
      The most important of these is if using a correlation matrix is covmat= xx</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Determining the most interpretable number of factors from a factor analysis is perhaps one of the greatest challenges in factor analysis.  There are many solutions to this problem, none of which is uniformly the best.  "Solving the number of factors problem is easy, I do it everyday before breakfast."  But knowing the right solution is harder. (Horn and Engstrom, 1979) (Henry Kaiser in personal communication with J.L. Horn, as cited by Horn and Engstrom, 1979, MBR p 283).</p>
<p>Techniques most commonly used include</p>
<p>1)  Extracting factors until the chi square of the residual matrix is not significant.</p>
<p>2) Extracting factors until the change in chi square from factor n to factor n+1 is not significant.</p>
<p>3) Extracting factors until the eigen values of the real data are less than the corresponding eigen values of a random data set of the same size (parallel analysis) <code><a href='fa.parallel.html'>fa.parallel</a></code>.</p>
<p>4) Plotting the magnitude of the successive eigen values and applying the scree test (a sudden drop in eigen values analogous to the change in slope seen when scrambling up the talus slope of a mountain and approaching the rock face.</p>
<p>5) Extracting principal components until the eigen value &lt; 1.</p>
<p>6) Extracting factors as long as they are interpetable.
    7) Using the Very Simple Structure Criterion (VSS).</p>
<p>8) Using Wayne Velicer's Minimum Average Partial (MAP) criterion.</p>
<p>Each of the procedures has its advantages and disadvantages.  Using either the chi square test or the change in square test is, of course, sensitive to the number of subjects and leads to the nonsensical condition that if one wants to find many factors, one simply runs more subjects. Parallel analysis is partially sensitive to sample size in that for large samples the eigen values of random factors will be very small.  The scree test is quite appealling but can lead to differences of interpretation as to when the scree "breaks". The eigen value of 1 rule, although the default for many programs, seems to be a rough way of dividing the number of variables by 3.  Extracting interpretable factors means that the number of factors reflects the investigators creativity more than the data.  VSS, while very simple to understand, will not work very well if the data are very factorially complex. (Simulations suggests it will work fine if the complexities of some of the items are no more than 2).</p>
    <p>Most users of factor analysis tend to interpret factor output by focusing their attention on the largest loadings for every variable and ignoring the smaller ones.  Very Simple Structure operationalizes this tendency by  comparing the original correlation matrix to that reproduced by a simplified version (S) of the original factor matrix (F).  R = SS' + U2.   S is composed of just the c greatest (in absolute value) loadings for each variable.  C (or complexity) is a parameter of the model and may vary from 1 to the number of factors.</p>
<p>The VSS criterion compares the fit of the simplified model to the original correlations: VSS = 1 -sumsquares(r*)/sumsquares(r)  where R* is the residual matrix R* = R - SS' and r* and r are the elements of R* and R respectively.</p>
<p>VSS for a given complexity will tend to peak at the optimal (most interpretable) number of factors (Revelle and Rocklin, 1979).</p>
<p>Although originally written in Fortran for main frame computers, VSS has been adapted to micro computers (e.g., Macintosh OS 6-9) using Pascal. We now release R code for calculating VSS.</p>
<p>Note that if using a correlation matrix (e.g., my.matrix) and doing a factor analysis, the parameters n.obs should be specified for the factor analysis:
e.g., the call is VSS(my.matrix,n.obs=500).  Otherwise it defaults to 1000.</p>
<p>Wayne Velicer's MAP criterion has been added as an additional test for the optimal number of components to extract.  Note that VSS and MAP will not always agree as to the optimal number.</p>
<p>The nfactors function will do a VSS, find MAP, and report a number of other criteria (e.g., BIC, complexity, chi square, ...)</p>
    <p>A variety of rotation options are available. These include varimax, promax, and oblimin. Others can be added.  Suggestions are welcome.</p>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A data.frame with entries:
 map:  Velicer's MAP values (lower values are better) 
 dof:  degrees of freedom    (if using FA) 
 chisq: chi square (from the factor analysis output  (if using FA) 
 prob: probability of residual matrix &gt; 0  (if using FA) 
 sqresid: squared residual correlations
 RMSEA: the RMSEA for each number of factors 
 BIC: the BIC for each number of factors 
 eChiSq: the empirically found chi square 
 eRMS: Empirically found mean residual 
 eCRMS: Empirically found mean residual corrected for df 
 eBIC: The empirically found BIC based upon the eChiSq 
 fit: factor fit of the complete model
 cfit.1: VSS fit of complexity 1
 cfit.2: VSS fit of complexity 2 
 ... 
 cfit.8: VSS fit of complexity 8
 cresidiual.1: sum squared residual correlations for complexity 1
 ...:  sum squared residual correlations for complexity 2 ..8</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p><a href = 'http://personality-project.org/r/vss.html'>http://personality-project.org/r/vss.html</a>,
Revelle, W. An introduction to psychometric theory with applications in R (in prep) Springer. Draft chapters available at  <a href = 'http://personality-project.org/r/book/'>http://personality-project.org/r/book/</a></p>
<p>Revelle, W. and Rocklin, T. 1979, Very Simple Structure: an Alternative Procedure for Estimating the Optimal Number of Interpretable Factors, Multivariate Behavioral Research, 14, 403-414. 
<a href = 'http://personality-project.org/revelle/publications/vss.pdf'>http://personality-project.org/revelle/publications/vss.pdf</a></p>
<p>Velicer, W. (1976) Determining the number of components from the matrix of partial correlations. Psychometrika, 41, 321-327.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <p><code><a href='VSS.plot.html'>VSS.plot</a></code>,  <code><a href='ICLUST.html'>ICLUST</a></code>, <code><a href='omega.html'>omega</a></code>,
 <code><a href='fa.parallel.html'>fa.parallel</a></code></p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'>#test.data &lt;- Harman74.cor$cov</span>
<span class='co'>#my.vss &lt;- VSS(test.data,title="VSS of 24 mental tests")      </span>
<span class='co'>#print(my.vss[,1:12],digits =2) </span>
<span class='co'>#VSS.plot(my.vss, title="VSS of 24 mental tests")</span>

<span class='co'>#now, some simulated data with two factors</span>
<span class='co'>#VSS(sim.circ(nvar=24),fm="minres" ,title="VSS of 24 circumplex variables")</span>
<span class='fu'>VSS</span>(<span class='fu'><a href='sim.item.html'>sim.item</a></span>(<span class='kw'>nvar</span><span class='kw'>=</span><span class='fl'>24</span>),<span class='kw'>fm</span><span class='kw'>=</span><span class='st'>"minres"</span> ,<span class='kw'>title</span><span class='kw'>=</span><span class='st'>"VSS of 24 simple structure variables"</span>)</div><img src='VSS-2.png' alt='' width='540' height='400' /><div class='output co'>#&gt; 
#&gt; Very Simple Structure of  VSS of 24 simple structure variables 
#&gt; Call: vss(x = x, n = n, rotate = rotate, diagonal = diagonal, fm = fm, 
#&gt;     n.obs = n.obs, plot = plot, title = title, use = use, cor = cor)
#&gt; VSS complexity 1 achieves a maximimum of 0.83  with  4  factors
#&gt; VSS complexity 2 achieves a maximimum of 0.85  with  8  factors
#&gt; 
#&gt; The Velicer MAP achieves a minimum of 0.01  with  2  factors 
#&gt; BIC achieves a minimum of  -1169.09  with  2  factors
#&gt; Sample Size adjusted BIC achieves a minimum of  -442.23  with  2  factors
#&gt; 
#&gt; Statistics by number of factors 
#&gt;   vss1 vss2    map dof chisq     prob sqresid  fit  RMSEA   BIC SABIC complex
#&gt; 1 0.44 0.00 0.0360 252  1807 9.5e-233    33.0 0.44 0.1124   240  1040     1.0
#&gt; 2 0.82 0.83 0.0062 229   254  1.2e-01    10.1 0.83 0.0163 -1169  -442     1.0
#&gt; 3 0.82 0.83 0.0084 207   210  4.2e-01     9.6 0.84 0.0088 -1076  -419     1.1
#&gt; 4 0.83 0.84 0.0108 186   177  6.6e-01     9.2 0.85 0.0000  -979  -388     1.1
#&gt; 5 0.82 0.84 0.0134 166   144  9.0e-01     8.7 0.85 0.0000  -888  -361     1.2
#&gt; 6 0.82 0.85 0.0166 147   120  9.5e-01     8.4 0.86 0.0000  -794  -327     1.3
#&gt; 7 0.77 0.85 0.0201 129    98  9.8e-01     8.0 0.87 0.0000  -704  -294     1.3
#&gt; 8 0.82 0.85 0.0240 112    82  9.9e-01     7.7 0.87 0.0000  -614  -259     1.4
#&gt;   eChisq  SRMR eCRMS  eBIC
#&gt; 1   8230 0.173 0.181  6664
#&gt; 2    209 0.028 0.030 -1214
#&gt; 3    167 0.025 0.028 -1119
#&gt; 4    134 0.022 0.027 -1022
#&gt; 5    106 0.020 0.025  -926
#&gt; 6     84 0.017 0.024  -829
#&gt; 7     68 0.016 0.023  -734
#&gt; 8     54 0.014 0.022  -642</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#details">Details</a></li>

      <li><a href="#value">Value</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    William Revelle
  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by William Revelle.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
