<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Principal components analysis (PCA) — principal • psych</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>

<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">psych</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Principal components analysis (PCA)</h1>
    </div>

    
    <p>Does an eigen value decomposition and returns eigen values, loadings, and degree of fit for a specified number of components.  Basically it is just  doing a principal components analysis (PCA) for n principal components of either a correlation or covariance matrix.  Can show the residual correlations as well. The quality of reduction in the squared correlations is reported by comparing residual correlations to original correlations. Unlike princomp, this returns a subset of just the best nfactors. The eigen vectors are rescaled by the sqrt of the eigen values to produce the component loadings more typical in factor analysis.</p>
    

    <pre class="usage"><span class='fu'>principal</span>(<span class='no'>r</span>, <span class='kw'>nfactors</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>residuals</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,<span class='kw'>rotate</span><span class='kw'>=</span><span class='st'>"varimax"</span>,<span class='kw'>n.obs</span><span class='kw'>=</span><span class='fl'>NA</span>, <span class='kw'>covar</span><span class='kw'>=</span><span class='fl'>FALSE</span>,
 <span class='kw'>scores</span><span class='kw'>=</span><span class='fl'>TRUE</span>,<span class='kw'>missing</span><span class='kw'>=</span><span class='fl'>FALSE</span>,<span class='kw'>impute</span><span class='kw'>=</span><span class='st'>"median"</span>,<span class='kw'>oblique.scores</span><span class='kw'>=</span><span class='fl'>TRUE</span>,<span class='kw'>method</span><span class='kw'>=</span><span class='st'>"regression"</span>,<span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>r</th>
      <td><p>a correlation matrix.  If a raw data matrix is used, the correlations will be found using pairwise deletions for missing values.</p></td>
    </tr>
    <tr>
      <th>nfactors</th>
      <td><p>Number of components to extract</p></td>
    </tr>
    <tr>
      <th>residuals</th>
      <td><p>FALSE, do not show residuals, TRUE, report residuals</p></td>
    </tr>
    <tr>
      <th>rotate</th>
      <td><p>"none", "varimax", "quatimax", "promax", "oblimin", "simplimax", and "cluster" are possible rotations/transformations of the solution. See <code><a href='fa.html'>fa</a></code> for all rotations avaiable.</p></td>
    </tr>
    <tr>
      <th>n.obs</th>
      <td><p>Number of observations used to find the correlation matrix if using a correlation matrix.  Used for finding the goodness of fit statistics.</p></td>
    </tr>
    <tr>
      <th>covar</th>
      <td><p>If false, find the correlation matrix from the raw data or convert to a correlation matrix if given a square matrix as input.</p></td>
    </tr>
    <tr>
      <th>scores</th>
      <td><p>If TRUE, find component scores</p></td>
    </tr>
    <tr>
      <th>missing</th>
      <td><p>if scores are TRUE, and missing=TRUE, then impute missing values using either the median or the mean</p></td>
    </tr>
    <tr>
      <th>impute</th>
      <td><p>"median" or "mean" values are used to replace missing values</p></td>
    </tr>
    <tr>
      <th>oblique.scores</th>
      <td><p>If TRUE (default), then the component scores are based upon the structure matrix.  If FALSE, upon the pattern matrix.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>Which way of finding component scores should be used. The default is "regression"</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>other parameters to pass to functions such as factor.scores or the various rotation functions.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Useful for those cases where the correlation matrix is improper (perhaps because of SAPA techniques).</p>
<p>There are a number of data reduction techniques including principal components analysis (PCA) and factor analysis (EFA).  Both PC and FA attempt to approximate a given correlation or covariance matrix of rank n with matrix of lower rank (p).  \(_nR_n \approx _{n}F_{kk}F_n'+ U^2\) where k is much less than n.  For principal components, the item uniqueness is assumed to be zero and all elements of the correlation or covariance matrix are fitted. That is, \(_nR_n \approx _{n}F_{kk}F_n'\)  The primary empirical difference between a components versus a factor model is the treatment of the variances for each item.  Philosophically, components are weighted composites of observed variables while in the factor model, variables are weighted composites of the factors.</p>
<p>For a n x n correlation matrix, the n principal components completely reproduce the correlation matrix.  However, if just the first k principal components are extracted, this is the best k dimensional approximation of the matrix.</p>
<p>It is important to recognize that rotated principal components are not principal components (the axes associated with the eigen value decomposition) but are merely components.  To point this out, unrotated principal components are labelled as PCi, while rotated PCs are now labeled as RCi (for rotated components) and obliquely transformed components as TCi (for transformed components). (Thanks to Ulrike Gromping for this suggestion.)</p>
<p>Rotations and transformations are either part of psych (Promax and cluster), of base R (varimax), or of GPArotation (simplimax, quartimax, oblimin, etc.).</p>
<p>Of the various rotation/transformation options, varimax, Varimax, quartimax, bentlerT, geominT, and bifactor do orthogonal rotations. Promax  transforms obliquely with a target matix equal to the varimax solution. oblimin, quartimin, simplimax,  bentlerQ,  geominQ and biquartimin are oblique transformations. Most of these are just calls to  the GPArotation package. The ``cluster'' option does a targeted rotation to a structure defined by the cluster representation of a varimax solution.  With the optional "keys" parameter, the "target" option will rotate to a target supplied as a keys matrix. (See <code><a href='Promax.html'>target.rot</a></code>.)</p>
<p>The rotation matrix  (rot.mat) is returned from all of these options. This is the inverse of the Th (theta?) object returned by the GPArotation package.  The correlations of the factors may be found by \(\Phi = \theta' \theta\)</p>
<p>Some of the statistics reported are more appropriate for (maximum likelihood) factor analysis rather than principal components analysis, and are reported to allow comparisons with these other models.</p>
<p>Although for items, it is typical to find component scores by scoring the salient items (using, e.g., <code><a href='score.items.html'>scoreItems</a></code>) component scores are found  by regression where the regression weights are \(R^{-1} \lambda\) where \(\lambda\) is the matrix of component loadings.   The regression approach is done  to be parallel with the factor analysis function <code><a href='fa.html'>fa</a></code>.  The regression weights are found from the inverse of the correlation matrix times the component loadings.   This has the result that the component scores are standard scores (mean=0, sd = 1) of the standardized input.  A comparison to the scores from <code>princomp</code> shows this difference.  princomp does not, by default, standardize the data matrix, nor are the components themselves standardized.  The regression weights are found from the Structure matrix, not the Pattern matrix. If the scores are found with the covar option = TRUE, then the scores are not standardized but are just mean centered.</p>
<p>Jolliffe (2002) discusses why the interpretation of rotated components is complicated.   Rencher (1992) discourages the use of rotated components. The approach used here is consistent with the factor analytic tradition.  The correlations of the items with the component scores closely matches (as it should) the component loadings (as reported in the structure matrix).</p>
<p>The output from the print.psych function displays the component loadings (from the pattern matrix), the h2 (communalities) the u2 (the uniquenesses), com (the complexity of the component loadings for that variable (see below).  In the case of an orthogonal solution, h2 is merely the row sum of the squared component loadings. But for an oblique solution, it is the row sum of the (squared) orthogonal component loadings (remember, that rotations or transformations do not change the communality).  This information is returned (invisibly) from the print function as the object Vaccounted.</p>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p></p>
<dt>values</dt><dd><p>Eigen Values of all components -- useful for a scree plot</p></dd>
  <dt>rotation</dt><dd><p>which rotation was requested?</p></dd>
  <dt>n.obs</dt><dd><p>number of observations specified or found</p></dd>
   <dt>communality</dt><dd><p>Communality estimates for each item.  These are merely the sum of squared factor loadings for that item.</p></dd>
    <dt>complexity</dt><dd><p>Hoffman's index of complexity for each item.  This is just \(\frac{(\Sigma a_i^2)^2}{\Sigma a_i^4}\) where a_i is the factor loading on the ith factor. From Hofmann (1978), MBR. See also  Pettersson and Turkheimer (2010).</p></dd>

  <dt>loadings </dt><dd><p>A standard loading matrix of class ``loadings"</p></dd>
  <dt>fit </dt><dd><p>Fit of the model to the correlation matrix</p></dd>
  <dt>fit.off</dt><dd><p>how well are the off diagonal elements reproduced?</p></dd>
  <dt>residual </dt><dd><p>Residual matrix -- if requested</p></dd>
  <dt>dof</dt><dd><p>Degrees of Freedom for this model. This is the number of observed correlations minus the number of independent parameters (number of items * number of factors - nf*(nf-1)/2.   That is, dof = niI * (ni-1)/2 - ni * nf + nf*(nf-1)/2.</p></dd>
  <dt>objective</dt><dd><p>value of the function that is minimized by maximum likelihood procedures.  This is reported for comparison purposes and as a way to estimate chi square goodness of fit.  The objective function is 
  
  \(f = log(trace ((FF'+U2)^{-1} R) -  log(|(FF'+U2)^{-1} R|) - n.items\).   Because components do not minimize the off diagonal, this fit will be not as good as for factor analysis.</p></dd>
  
  <dt>STATISTIC</dt><dd><p>If the number of observations is specified or found, this is a chi square based upon the objective function, f.  Using the formula from <code>factanal</code>:
 
 \(\chi^2 = (n.obs - 1 - (2 * p + 5)/6 - (2 * factors)/3)) * f \)</p></dd>
 
 <dt>PVAL</dt><dd><p>If n.obs &gt; 0, then what is the probability of observing a chisquare this large or larger?</p></dd>
 <dt>phi</dt><dd><p>If oblique rotations (using oblimin from the GPArotation package) are requested, what is the interfactor correlation.</p></dd>
 <dt>scores</dt><dd><p>If scores=TRUE, then estimates of the factor scores are reported</p></dd>
 <dt>weights</dt><dd><p>The beta weights to find the principal components from the data</p></dd>
 <dt>R2</dt><dd><p>The multiple R square between the factors and factor score estimates, if they were to be found. (From Grice, 2001)  For components, these are of course 1.0.</p></dd>
<dt>valid</dt><dd><p>The correlations of the component score estimates with the components, if they were to be found and unit weights were used. (So called course coding).</p></dd>
<dt>rot.mat</dt><dd><p>The rotation matrix used to produce the rotated component loadings.</p></dd>

    
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>By default, the accuracy of the varimax rotation function seems to be less than the Varimax function. This can be enhanced by specifying eps=1e-14 in the call to principal if using varimax rotation. Furthermore, note that Varimax by default does not apply the Kaiser normalization, but varimax does. Gottfried Helms compared these two rotations with those produced by SPSS and found identical values if using the appropriate options. (See the last two examples.)</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    
    <p>Grice, James W.  (2001), Computing and evaluating factor scores. Psychological Methods, 6, 430-450</p>
<p>Jolliffe, I. (2002)  Principal Component Analysis (2nd ed). Springer.</p>
<p>Rencher, A. C. (1992) Interpretation of Canonical Discriminant Functions, Canonical Variates, and Principal Components, the American Statistician, (46) 217-225.</p>
<p>Revelle, W. An introduction to psychometric theory with applications in R (in prep) Springer. Draft chapters available at  <a href = 'http://personality-project.org/r/book/'>http://personality-project.org/r/book/</a></p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <p><code><a href='VSS.html'>VSS</a></code> (to test for the number of components or factors to extract), <code><a href='VSS.scree.html'>VSS.scree</a></code> and <code><a href='fa.parallel.html'>fa.parallel</a></code> to show a scree plot and compare it with random resamplings of the data), <code><a href='factor2cluster.html'>factor2cluster</a></code> (for course coding keys), <code><a href='fa.html'>fa</a></code> (for factor analysis), <code><a href='factor.congruence.html'>factor.congruence</a></code> (to compare solutions), <code><a href='predict.psych.html'>predict.psych</a></code> to find factor/component scores for a new data set based upon the weights from an original data set.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>#Four principal components of the Harman 24 variable problem</span>
<span class='co'>#compare to a four factor principal axes solution using factor.congruence</span>
<span class='no'>pc</span> <span class='kw'>&lt;-</span> <span class='fu'>principal</span>(<span class='no'>Harman74.cor</span>$<span class='no'>cov</span>,<span class='fl'>4</span>,<span class='kw'>rotate</span><span class='kw'>=</span><span class='st'>"varimax"</span>)
<span class='no'>mr</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='fa.html'>fa</a></span>(<span class='no'>Harman74.cor</span>$<span class='no'>cov</span>,<span class='fl'>4</span>,<span class='kw'>rotate</span><span class='kw'>=</span><span class='st'>"varimax"</span>)  <span class='co'>#minres factor analysis</span>
<span class='no'>pa</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='fa.html'>fa</a></span>(<span class='no'>Harman74.cor</span>$<span class='no'>cov</span>,<span class='fl'>4</span>,<span class='kw'>rotate</span><span class='kw'>=</span><span class='st'>"varimax"</span>,<span class='kw'>fm</span><span class='kw'>=</span><span class='st'>"pa"</span>)  <span class='co'># principal axis factor analysis</span>
<span class='fu'>round</span>(<span class='fu'><a href='factor.congruence.html'>factor.congruence</a></span>(<span class='fu'>list</span>(<span class='no'>pc</span>,<span class='no'>mr</span>,<span class='no'>pa</span>)),<span class='fl'>2</span>)</div><div class='output co'>#&gt;      RC1  RC3  RC2  RC4  MR1  MR3  MR2  MR4  PA1  PA3  PA2  PA4
#&gt; RC1 1.00 0.53 0.43 0.46 1.00 0.61 0.46 0.54 1.00 0.61 0.46 0.54
#&gt; RC3 0.53 1.00 0.43 0.47 0.54 0.99 0.44 0.54 0.54 0.99 0.44 0.54
#&gt; RC2 0.43 0.43 1.00 0.47 0.44 0.50 1.00 0.55 0.44 0.50 1.00 0.55
#&gt; RC4 0.46 0.47 0.47 1.00 0.47 0.53 0.49 0.99 0.47 0.53 0.49 0.99
#&gt; MR1 1.00 0.54 0.44 0.47 1.00 0.61 0.46 0.55 1.00 0.61 0.46 0.55
#&gt; MR3 0.61 0.99 0.50 0.53 0.61 1.00 0.50 0.61 0.61 1.00 0.50 0.61
#&gt; MR2 0.46 0.44 1.00 0.49 0.46 0.50 1.00 0.57 0.46 0.50 1.00 0.57
#&gt; MR4 0.54 0.54 0.55 0.99 0.55 0.61 0.57 1.00 0.55 0.61 0.57 1.00
#&gt; PA1 1.00 0.54 0.44 0.47 1.00 0.61 0.46 0.55 1.00 0.61 0.46 0.55
#&gt; PA3 0.61 0.99 0.50 0.53 0.61 1.00 0.50 0.61 0.61 1.00 0.50 0.61
#&gt; PA2 0.46 0.44 1.00 0.49 0.46 0.50 1.00 0.57 0.46 0.50 1.00 0.57
#&gt; PA4 0.54 0.54 0.55 0.99 0.55 0.61 0.57 1.00 0.55 0.61 0.57 1.00</div><div class='input'>
<span class='no'>pc2</span> <span class='kw'>&lt;-</span> <span class='fu'>principal</span>(<span class='no'>Harman.5</span>,<span class='fl'>2</span>,<span class='kw'>rotate</span><span class='kw'>=</span><span class='st'>"varimax"</span>)
<span class='no'>pc2</span></div><div class='output co'>#&gt; Principal Components Analysis
#&gt; Call: principal(r = Harman.5, nfactors = 2, rotate = "varimax")
#&gt; Standardized loadings (pattern matrix) based upon correlation matrix
#&gt;               RC1   RC2   h2    u2 com
#&gt; population   0.02  0.99 0.99 0.012 1.0
#&gt; schooling    0.94 -0.01 0.89 0.115 1.0
#&gt; employment   0.14  0.98 0.98 0.021 1.0
#&gt; professional 0.83  0.45 0.88 0.120 1.5
#&gt; housevalue   0.97 -0.01 0.94 0.062 1.0
#&gt; 
#&gt;                        RC1  RC2
#&gt; SS loadings           2.52 2.15
#&gt; Proportion Var        0.50 0.43
#&gt; Cumulative Var        0.50 0.93
#&gt; Proportion Explained  0.54 0.46
#&gt; Cumulative Proportion 0.54 1.00
#&gt; 
#&gt; Mean item complexity =  1.1
#&gt; Test of the hypothesis that 2 components are sufficient.
#&gt; 
#&gt; The root mean square of the residuals (RMSR) is  0.03 
#&gt;  with the empirical chi square  0.29  with prob &lt;  0.59 
#&gt; 
#&gt; Fit based upon off diagonal values = 1</div><div class='input'><span class='fu'>round</span>(<span class='fu'>cor</span>(<span class='no'>Harman.5</span>,<span class='no'>pc2</span>$<span class='no'>scores</span>),<span class='fl'>2</span>)  <span class='co'>#compare these correlations to the loadings </span></div><div class='output co'>#&gt;               RC1   RC2
#&gt; population   0.02  0.99
#&gt; schooling    0.94 -0.01
#&gt; employment   0.14  0.98
#&gt; professional 0.83  0.45
#&gt; housevalue   0.97 -0.01</div><div class='input'><span class='co'>#now do it for unstandardized scores, and transform obliquely</span>
<span class='no'>pc2o</span> <span class='kw'>&lt;-</span> <span class='fu'>principal</span>(<span class='no'>Harman.5</span>,<span class='fl'>2</span>,<span class='kw'>rotate</span><span class='kw'>=</span><span class='st'>"promax"</span>,<span class='kw'>covar</span><span class='kw'>=</span><span class='fl'>TRUE</span>)
<span class='no'>pc2o</span></div><div class='output co'>#&gt; Principal Components Analysis
#&gt; Call: principal(r = Harman.5, nfactors = 2, rotate = "promax", covar = TRUE)
#&gt; Unstandardized loadings (pattern matrix) based upon covariance matrix
#&gt;                 RC1     RC2      h2      u2   H2      U2
#&gt; population    -40.1 3440.30 1.2e+07 6.7e+03 1.00 5.7e-04
#&gt; schooling       1.5   -0.01 2.4e+00 8.1e-01 0.75 2.5e-01
#&gt; employment    110.3 1210.10 1.5e+06 5.4e+04 0.96 3.5e-02
#&gt; professional   87.7   48.30 1.0e+04 2.9e+03 0.78 2.2e-01
#&gt; housevalue   6368.4  -23.16 4.1e+07 2.2e+01 1.00 5.4e-07
#&gt; 
#&gt;                               RC1         RC2
#&gt; SS loadings           40571924.73 13297286.79
#&gt; Proportion Var               0.75        0.25
#&gt; Cumulative Var               0.75        1.00
#&gt; Proportion Explained         0.75        0.25
#&gt; Cumulative Proportion        0.75        1.00
#&gt; 
#&gt;  Standardized loadings (pattern matrix)
#&gt;              item   RC1   RC2   h2      u2
#&gt; population      1 -0.01  1.00 1.00 5.7e-04
#&gt; schooling       2  0.86 -0.01 0.75 2.5e-01
#&gt; employment      3  0.09  0.97 0.96 3.5e-02
#&gt; professional    4  0.76  0.42 0.78 2.2e-01
#&gt; housevalue      5  1.00  0.00 1.00 5.4e-07
#&gt; 
#&gt;                  RC1  RC2
#&gt; SS loadings     3.76 1.23
#&gt; Proportion Var  0.75 0.25
#&gt; Cumulative Var  0.75 1.00
#&gt; Cum. factor Var 0.75 1.00
#&gt; 
#&gt;  With component correlations of 
#&gt;      RC1  RC2
#&gt; RC1 1.00 0.04
#&gt; RC2 0.04 1.00
#&gt; 
#&gt; Mean item complexity =  1.1
#&gt; Test of the hypothesis that 2 components are sufficient.
#&gt; 
#&gt; The root mean square of the residuals (RMSR) is  6040.31 
#&gt;  with the empirical chi square  8756488842  with prob &lt;  0 
#&gt; 
#&gt; Fit based upon off diagonal values = 1</div><div class='input'><span class='fu'>round</span>(<span class='fu'>cov</span>(<span class='no'>Harman.5</span>,<span class='no'>pc2o</span>$<span class='no'>scores</span>),<span class='fl'>2</span>)</div><div class='output co'>#&gt;                  RC1     RC2
#&gt; population     89.53 3438.79
#&gt; schooling       1.54    0.05
#&gt; employment    155.90 1214.25
#&gt; professional   89.56   51.60
#&gt; housevalue   6367.49  216.72</div><div class='input'><span class='no'>pc2o</span>$<span class='no'>Structure</span>    <span class='co'>#this matches the covariances with the scores</span></div><div class='output co'>#&gt;                      RC1          RC2
#&gt; population     89.532324 3.438787e+03
#&gt; schooling       1.542246 4.714838e-02
#&gt; employment    155.900367 1.214255e+03
#&gt; professional   89.559504 5.160112e+01
#&gt; housevalue   6367.487506 2.167238e+02</div><div class='input'><span class='fu'>biplot</span>(<span class='no'>pc2</span>,<span class='kw'>main</span><span class='kw'>=</span><span class='st'>"Biplot of the Harman.5 socio-economic variables"</span>,<span class='kw'>labels</span><span class='kw'>=</span><span class='fu'>paste0</span>(<span class='fl'>1</span>:<span class='fl'>12</span>))</div><img src='principal-14.png' alt='' width='540' height='400' /><div class='input'>
<span class='co'>#For comparison with SPSS  (contributed by Gottfried Helms)</span>
<span class='no'>pc2v</span> <span class='kw'>&lt;-</span> <span class='fu'>principal</span>(<span class='no'>iris</span>[<span class='fl'>1</span>:<span class='fl'>4</span>],<span class='fl'>2</span>,<span class='kw'>rotate</span><span class='kw'>=</span><span class='st'>"varimax"</span>,<span class='kw'>normalize</span><span class='kw'>=</span><span class='fl'>FALSE</span>,<span class='kw'>eps</span><span class='kw'>=</span><span class='fl'>1e-14</span>)
<span class='fu'>print</span>(<span class='no'>pc2v</span>,<span class='kw'>digits</span><span class='kw'>=</span><span class='fl'>7</span>)</div><div class='output co'>#&gt; Principal Components Analysis
#&gt; Call: principal(r = iris[1:4], nfactors = 2, rotate = "varimax", normalize = FALSE, 
#&gt;     eps = 1e-14)
#&gt; Standardized loadings (pattern matrix) based upon correlation matrix
#&gt;                     RC1        RC2        h2          u2      com
#&gt; Sepal.Length  0.9593182  0.0480331 0.9225986 0.077401362 1.005014
#&gt; Sepal.Width  -0.1442732  0.9849389 0.9909193 0.009080678 1.042893
#&gt; Petal.Length  0.9441083 -0.3039564 0.9837300 0.016270047 1.205101
#&gt; Petal.Width   0.9323563 -0.2568894 0.9352804 0.064719625 1.150960
#&gt; 
#&gt;                             RC1       RC2
#&gt; SS loadings           2.7017349 1.1307934
#&gt; Proportion Var        0.6754337 0.2826983
#&gt; Cumulative Var        0.6754337 0.9581321
#&gt; Proportion Explained  0.7049485 0.2950515
#&gt; Cumulative Proportion 0.7049485 1.0000000
#&gt; 
#&gt; Mean item complexity =  1.1
#&gt; Test of the hypothesis that 2 components are sufficient.
#&gt; 
#&gt; The root mean square of the residuals (RMSR) is  0.030876 
#&gt;  with the empirical chi square  1.715987  with prob &lt;  NA 
#&gt; 
#&gt; Fit based upon off diagonal values = 0.9978717</div><div class='input'><span class='no'>pc2V</span> <span class='kw'>&lt;-</span> <span class='fu'>principal</span>(<span class='no'>iris</span>[<span class='fl'>1</span>:<span class='fl'>4</span>],<span class='fl'>2</span>,<span class='kw'>rotate</span><span class='kw'>=</span><span class='st'>"Varimax"</span>,<span class='kw'>eps</span><span class='kw'>=</span><span class='fl'>1e-7</span>)
<span class='no'>p</span> <span class='kw'>&lt;-</span> <span class='fu'>print</span>(<span class='no'>pc2V</span>,<span class='kw'>digits</span><span class='kw'>=</span><span class='fl'>7</span>)</div><div class='output co'>#&gt; Principal Components Analysis
#&gt; Call: principal(r = iris[1:4], nfactors = 2, rotate = "Varimax", eps = 1e-07)
#&gt; Standardized loadings (pattern matrix) based upon correlation matrix
#&gt;                     RC1        RC2        h2          u2      com
#&gt; Sepal.Length  0.9593182  0.0480331 0.9225986 0.077401362 1.005014
#&gt; Sepal.Width  -0.1442732  0.9849389 0.9909193 0.009080678 1.042893
#&gt; Petal.Length  0.9441083 -0.3039563 0.9837300 0.016270047 1.205101
#&gt; Petal.Width   0.9323563 -0.2568893 0.9352804 0.064719625 1.150960
#&gt; 
#&gt;                             RC1       RC2
#&gt; SS loadings           2.7017350 1.1307933
#&gt; Proportion Var        0.6754338 0.2826983
#&gt; Cumulative Var        0.6754338 0.9581321
#&gt; Proportion Explained  0.7049485 0.2950515
#&gt; Cumulative Proportion 0.7049485 1.0000000
#&gt; 
#&gt; Mean item complexity =  1.1
#&gt; Test of the hypothesis that 2 components are sufficient.
#&gt; 
#&gt; The root mean square of the residuals (RMSR) is  0.030876 
#&gt;  with the empirical chi square  1.715987  with prob &lt;  NA 
#&gt; 
#&gt; Fit based upon off diagonal values = 0.9978717</div><div class='input'><span class='fu'>round</span>(<span class='no'>p</span>$<span class='no'>Vaccounted</span>,<span class='fl'>2</span>)   <span class='co'># the amount of variance accounted for is returned as an object of print</span></div><div class='output co'>#&gt;                        RC1  RC2
#&gt; SS loadings           2.70 1.13
#&gt; Proportion Var        0.68 0.28
#&gt; Cumulative Var        0.68 0.96
#&gt; Proportion Explained  0.70 0.30
#&gt; Cumulative Proportion 0.70 1.00</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#details">Details</a></li>

      <li><a href="#value">Value</a></li>

      <li><a href="#note">Note</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
     William Revelle
  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by William Revelle.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
