<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Graph factor loading matrices — fa.diagram • psych</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>

<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">psych</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Graph factor loading matrices</h1>
    </div>

    
    <p>Factor analysis or principal components analysis results are typically interpreted in terms of the major loadings on each factor.  These structures may be represented as a table of loadings or graphically, where all loadings with an absolute value &gt; some cut point are represented as an edge (path). <code>fa.diagram</code> uses the various <code><a href='diagram.html'>diagram</a></code> functions to draw the diagram. <code>fa.graph</code> generates dot code for external plotting.  <code>fa.rgraph</code> uses the Rgraphviz package (if available) to draw the graph. <code>het.diagram</code> will draw "heterarchy" diagrams of factor/scale solutions at different levels.</p>
    

    <pre class="usage"><span class='fu'>fa.diagram</span>(<span class='no'>fa.results</span>,<span class='kw'>Phi</span><span class='kw'>=</span><span class='kw'>NULL</span>,<span class='kw'>fe.results</span><span class='kw'>=</span><span class='kw'>NULL</span>,<span class='kw'>sort</span><span class='kw'>=</span><span class='fl'>TRUE</span>,<span class='kw'>labels</span><span class='kw'>=</span><span class='kw'>NULL</span>,<span class='kw'>cut</span><span class='kw'>=</span><span class='fl'>.3</span>,
     <span class='kw'>simple</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>errors</span><span class='kw'>=</span><span class='fl'>FALSE</span>,<span class='kw'>g</span><span class='kw'>=</span><span class='fl'>FALSE</span>,<span class='kw'>digits</span><span class='kw'>=</span><span class='fl'>1</span>,<span class='kw'>e.size</span><span class='kw'>=</span><span class='fl'>.05</span>,<span class='kw'>rsize</span><span class='kw'>=</span><span class='fl'>.15</span>,<span class='kw'>side</span><span class='kw'>=</span><span class='fl'>2</span>,
    <span class='no'>main</span>,<span class='kw'>cex</span><span class='kw'>=</span><span class='kw'>NULL</span>,<span class='kw'>marg</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>.5</span>,<span class='fl'>.5</span>,<span class='fl'>1</span>,<span class='fl'>.5</span>),<span class='kw'>adj</span><span class='kw'>=</span><span class='fl'>1</span>, <span class='no'>...</span>)
<span class='fu'>het.diagram</span>(<span class='no'>r</span>,<span class='no'>levels</span>,<span class='kw'>cut</span><span class='kw'>=</span><span class='fl'>.3</span>,<span class='kw'>digits</span><span class='kw'>=</span><span class='fl'>2</span>,<span class='kw'>both</span><span class='kw'>=</span><span class='fl'>TRUE</span>,
        <span class='kw'>main</span><span class='kw'>=</span><span class='st'>"Heterarchy diagram"</span>,<span class='no'>l.cex</span>,<span class='no'>gap.size</span>,<span class='no'>...</span>)
<span class='fu'>fa.graph</span>(<span class='no'>fa.results</span>,<span class='kw'>out.file</span><span class='kw'>=</span><span class='kw'>NULL</span>,<span class='kw'>labels</span><span class='kw'>=</span><span class='kw'>NULL</span>,<span class='kw'>cut</span><span class='kw'>=</span><span class='fl'>.3</span>,<span class='kw'>simple</span><span class='kw'>=</span><span class='fl'>TRUE</span>,
   <span class='kw'>size</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>8</span>,<span class='fl'>6</span>), <span class='kw'>node.font</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='st'>"Helvetica"</span>, <span class='fl'>14</span>),
    <span class='kw'>edge.font</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='st'>"Helvetica"</span>, <span class='fl'>10</span>), <span class='kw'>rank.direction</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='st'>"RL"</span>,<span class='st'>"TB"</span>,<span class='st'>"LR"</span>,<span class='st'>"BT"</span>),
     <span class='kw'>digits</span><span class='kw'>=</span><span class='fl'>1</span>,<span class='kw'>main</span><span class='kw'>=</span><span class='st'>"Factor Analysis"</span>, <span class='no'>...</span>)
<span class='fu'>fa.rgraph</span>(<span class='no'>fa.results</span>,<span class='kw'>out.file</span><span class='kw'>=</span><span class='kw'>NULL</span>,<span class='kw'>labels</span><span class='kw'>=</span><span class='kw'>NULL</span>,<span class='kw'>cut</span><span class='kw'>=</span><span class='fl'>.3</span>,<span class='kw'>simple</span><span class='kw'>=</span><span class='fl'>TRUE</span>,
   <span class='kw'>size</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>8</span>,<span class='fl'>6</span>), <span class='kw'>node.font</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='st'>"Helvetica"</span>, <span class='fl'>14</span>),
    <span class='kw'>edge.font</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='st'>"Helvetica"</span>, <span class='fl'>10</span>), <span class='kw'>rank.direction</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='st'>"RL"</span>,<span class='st'>"TB"</span>,<span class='st'>"LR"</span>,<span class='st'>"BT"</span>),
     <span class='kw'>digits</span><span class='kw'>=</span><span class='fl'>1</span>,<span class='kw'>main</span><span class='kw'>=</span><span class='st'>"Factor Analysis"</span>,<span class='kw'>graphviz</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>fa.results</th>
      <td><p>The output of factor analysis, principal components analysis, or ICLUST analysis.  May also be a factor loading matrix from anywhere.</p></td>
    </tr>
    <tr>
      <th>Phi</th>
      <td><p>Normally not specified (it is is found in the FA, pc, or ICLUST, solution), this may be given if the input is a loadings matrix.</p></td>
    </tr>
    <tr>
      <th>fe.results</th>
      <td><p>the results of a factor extension analysis (if any)</p></td>
    </tr>
    <tr>
      <th>out.file</th>
      <td><p>If it exists, a dot representation of the graph will be stored here (fa.graph)</p></td>
    </tr>
    <tr>
      <th>labels</th>
      <td><p>Variable labels</p></td>
    </tr>
    <tr>
      <th>cut</th>
      <td><p>Loadings with abs(loading) &gt; cut will be shown</p></td>
    </tr>
    <tr>
      <th>simple</th>
      <td><p>Only the biggest loading per item is shown</p></td>
    </tr>
    <tr>
      <th>g</th>
      <td><p>Does the factor matrix reflect a g (first) factor.  If so, then draw this to the left of the variables, with the remaining factors to the right of the variables.  It is useful to turn off the simple parameter in this case.</p></td>
    </tr>
    <tr>
      <th>r</th>
      <td><p>A correlation matrix for the het.diagram function</p></td>
    </tr>
    <tr>
      <th>levels</th>
      <td><p>A list of the elements in each level</p></td>
    </tr>
    <tr>
      <th>both</th>
      <td><p>Should arrows have double heads (in het.diagram)</p></td>
    </tr>
    <tr>
      <th>size</th>
      <td><p>graph size</p></td>
    </tr>
    <tr>
      <th>sort</th>
      <td><p>sort the factor loadings before showing the diagram</p></td>
    </tr>
    <tr>
      <th>errors</th>
      <td><p>include error estimates (as arrows)</p></td>
    </tr>
    <tr>
      <th>e.size</th>
      <td><p>size of ellipses</p></td>
    </tr>
    <tr>
      <th>rsize</th>
      <td><p>size of rectangles</p></td>
    </tr>
    <tr>
      <th>side</th>
      <td><p>on which side should error arrows go?</p></td>
    </tr>
    <tr>
      <th>cex</th>
      <td><p>modify font size</p></td>
    </tr>
    <tr>
      <th>l.cex</th>
      <td><p>modify the font size in arrows, defaults to cex</p></td>
    </tr>
    <tr>
      <th>gap.size</th>
      <td><p>The gap in the arrow for the label.  Can be adjusted to compensate for variations in cex or l.cex</p></td>
    </tr>
    <tr>
      <th>marg</th>
      <td><p>sets the margins to be wider than normal, returns them to the normal size upon exit</p></td>
    </tr>
    <tr>
      <th>adj</th>
      <td><p>how many different positions (1-3) should be used for the numeric labels. Useful if they overlap each other.</p></td>
    </tr>
    <tr>
      <th>node.font</th>
      <td><p>what font should be used for nodes in fa.graph</p></td>
    </tr>
    <tr>
      <th>edge.font</th>
      <td><p>what font should be used for edges in fa.graph</p></td>
    </tr>
    <tr>
      <th>rank.direction</th>
      <td><p>parameter passed to Rgraphviz-- which way to draw the graph</p></td>
    </tr>
    <tr>
      <th>digits</th>
      <td><p>Number of digits to show as an edgelable</p></td>
    </tr>
    <tr>
      <th>main</th>
      <td><p>Graphic title, defaults to "factor analyis" or "factor analysis and extension"</p></td>
    </tr>
    <tr>
      <th>graphviz</th>
      <td><p>Should we try to use Rgraphviz for output?</p></td>
    </tr>
    <tr>
      <th>&#8230;</th>
      <td><p>other parameters</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Path diagram representations have become standard in confirmatory factor analysis, but are not yet common in exploratory factor analysis.  Representing factor structures graphically helps some people understand the structure.</p>
<p>fa.diagram does not use Rgraphviz and is the preferred function.  fa.graph generates dot code to be used by an external graphics program. It does not have all the bells and whistles of fa.diagram, but these may be done in the external editor.</p>
<p>Hierarchical (bifactor) models may be drawn by specifying the g parameter as TRUE.  This allows for an graphical displays of various factor transformations with a bifactor structure (e.g., <code><a href='Promax.html'>bifactor</a></code> and <code><a href='Promax.html'>biquartimin</a></code>.  See <code><a href='omega.html'>omega</a></code> for an alternative way to find these structures.</p>
<p>The <code>het.diagram</code> function will show the case of a hetarchical structure at multiple levels.  It can also be used to show the patterns of correlations between sets of scales (e.g., EPI, NEO, BFI).  The example is for showing the relationship between 3 sets of 4 variables from the Thurstone data set. The parameters l.cex and gap.size are used to adjust the font size of the labels and the gap in the lines.</p>
<p>In fa.rgraph although a nice graph is drawn for the orthogonal factor case, the oblique factor drawing is acceptable, but is better if cleaned up outside of R or done using fa.diagram.</p>
<p>The normal input is taken from the output of either <code><a href='fa.html'>fa</a></code> or <code><a href='ICLUST.html'>ICLUST</a></code>. This latter case displays the ICLUST results in terms of the cluster loadings, not in terms of the cluster structure.  Actually an interesting option.</p>
<p>It is also possible to just give a factor loading matrix as input.  In this case, supplying a Phi matrix of factor correlations is also possible.</p>
<p>It is possible, using fa.graph, to export dot code for an omega solution.  fa.graph should be applied to the schmid$sl object with labels specified as the rownames of schmid$sl.  The results will need editing to make fully compatible with dot language plotting.</p>
<p>To specify the model for a structural equation confirmatory analysis of the results, use <code><a href='structure.diagram.html'>structure.diagram</a></code> instead.</p>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>fa.diagram: A path diagram is drawn without using Rgraphviz.  This is probably the more useful function.</p>
<p>fa.rgraph: A graph is drawn using rgraphviz.  If an output file is specified, the graph instructions are also saved in the dot language.</p>
<p>fa.graph: the graph instructions are saved in the dot language.</p>
    
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>fa.rgraph requires Rgraphviz. Because there are occasional difficulties installing Rgraphviz from Bioconductor in that some libraries are misplaced and need to be relinked, it is probably better to use fa.diagram or fa.graph.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <p><code><a href='omega.graph.html'>omega.graph</a></code>, <code><a href='ICLUST.graph.html'>ICLUST.graph</a></code>, <code><a href='structure.diagram.html'>structure.diagram</a></code> to convert the factor diagram to sem modeling code.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='no'>test.simple</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='fa.html'>fa</a></span>(<span class='fu'><a href='sim.item.html'>item.sim</a></span>(<span class='fl'>16</span>),<span class='fl'>2</span>,<span class='kw'>rotate</span><span class='kw'>=</span><span class='st'>"oblimin"</span>)
<span class='co'>#if(require(Rgraphviz)) {fa.graph(test.simple) } </span>
<span class='fu'>fa.diagram</span>(<span class='no'>test.simple</span>)</div><img src='fa.diagram-2.png' alt='' width='540' height='400' /><div class='input'><span class='no'>f3</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='fa.html'>fa</a></span>(<span class='no'>Thurstone</span>,<span class='fl'>3</span>,<span class='kw'>rotate</span><span class='kw'>=</span><span class='st'>"cluster"</span>)
<span class='fu'>fa.diagram</span>(<span class='no'>f3</span>,<span class='kw'>cut</span><span class='kw'>=</span><span class='fl'>.4</span>,<span class='kw'>digits</span><span class='kw'>=</span><span class='fl'>2</span>)</div><img src='fa.diagram-4.png' alt='' width='540' height='400' /><div class='input'><span class='no'>f3l</span> <span class='kw'>&lt;-</span> <span class='no'>f3</span>$<span class='no'>loadings</span>
<span class='fu'>fa.diagram</span>(<span class='no'>f3l</span>,<span class='kw'>main</span><span class='kw'>=</span><span class='st'>"input from a matrix"</span>)</div><img src='fa.diagram-6.png' alt='' width='540' height='400' /><div class='input'><span class='no'>Phi</span> <span class='kw'>&lt;-</span> <span class='no'>f3</span>$<span class='no'>Phi</span>
<span class='fu'>fa.diagram</span>(<span class='no'>f3l</span>,<span class='kw'>Phi</span><span class='kw'>=</span><span class='no'>Phi</span>,<span class='kw'>main</span><span class='kw'>=</span><span class='st'>"Input from a matrix"</span>)</div><img src='fa.diagram-8.png' alt='' width='540' height='400' /><div class='input'><span class='fu'>fa.diagram</span>(<span class='fu'><a href='ICLUST.html'>ICLUST</a></span>(<span class='no'>Thurstone</span>,<span class='fl'>2</span>,<span class='kw'>title</span><span class='kw'>=</span><span class='st'>"Two cluster solution of Thurstone"</span>),<span class='kw'>main</span><span class='kw'>=</span><span class='st'>"Input from ICLUST"</span>)</div><img src='fa.diagram-10.png' alt='' width='540' height='400' /><img src='fa.diagram-11.png' alt='' width='540' height='400' /><div class='input'><span class='fu'>het.diagram</span>(<span class='no'>Thurstone</span>,<span class='kw'>levels</span><span class='kw'>=</span><span class='fu'>list</span>(<span class='fl'>1</span>:<span class='fl'>4</span>,<span class='fl'>5</span>:<span class='fl'>8</span>,<span class='fl'>3</span>:<span class='fl'>7</span>))</div><img src='fa.diagram-13.png' alt='' width='540' height='400' /></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#details">Details</a></li>

      <li><a href="#value">Value</a></li>

      <li><a href="#note">Note</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    William Revelle 
  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by William Revelle.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
