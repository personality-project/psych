<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Item Response Analysis by Exploratory Factor Analysis of tetrachoric/polychoric correlations — irt.fa • psych</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>

<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">psych</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Item Response Analysis by Exploratory Factor Analysis of tetrachoric/polychoric correlations</h1>
    </div>

    
    <p>Although exploratory factor analysis and Item Response Theory seem to be very different models of binary data, they can provide equivalent parameter estimates of item difficulty and item discrimination.  Tetrachoric or polychoric correlations of a data set of dichotomous or polytomous items may be factor analysed using a minimum residual or maximum likelihood factor analysis and the result loadings transformed to item discrimination parameters.  The tau parameter from the tetrachoric/polychoric correlations combined with the item factor loading may be used to estimate item difficulties.</p>
    

    <pre class="usage"><span class='fu'>irt.fa</span>(<span class='no'>x</span>,<span class='kw'>nfactors</span><span class='kw'>=</span><span class='fl'>1</span>,<span class='kw'>correct</span><span class='kw'>=</span><span class='fl'>TRUE</span>,<span class='kw'>plot</span><span class='kw'>=</span><span class='fl'>TRUE</span>,<span class='kw'>n.obs</span><span class='kw'>=</span><span class='kw'>NULL</span>,<span class='kw'>rotate</span><span class='kw'>=</span><span class='st'>"oblimin"</span>,<span class='kw'>fm</span><span class='kw'>=</span><span class='st'>"minres"</span>,
        <span class='kw'>sort</span><span class='kw'>=</span><span class='fl'>FALSE</span>,<span class='no'>...</span>)
<span class='fu'>irt.select</span>(<span class='no'>x</span>,<span class='no'>y</span>)
<span class='fu'>fa2irt</span>(<span class='no'>f</span>,<span class='no'>rho</span>,<span class='kw'>plot</span><span class='kw'>=</span><span class='fl'>TRUE</span>,<span class='kw'>n.obs</span><span class='kw'>=</span><span class='kw'>NULL</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>A data matrix of dichotomous or discrete items, or the result of <code><a href='tetrachor.html'>tetrachoric</a></code> or <code><a href='tetrachor.html'>polychoric</a></code></p></td>
    </tr>
    <tr>
      <th>nfactors</th>
      <td><p>Defaults to 1 factor</p></td>
    </tr>
    <tr>
      <th>correct</th>
      <td><p>If true, then correct the tetrachoric correlations for continuity.  (See <code><a href='tetrachor.html'>tetrachoric</a></code>).</p></td>
    </tr>
    <tr>
      <th>plot</th>
      <td><p>If TRUE, automatically call the <code><a href='plot.psych.html'>plot.irt</a></code> or <code><a href='plot.psych.html'>plot.poly</a></code> functions.</p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>the subset of variables to pick from the rho and tau output of a previous irt.fa analysis to allow for further analysis.</p></td>
    </tr>
    <tr>
      <th>n.obs</th>
      <td><p>The number of subjects used in the initial analysis if doing a second analysis of a correlation matrix.  In particular, if using the fm="minchi" option, this should be the matrix returned by <code><a href='count.pairwise.html'>count.pairwise</a></code>.</p></td>
    </tr>
    <tr>
      <th>rotate</th>
      <td><p>The default rotation is oblimin.  See <code><a href='fa.html'>fa</a></code> for the other options.</p></td>
    </tr>
    <tr>
      <th>fm</th>
      <td><p>The default factor extraction is minres.  See <code><a href='fa.html'>fa</a></code> for the other options.</p></td>
    </tr>
    <tr>
      <th>f</th>
      <td><p>The object returned from <code><a href='fa.html'>fa</a></code></p></td>
    </tr>
    <tr>
      <th>rho</th>
      <td><p>The object returned from <code><a href='tetrachor.html'>polychoric</a></code> or <code><a href='tetrachor.html'>tetrachoric</a></code>.  This will include both a correlation matrix and the item difficulty levels.</p></td>
    </tr>
    <tr>
      <th>sort</th>
      <td><p>Should the factor loadings be sorted before preparing the item information tables.  Defaults to FALSE as this is more useful for scoring items. For tabular output it is better to have sort=TRUE.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional parameters to pass to the factor analysis function</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><code>irt.fa</code> combines several functions into one to make the process of item response analysis easier.  Correlations are found using either <code><a href='tetrachor.html'>tetrachoric</a></code> or <code><a href='tetrachor.html'>polychoric</a></code>.  Exploratory factor analyeses with all the normal options are then done using <code><a href='fa.html'>fa</a></code>.  The results are then organized to be reported in terms of IRT parameters (difficulties and discriminations) as well as the more conventional factor analysis output. In addition, because the correlation step is somewhat slow, reanalyses may be done using the correlation matrix found in the first step.  In this case, if it is desired to use the fm="minchi" factoring method, the number of observations needs to be specified as the matrix resulting from <code><a href='count.pairwise.html'>count.pairwise</a></code>.</p>
    <p>The tetrachoric correlation matrix of dichotomous items may be factored using a (e.g.) minimum residual factor analysis function <code><a href='fa.html'>fa</a></code> and the resulting loadings, \(\lambda_i\) are transformed to discriminations by
\(\alpha = \frac{\lambda_i}{\sqrt{1-\lambda_i^2}} \).</p>
<p>The difficulty parameter, \(\delta\) is found from the \(\tau\) parameter of the <code><a href='tetrachor.html'>tetrachoric</a></code> or <code><a href='tetrachor.html'>polychoric</a></code> function.
    \(\delta_i = \frac{\tau_i}{\sqrt{1-\lambda_i^2}}\)</p>
<p>Similar analyses may be done with discrete item responses using polychoric correlations and distinct estimates of item difficulty (location)  for each item response.</p>
<p>The results may be shown graphically using <code>link{plot.irt}</code> for dichotomous items or  <code>link{plot.poly}</code> for polytomous items.  These called by plotting the irt.fa output, see the examples).   For plotting there are three options: type = "ICC" will plot the item characteristic response function.  type = "IIC" will plot the item information function, and type= "test" will plot the test information function.  Invisible output from the plot function will return tables of item information as a function of several levels of the trait, as well as the standard error of measurement and the reliability at each of those levels.</p>
<p>The normal input is just the raw data.  If, however, the correlation matrix has already been found using <code><a href='tetrachor.html'>tetrachoric</a></code>, <code><a href='tetrachor.html'>polychoric</a></code>, or a previous analysis using <code>irt.fa</code> then that result can be processed directly.  Because  <code>irt.fa</code> saves the rho and tau matrices from the analysis, subsequent analyses of the same data set are much faster if the input is the object returned on the first run.  A similar feature is available in <code><a href='omega.html'>omega</a></code>.</p>
<p>The output is best seen in terms of graphic displays.  Plot the output from irt.fa to see item and test information functions.</p>
<p>The print function will print the item location and discriminations.  The additional factor analysis output is available as an object in the output and may be printed directly by specifying the $fa object.</p>
<p>The <code>irt.select</code> function is a helper function to allow for selecting a subset of a prior analysis for further analysis. First run irt.fa, then select a subset of variables to be analyzed in a subsequent irt.fa analysis.  Perhaps a better approach is to just plot and find the information for selected items.</p>
<p>The plot function for an irt.fa object will plot ICC (item characteristic curves), IIC (item information curves), or test information curves. In addition, by using the "keys" option,  these three kinds of plots can be done for selected items. This is particularly useful when trying to see the information characteristics of short forms of tests based upon the longer form factor analysis.</p>
<p>The plot function will also return (invisibly) the informaton at multiple levels of the trait, the average information (area under the curve) as well as the location of the peak information for each item.  These may be then printed or printed in sorted order using the sort option in print.</p>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    

<dt>irt </dt><dd><p>A list of Item location (difficulty) and discrimination</p></dd>
<dt>fa </dt><dd><p>A list of statistics for the factor analyis</p></dd>
<dt>rho</dt><dd><p>The tetrachoric/polychoric correlation matrix</p></dd>
<dt>tau</dt><dd><p>The tetrachoric/polychoric cut points</p></dd>


    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Kamata, Akihito and Bauer, Daniel J. (2008) A Note on the Relation Between Factor Analytic and Item Response Theory Models
Structural Equation Modeling, 15 (1) 136-153.
    McDonald, Roderick P. (1999) Test theory: A unified treatment. L. Erlbaum Associates.</p>
<p>Revelle, William. (in prep) An introduction to psychometric theory with applications in R. Springer.  Working draft available at <a href = 'http://personality-project.org/r/book/'>http://personality-project.org/r/book/</a></p>
    
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    
    <p>In comparing irt.fa to the ltm function in the ltm package or to the analysis reported in Kamata and Bauer (2008) the discrimination parameters are not identical, because the irt.fa reports them in units of the normal curve while ltm and Kamata and Bauer report them in logistic units.  In addition, Kamata and Bauer do their factor analysis using a logistic error model.  Their results match the irt.fa results (to the 2nd or 3rd decimal) when examining their analyses using a normal model.  (With thanks to Akihito Kamata for sharing that analysis.)
    <code>irt.fa</code> reports parameters in normal units.  To convert them to conventional IRT parameters, multiply by 1.702.  In addition, the location parameter is expressed in terms of difficulty (high positive scores imply lower frequency of response.)</p>
<p>The results of <code>irt.fa</code>  can be used by <code><a href='score.irt.html'>score.irt</a></code> for irt based scoring.  First run <code>irt.fa</code> and then score the results using a two parameter model using <code><a href='score.irt.html'>score.irt</a></code>.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <p><code><a href='fa.html'>fa</a></code>, <code><a href='sim.html'>sim.irt</a></code>, <code><a href='tetrachor.html'>tetrachoric</a></code>, <code><a href='tetrachor.html'>polychoric</a></code> as well as <code><a href='plot.psych.html'>plot.psych</a></code> for plotting the IRT item curves.</p>
<p>See also <code><a href='score.irt.html'>score.irt</a></code> for scoring items based upon these parameter estimates. <code><a href='irt.responses.html'>irt.responses</a></code>  will plot the empirical response curves for the alternative response choices for multiple choice items.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'>not_run</span>({
  <span class='fu'>set.seed</span>(<span class='fl'>17</span>)
  <span class='no'>d9</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='sim.html'>sim.irt</a></span>(<span class='fl'>9</span>,<span class='fl'>1000</span>,-<span class='fl'>2.5</span>,<span class='fl'>2.5</span>,<span class='kw'>mod</span><span class='kw'>=</span><span class='st'>"normal"</span>) <span class='co'>#dichotomous items</span>
  <span class='no'>test</span> <span class='kw'>&lt;-</span> <span class='fu'>irt.fa</span>(<span class='no'>d9</span>$<span class='no'>items</span>)
  <span class='no'>test</span>
  <span class='no'>op</span> <span class='kw'>&lt;-</span> <span class='fu'>par</span>(<span class='kw'>mfrow</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>3</span>,<span class='fl'>1</span>))
  <span class='fu'>plot</span>(<span class='no'>test</span>,<span class='kw'>type</span><span class='kw'>=</span><span class='st'>"ICC"</span>)
  <span class='fu'>plot</span>(<span class='no'>test</span>,<span class='kw'>type</span><span class='kw'>=</span><span class='st'>"IIC"</span>)
  <span class='fu'>plot</span>(<span class='no'>test</span>,<span class='kw'>type</span><span class='kw'>=</span><span class='st'>"test"</span>)
  <span class='fu'>par</span>(<span class='no'>op</span>)
  <span class='fu'>set.seed</span>(<span class='fl'>17</span>)
  <span class='no'>items</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='sim.congeneric.html'>sim.congeneric</a></span>(<span class='kw'>N</span><span class='kw'>=</span><span class='fl'>500</span>,<span class='kw'>short</span><span class='kw'>=</span><span class='fl'>FALSE</span>,<span class='kw'>categorical</span><span class='kw'>=</span><span class='fl'>TRUE</span>) <span class='co'>#500 responses to 4 discrete items</span>
  <span class='no'>d4</span> <span class='kw'>&lt;-</span> <span class='fu'>irt.fa</span>(<span class='no'>items</span>$<span class='no'>observed</span>)  <span class='co'>#item response analysis of congeneric measures</span>
  <span class='no'>d4</span>    <span class='co'>#show just the irt output</span>
  <span class='no'>d4</span>$<span class='no'>fa</span>  <span class='co'>#show just the factor analysis output</span>


  <span class='no'>op</span> <span class='kw'>&lt;-</span> <span class='fu'>par</span>(<span class='kw'>mfrow</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>2</span>,<span class='fl'>2</span>))
  <span class='fu'>plot</span>(<span class='no'>d4</span>,<span class='kw'>type</span><span class='kw'>=</span><span class='st'>"ICC"</span>)
  <span class='fu'>par</span>(<span class='no'>op</span>)


  <span class='co'>#using the iq data set for an example of real items</span>
  <span class='co'>#first need to convert the responses to tf</span>
  <span class='fu'>data</span>(<span class='no'>iqitems</span>)
  <span class='no'>iq.keys</span> <span class='kw'>&lt;-</span> <span class='fu'>c</span>(<span class='fl'>4</span>,<span class='fl'>4</span>,<span class='fl'>4</span>, <span class='fl'>6</span>, <span class='fl'>6</span>,<span class='fl'>3</span>,<span class='fl'>4</span>,<span class='fl'>4</span>,  <span class='fl'>5</span>,<span class='fl'>2</span>,<span class='fl'>2</span>,<span class='fl'>4</span>,  <span class='fl'>3</span>,<span class='fl'>2</span>,<span class='fl'>6</span>,<span class='fl'>7</span>)

  <span class='no'>iq.tf</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='score.multiple.choice.html'>score.multiple.choice</a></span>(<span class='no'>iq.keys</span>,<span class='no'>iqitems</span>,<span class='kw'>score</span><span class='kw'>=</span><span class='fl'>FALSE</span>)  <span class='co'>#just the responses</span>
  <span class='no'>iq.irt</span> <span class='kw'>&lt;-</span> <span class='fu'>irt.fa</span>(<span class='no'>iq.tf</span>)
  <span class='fu'>print</span>(<span class='no'>iq.irt</span>,<span class='kw'>short</span><span class='kw'>=</span><span class='fl'>FALSE</span>) <span class='co'>#show the IRT as well as factor analysis output</span>
  <span class='no'>p.iq</span> <span class='kw'>&lt;-</span> <span class='fu'>plot</span>(<span class='no'>iq.irt</span>)  <span class='co'>#save the invisible summary table</span>
  <span class='no'>p.iq</span>  <span class='co'>#show the summary table of information by ability level</span>
  <span class='co'>#select a subset of these variables</span>
  <span class='no'>small.iq.irt</span> <span class='kw'>&lt;-</span> <span class='fu'>irt.select</span>(<span class='no'>iq.irt</span>,<span class='fu'>c</span>(<span class='fl'>1</span>,<span class='fl'>5</span>,<span class='fl'>9</span>,<span class='fl'>10</span>,<span class='fl'>11</span>,<span class='fl'>13</span>))
  <span class='no'>small.irt</span> <span class='kw'>&lt;-</span> <span class='fu'>irt.fa</span>(<span class='no'>small.iq.irt</span>)
  <span class='fu'>plot</span>(<span class='no'>small.irt</span>)
  <span class='co'>#find the information for three subset of iq items</span>
  <span class='no'>keys</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='make.keys.html'>make.keys</a></span>(<span class='fl'>16</span>,<span class='fu'>list</span>(<span class='kw'>all</span><span class='kw'>=</span><span class='fl'>1</span>:<span class='fl'>16</span>,<span class='kw'>some</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>1</span>,<span class='fl'>5</span>,<span class='fl'>9</span>,<span class='fl'>10</span>,<span class='fl'>11</span>,<span class='fl'>13</span>),<span class='kw'>others</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>1</span>:<span class='fl'>5</span>)))
  <span class='fu'>plot</span>(<span class='no'>iq.irt</span>,<span class='kw'>keys</span><span class='kw'>=</span><span class='no'>keys</span>)
})
<span class='co'>#compare output to the ltm package or Kamata and Bauer   -- these are in logistic units </span>
<span class='no'>ls</span> <span class='kw'>&lt;-</span> <span class='fu'>irt.fa</span>(<span class='no'>lsat6</span>)</div><div class='output co'>#&gt; </div><img src='irt.fa-3.png' alt='' width='540' height='400' /><div class='input'><span class='co'>#library(ltm)</span>
<span class='co'># lsat.ltm &lt;- ltm(lsat6~z1)</span>
<span class='co'>#  round(coefficients(lsat.ltm)/1.702,3)  #convert to normal (approximation)</span>
<span class='co'>#</span>
<span class='co'>#   Dffclt Dscrmn</span>
<span class='co'>#Q1 -1.974  0.485</span>
<span class='co'>#Q2 -0.805  0.425</span>
<span class='co'>#Q3 -0.164  0.523</span>
<span class='co'>#Q4 -1.096  0.405</span>
<span class='co'>#Q5 -1.835  0.386</span>


<span class='co'>#Normal results  ("Standardized and Marginal")(from Akihito Kamata )       </span>
<span class='co'>#Item       discrim             tau </span>
<span class='co'>#  1       0.4169             -1.5520   </span>
<span class='co'>#  2       0.4333             -0.5999 </span>
<span class='co'>#  3       0.5373             -0.1512 </span>
<span class='co'>#  4       0.4044             -0.7723  </span>
<span class='co'>#  5       0.3587             -1.1966</span>
<span class='co'>#compare to ls </span>

  <span class='co'>#Normal results  ("Standardized and conditional") (from Akihito Kamata )   </span>
<span class='co'>#item            discrim   tau</span>
<span class='co'>#  1           0.3848    -1.4325  </span>
<span class='co'>#  2           0.3976    -0.5505 </span>
<span class='co'>#  3           0.4733    -0.1332 </span>
<span class='co'>#  4           0.3749    -0.7159 </span>
<span class='co'>#  5           0.3377    -1.1264 </span>
<span class='co'>#compare to ls$fa and ls$tau </span>

<span class='co'>#Kamata and Bauer (2008) logistic estimates</span>
<span class='co'>#1   0.826    2.773</span>
<span class='co'>#2   0.723    0.990</span>
<span class='co'>#3   0.891    0.249  </span>
<span class='co'>#4   0.688    1.285</span>
<span class='co'>#5   0.657    2.053</span></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#details">Details</a></li>

      <li><a href="#value">Value</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#note">Note</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    William Revelle
  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by William Revelle.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
