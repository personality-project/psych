<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Find a Full Information Maximum Likelihood (FIML) correlation or covariance matrix from a data matrix with missing data — corFiml • psych</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>

<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">psych</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Find a Full Information Maximum Likelihood (FIML) correlation or covariance matrix from a data matrix with missing data</h1>
    </div>

    
    <p>Makes use of functions adapted from the lavaan package to find FIML covariance/correlation matrices.  FIML can be much slower than the normal pairwise deletion option of cor, but provides slightly more precise estimates.</p>
    

    <pre class="usage"><span class='fu'>corFiml</span>(<span class='no'>x</span>, <span class='kw'>covar</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,<span class='kw'>show</span><span class='kw'>=</span><span class='fl'>FALSE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>A data.frame or data matrix</p></td>
    </tr>
    <tr>
      <th>covar</th>
      <td><p>By default, just return the correlation matrix.  If covar is TRUE, return a list containing the covariance matrix and the ML fit function.</p></td>
    </tr>
    <tr>
      <th>show</th>
      <td><p>If show=TRUE, then just show the patterns of missingness, but don't do the FIML.  Useful for understanding the process of fiml.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>In the presence of missing data, Full Information Maximum Likelihood (FIML) is an alternative to simply using the pairwise correlations. The implementation in the lavaan package for structural equation modeling has been adapted for the simpler case of just finding the correlations or covariances.</p>
<p>The pairwise solution for any pair of variables is insensitive to other variables included in the matrix.  On the other hand, the ML solution depends upon the entire set of items being correlated.  This will lead to slightly different solutions for different subsets of variables.</p>
<p>The basic FIML algorithm is to find the pairwise ML solution for covariances and means for every pattern of missingness and then to weight the solution by the size of every unique pattern of missingness.</p>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    

<dt>cor</dt><dd><p>The correlation matrix found using FIML</p></dd>
<dt>cov</dt><dd><p>The covariance matrix found using FIML</p></dd>
<dt>fx</dt><dd><p>The ML fit function</p></dd>

    
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>The functions used in lavaan are not exported and so have been copied (and simplified) to the psych package.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <p>To use the resulting correlations, see <code><a href='fa.html'>fa</a></code>.  To see the pairwise pattern of missingness, see <code><a href='count.pairwise.html'>count.pairwise</a></code>.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='no'>rML</span> <span class='kw'>&lt;-</span> <span class='fu'>corFiml</span>(<span class='no'>bfi</span>[<span class='fl'>20</span>:<span class='fl'>27</span>])
<span class='no'>rpw</span> <span class='kw'>&lt;-</span> <span class='fu'>cor</span>(<span class='no'>bfi</span>[<span class='fl'>20</span>:<span class='fl'>27</span>],<span class='kw'>use</span><span class='kw'>=</span><span class='st'>"pairwise"</span>)
<span class='fu'>round</span>(<span class='no'>rML</span> - <span class='no'>rpw</span>,<span class='fl'>3</span>)</div><div class='output co'>#&gt;               N5     O1     O2     O3     O4     O5 gender education
#&gt; N5         0.000  0.000 -0.001 -0.001  0.000 -0.001 -0.002     0.001
#&gt; O1         0.000  0.000  0.001  0.000 -0.001  0.001  0.000     0.001
#&gt; O2        -0.001  0.001  0.000  0.001  0.000 -0.002  0.000     0.001
#&gt; O3        -0.001  0.000  0.001  0.000 -0.001  0.000 -0.002     0.001
#&gt; O4         0.000 -0.001  0.000 -0.001  0.000  0.000  0.000     0.001
#&gt; O5        -0.001  0.001 -0.002  0.000  0.000  0.000  0.000     0.001
#&gt; gender    -0.002  0.000  0.000 -0.002  0.000  0.000  0.000     0.001
#&gt; education  0.001  0.001  0.001  0.001  0.001  0.001  0.001     0.000</div><div class='input'><span class='no'>mp</span> <span class='kw'>&lt;-</span> <span class='fu'>corFiml</span>(<span class='no'>bfi</span>[<span class='fl'>20</span>:<span class='fl'>27</span>],<span class='kw'>show</span><span class='kw'>=</span><span class='fl'>TRUE</span>)
<span class='no'>mp</span></div><div class='output co'>#&gt;         N5    O1   O2    O3    O4    O5 gender education
#&gt; 2489  TRUE  TRUE TRUE  TRUE  TRUE  TRUE   TRUE      TRUE
#&gt; 214   TRUE  TRUE TRUE  TRUE  TRUE  TRUE   TRUE     FALSE
#&gt; 22   FALSE  TRUE TRUE  TRUE  TRUE  TRUE   TRUE      TRUE
#&gt; 19    TRUE  TRUE TRUE FALSE  TRUE  TRUE   TRUE      TRUE
#&gt; 18    TRUE FALSE TRUE  TRUE  TRUE  TRUE   TRUE      TRUE
#&gt; 13    TRUE  TRUE TRUE  TRUE  TRUE FALSE   TRUE      TRUE
#&gt; 13    TRUE  TRUE TRUE  TRUE FALSE  TRUE   TRUE      TRUE
#&gt; 3     TRUE  TRUE TRUE FALSE  TRUE  TRUE   TRUE     FALSE
#&gt; 2    FALSE FALSE TRUE FALSE  TRUE FALSE   TRUE      TRUE
#&gt; 2    FALSE FALSE TRUE FALSE  TRUE FALSE   TRUE     FALSE
#&gt; 1     TRUE  TRUE TRUE  TRUE  TRUE FALSE   TRUE     FALSE
#&gt; 1     TRUE  TRUE TRUE  TRUE FALSE  TRUE   TRUE     FALSE
#&gt; 1    FALSE  TRUE TRUE  TRUE  TRUE  TRUE   TRUE     FALSE
#&gt; 1    FALSE  TRUE TRUE FALSE  TRUE FALSE   TRUE      TRUE
#&gt; 1    FALSE  TRUE TRUE FALSE  TRUE FALSE   TRUE     FALSE</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#details">Details</a></li>

      <li><a href="#value">Value</a></li>

      <li><a href="#note">Note</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    Wiliam Revelle
  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by William Revelle.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
