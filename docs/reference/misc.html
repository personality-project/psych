<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Miscellaneous helper functions for the psych package — psych.misc • psych</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>

<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">psych</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Miscellaneous helper functions for the psych package</h1>
    </div>

    
    <p>This is a set of minor, if not trivial, helper functions.
lowerCor finds the correlation of x variables and then prints them using 
lowerMat which is a trivial, but useful, function to round off and print the lower triangle of a matrix.
reflect reflects the output of a factor analysis or principal components analysis so that one or more factors is reflected. (Requested by Alexander Weiss.)
progressBar prints out ...  as a calling routine (e.g., <code><a href='tetrachor.html'>tetrachoric</a></code>) works through a tedious calculation.  shannon finds the Shannon index (H) of diversity or of information. test.all tests all the examples in a package.  best.items sorts a factor matrix for absolute values and displays the expanded items names. fa.lookup returns sorted factor analysis output with item labels. <code>cor2</code> correlates two data.frames (of equal length). levels2numeric and char2numeric convert dataframe columns that are categorical/levels to numeric values.</p>
    

    <pre class="usage"><span class='fu'>psych.misc</span>()
<span class='fu'>lowerCor</span>(<span class='no'>x</span>,<span class='kw'>digits</span><span class='kw'>=</span><span class='fl'>2</span>,<span class='kw'>use</span><span class='kw'>=</span><span class='st'>"pairwise"</span>,<span class='kw'>method</span><span class='kw'>=</span><span class='st'>"pearson"</span>)
<span class='fu'>cor2</span>(<span class='no'>x</span>,<span class='no'>y</span>,<span class='kw'>digits</span><span class='kw'>=</span><span class='fl'>2</span>,<span class='kw'>use</span><span class='kw'>=</span><span class='st'>"pairwise"</span>,<span class='kw'>method</span><span class='kw'>=</span><span class='st'>"pearson"</span>)
<span class='fu'>lowerMat</span>(<span class='no'>R</span>, <span class='kw'>digits</span> <span class='kw'>=</span> <span class='fl'>2</span>)
<span class='fu'>tableF</span>(<span class='no'>x</span>,<span class='no'>y</span>)
<span class='fu'>reflect</span>(<span class='no'>f</span>,<span class='kw'>flip</span><span class='kw'>=</span><span class='kw'>NULL</span>)
<span class='fu'>progressBar</span>(<span class='no'>value</span>,<span class='no'>max</span>,<span class='kw'>label</span><span class='kw'>=</span><span class='kw'>NULL</span>)
<span class='fu'>shannon</span>(<span class='no'>x</span>,<span class='kw'>correct</span><span class='kw'>=</span><span class='fl'>FALSE</span>,<span class='kw'>base</span><span class='kw'>=</span><span class='fl'>2</span>)
<span class='fu'>test.all</span>(<span class='no'>pl</span>,<span class='kw'>package</span><span class='kw'>=</span><span class='st'>"psych"</span>,<span class='kw'>dependencies</span>
      <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"Depends"</span>, <span class='st'>"Imports"</span>, <span class='st'>"LinkingTo"</span>),<span class='kw'>find</span><span class='kw'>=</span><span class='fl'>FALSE</span>,<span class='kw'>skip</span><span class='kw'>=</span><span class='kw'>NULL</span>)
 <span class='fu'>levels2numeric</span>(<span class='no'>x</span>)
 <span class='fu'>char2numeric</span>(<span class='no'>x</span>)
 <span class='fu'>isCorrelation</span>(<span class='no'>x</span>) <span class='co'>#test if an object is a symmetric matrix</span></pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>R</th>
      <td><p>A rectangular matrix or data frame (probably a correlation matrix)</p></td>
    </tr>
    <tr>
      <th>x</th>
      <td><p>A data matrix or data frame or a vector depending upon the function.</p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>A data matrix or data frame or a vector</p></td>
    </tr>
    <tr>
      <th>f</th>
      <td><p>The object returned from either a factor analysis (fa) or a principal components analysis (principal)</p></td>
    </tr>
    <tr>
      <th>digits</th>
      <td><p>round to digits</p></td>
    </tr>
    <tr>
      <th>use</th>
      <td><p>Should pairwise deletion be done, or one of the other options to cor</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>"pearson", "kendall", "spearman"</p></td>
    </tr>
    <tr>
      <th>value</th>
      <td><p>the current value of some looping variable</p></td>
    </tr>
    <tr>
      <th>max</th>
      <td><p>The maximum value the loop will achieve</p></td>
    </tr>
    <tr>
      <th>label</th>
      <td><p>what function is looping</p></td>
    </tr>
    <tr>
      <th>flip</th>
      <td><p>The factor or components to be reversed keyed (by factor number)</p></td>
    </tr>
    <tr>
      <th>correct</th>
      <td><p>Correct for the maximum possible information in this item</p></td>
    </tr>
    <tr>
      <th>base</th>
      <td><p>What is the base for the log function (default=2, e implies base = exp(1))</p></td>
    </tr>
    <tr>
      <th>pl</th>
      <td><p>The name of a package (or list of packages) to be activated and then have all the examples tested.</p></td>
    </tr>
    <tr>
      <th>package</th>
      <td><p>Find the dependencies for this package, e.g., psych</p></td>
    </tr>
    <tr>
      <th>dependencies</th>
      <td><p>Which type of dependency to examine?</p></td>
    </tr>
    <tr>
      <th>find</th>
      <td><p>Look up the dependencies, and then test all of their examples</p></td>
    </tr>
    <tr>
      <th>skip</th>
      <td><p>Do not test these dependencies</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>tableF</code> is fast alternative to the table function for creating two way tables of numeric variables.  It does not have any of the elegant checks of the table function and thus is much faster.  Used in the <code><a href='tetrachor.html'>tetrachoric</a></code> and <code><a href='tetrachor.html'>polychoric</a></code> functions to maximize speed.

<code>lowerCor</code> Finds and prints (using <code>lowerMat</code>) the lower diagonal correlation matrix but returns (invisibly) the full correlation matrix found with the use and method parameters. The default values are for pairwise deletion of variables, and to print to 2 decimal places. 

<code>lowerMat</code>Shows the lower triangle of a matrix, rounded to digits with titles abbreviated to digits + 3

<code>progressBar</code> Display a series of dots as we progress through a slow loop (removed from anything  using multicores). 

<code>tableF</code> (for tableFast) is a cut down version of table that does no error checking, nor returns pretty output, but is significantly faster than table.  It will just work on two integer vectors.  This is used in polychoric an tetrachoric for about a 50% speed improvement for large problems.  

<code>shannon</code> finds Shannon's H index of information.  Used for estimating the complexity or diversity of the distribution of responses in a vector or matrix. $$H = -\sum{p_i log(p_i) }$$

<code>test.all</code> allows one to test all the examples in specified package.  This allows us to make sure that those examples work when other packages (e.g., psych) are also loaded.  This is used when developing revisions to the psych package to make sure the the other packages work.  Some packages will not work and/or crash the system (e.g., DeducerPlugInScaling requires Java and even with Java, crashes when loaded, even if psych is not there!).  Alternatively, if testing a long list of dependencies, you can skip the first part by specifying them by name.

<code>cor2</code> will find and display the correlations between two sets of variables, rounded to digits, using the other options. If x is a list of multiple sets (two or more), then all sets are correlated.  

<code>levels2numeric</code>converts character data with levels to numeric data.  Used in the SAPA analyses where we code some variables, (e.g., gender, education) with character codes to help in the documentation of files, but want to do analyses of correlations with other categorical variables. 

<code>char2numeric</code>converts character data with levels to numeric data.  Used for cases when data from questionnaires include the response categories rathere than numeric data.  Unless the levels of the data are in meaningful order, the numeric results are not useful.  Most useful if doing polychoric analyses.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><code>lowerCor</code> prints out the lower off diagonal matrix rounded to digits with column names abbreviated to digits + 3 characters, but also returns the full and unrounded matrix.  By default, it uses pairwise deletion of variables.  It in turn calls
    <code>lowerMat</code> which does the pretty printing.</p>
<p>It is important to remember to not call <code>lowerCor</code> when all you need is <code>lowerMat</code>!</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <p><code><a href='corr.test.html'>corr.test</a></code> to find correlations, count the pairwise occurrences, and to give significance tests for each correlation.  <code><a href='r.test.html'>r.test</a></code> for a number of tests of correlations, including tests of the difference between correlations.  <code><a href='lowerUpper.html'>lowerUpper</a></code> will display the differences between two matrices.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'>lowerMat</span>(<span class='no'>Thurstone</span>)</div><div class='output co'>#&gt;                   Sntnc Vcblr Snt.C Frs.L F.L.W Sffxs Ltt.S Pdgrs Ltt.G
#&gt; Sentences         1.00                                                 
#&gt; Vocabulary        0.83  1.00                                           
#&gt; Sent.Completion   0.78  0.78  1.00                                     
#&gt; First.Letters     0.44  0.49  0.46  1.00                               
#&gt; Four.Letter.Words 0.43  0.46  0.42  0.67  1.00                         
#&gt; Suffixes          0.45  0.49  0.44  0.59  0.54  1.00                   
#&gt; Letter.Series     0.45  0.43  0.40  0.38  0.40  0.29  1.00             
#&gt; Pedigrees         0.54  0.54  0.53  0.35  0.37  0.32  0.56  1.00       
#&gt; Letter.Group      0.38  0.36  0.36  0.42  0.45  0.32  0.60  0.45  1.00 </div><div class='input'><span class='no'>lb</span> <span class='kw'>&lt;-</span> <span class='fu'>lowerCor</span>(<span class='no'>bfi</span>[<span class='fl'>1</span>:<span class='fl'>10</span>])  <span class='co'>#finds and prints the lower correlation matrix, </span></div><div class='output co'>#&gt;    A1    A2    A3    A4    A5    C1    C2    C3    C4    C5   
#&gt; A1  1.00                                                      
#&gt; A2 -0.34  1.00                                                
#&gt; A3 -0.27  0.49  1.00                                          
#&gt; A4 -0.15  0.34  0.36  1.00                                    
#&gt; A5 -0.18  0.39  0.50  0.31  1.00                              
#&gt; C1  0.03  0.09  0.10  0.09  0.12  1.00                        
#&gt; C2  0.02  0.14  0.14  0.23  0.11  0.43  1.00                  
#&gt; C3 -0.02  0.19  0.13  0.13  0.13  0.31  0.36  1.00            
#&gt; C4  0.13 -0.15 -0.12 -0.15 -0.13 -0.34 -0.38 -0.34  1.00      
#&gt; C5  0.05 -0.12 -0.16 -0.24 -0.17 -0.25 -0.30 -0.34  0.48  1.00</div><div class='input'>  <span class='co'># returns the square matrix.</span>
<span class='co'>#fiml &lt;- corFiml(bfi[1:10])     #FIML correlations require lavaan package</span>
<span class='co'>#lowerMat(fiml)  #to get pretty output</span>
<span class='no'>f3</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='fa.html'>fa</a></span>(<span class='no'>Thurstone</span>,<span class='fl'>3</span>)
<span class='no'>f3r</span> <span class='kw'>&lt;-</span> <span class='fu'>reflect</span>(<span class='no'>f3</span>,<span class='fl'>2</span>)  <span class='co'>#reflect the second factor</span>
<span class='co'>#find the complexity of the response patterns of the iqitems.</span>
<span class='fu'>round</span>(<span class='fu'>shannon</span>(<span class='no'>iqitems</span>),<span class='fl'>2</span>)</div><div class='output co'>#&gt;  reason.4 reason.16 reason.17 reason.19  letter.7 letter.33 letter.34 letter.58 
#&gt;      1.78      1.52      1.62      1.86      1.88      2.01      1.89      2.29 
#&gt; matrix.45 matrix.46 matrix.47 matrix.55  rotate.3  rotate.4  rotate.6  rotate.8 
#&gt;      2.03      2.10      1.92      2.40      2.89      2.76      2.72      2.93 </div><div class='input'><span class='co'>#test.all('BinNor')  #Does the BinNor package work when we are using other packages</span>
<span class='fu'><a href='best.scales.html'>bestItems</a></span>(<span class='no'>lb</span>,<span class='fl'>3</span>,<span class='kw'>cut</span><span class='kw'>=</span><span class='fl'>.1</span>)</div><div class='output co'>#&gt;       A3
#&gt; A3  1.00
#&gt; A5  0.50
#&gt; A2  0.49
#&gt; A4  0.36
#&gt; A1 -0.27
#&gt; C5 -0.16
#&gt; C2  0.14
#&gt; C3  0.13
#&gt; C4 -0.12</div><div class='input'><span class='co'>#to make this a latex table </span>
<span class='co'>#df2latex(bestItems(lb,2,cut=.2))</span>
<span class='co'>#</span>
<span class='fu'>data</span>(<span class='no'>bfi.dictionary</span>)
<span class='no'>f2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='fa.html'>fa</a></span>(<span class='no'>bfi</span>[<span class='fl'>1</span>:<span class='fl'>10</span>],<span class='fl'>2</span>)
<span class='fu'><a href='best.scales.html'>fa.lookup</a></span>(<span class='no'>f2</span>,<span class='no'>bfi.dictionary</span>)</div><div class='output co'>#&gt;      MR1   MR2  com   h2 ItemLabel                                      Item
#&gt; C4 -0.65  0.00 1.00 0.42     q_626           Do things in a half-way manner.
#&gt; C2  0.64 -0.01 1.00 0.40     q_530     Continue until everything is perfect.
#&gt; C1  0.57 -0.06 1.02 0.31     q_124                   Am exacting in my work.
#&gt; C5 -0.56 -0.06 1.02 0.34    q_1949                            Waste my time.
#&gt; C3  0.54  0.03 1.01 0.31     q_619            Do things according to a plan.
#&gt; A3 -0.03  0.76 1.00 0.56    q_1206               Know how to comfort others.
#&gt; A2  0.01  0.68 1.00 0.46    q_1162         Inquire about others' well-being.
#&gt; A5  0.03  0.60 1.00 0.37    q_1419                 Make people feel at ease.
#&gt; A4  0.14  0.44 1.22 0.25    q_1364                            Love children.
#&gt; A1  0.08 -0.41 1.08 0.15     q_146 Am indifferent to the feelings of others.
#&gt;       Giant3              Big6        Little12 Keying IPIP100
#&gt; C4 Stability Conscientiousness Industriousness     -1    B5:C
#&gt; C2 Stability Conscientiousness     Orderliness      1    B5:C
#&gt; C1 Stability Conscientiousness     Orderliness      1    B5:C
#&gt; C5 Stability Conscientiousness Industriousness     -1    B5:C
#&gt; C3 Stability Conscientiousness     Orderliness      1    B5:C
#&gt; A3  Cohesion     Agreeableness      Compassion      1    B5:A
#&gt; A2  Cohesion     Agreeableness      Compassion      1    B5:A
#&gt; A5  Cohesion     Agreeableness      Compassion      1    B5:A
#&gt; A4  Cohesion     Agreeableness      Compassion      1    B5:A
#&gt; A1  Cohesion     Agreeableness      Compassion     -1    B5:A</div><div class='input'>
<span class='no'>sa1</span> <span class='kw'>&lt;-</span><span class='no'>sat.act</span>[<span class='fl'>1</span>:<span class='fl'>2</span>]
<span class='no'>sa2</span> <span class='kw'>&lt;-</span> <span class='no'>sat.act</span>[<span class='fl'>3</span>:<span class='fl'>4</span>]
<span class='no'>sa3</span> <span class='kw'>&lt;-</span> <span class='no'>sat.act</span>[<span class='fl'>5</span>:<span class='fl'>6</span>]
<span class='fu'>cor2</span>(<span class='no'>sa1</span>,<span class='no'>sa2</span>)</div><div class='output co'>#&gt;             age   ACT
#&gt; gender    -0.02 -0.04
#&gt; education  0.55  0.15</div><div class='input'><span class='fu'>cor2</span>(<span class='fu'>list</span>(<span class='no'>sa1</span>,<span class='no'>sa2</span>))  <span class='co'>#show within set and between set cors</span></div><div class='output co'>#&gt;           gendr edctn age   ACT  
#&gt; gender     1.00                  
#&gt; education  0.09  1.00            
#&gt; age       -0.02  0.55  1.00      
#&gt; ACT       -0.04  0.15  0.11  1.00</div><div class='input'><span class='fu'>cor2</span>(<span class='fu'>list</span>(<span class='no'>sa1</span>,<span class='no'>sa2</span>,<span class='no'>sa3</span>))</div><div class='output co'>#&gt;           gendr edctn age   ACT   SATV  SATQ 
#&gt; gender     1.00                              
#&gt; education  0.09  1.00                        
#&gt; age       -0.02  0.55  1.00                  
#&gt; ACT       -0.04  0.15  0.11  1.00            
#&gt; SATV      -0.02  0.05 -0.04  0.56  1.00      
#&gt; SATQ      -0.17  0.03 -0.03  0.59  0.64  1.00</div><div class='input'>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by William Revelle.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
