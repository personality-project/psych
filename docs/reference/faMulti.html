<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Multi level (hierarchical) factor analysis — fa.multi • psych</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>

<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">psych</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Multi level (hierarchical) factor analysis</h1>
    </div>

    
    <p>Some factor analytic solutions produce correlated factors which may in turn be factored.  If the solution has one higher order, the omega function is most appropriate.  But, in the case of multi higher order factors, then the faMulti function will do a lower level factoring and then factor the resulting correlation matrix.  Multi level factor diagrams are also shown.</p>
    

    <pre class="usage"><span class='fu'>fa.multi</span>(<span class='no'>r</span>, <span class='kw'>nfactors</span> <span class='kw'>=</span> <span class='fl'>3</span>, <span class='kw'>nfact2</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>n.obs</span> <span class='kw'>=</span> <span class='fl'>NA</span>, <span class='kw'>n.iter</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>rotate</span> <span class='kw'>=</span> <span class='st'>"oblimin"</span>,
 <span class='kw'>scores</span> <span class='kw'>=</span> <span class='st'>"regression"</span>, <span class='kw'>residuals</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>SMC</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>covar</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>missing</span> <span class='kw'>=</span>
 <span class='fl'>FALSE</span>,<span class='kw'>impute</span> <span class='kw'>=</span> <span class='st'>"median"</span>, <span class='kw'>min.err</span> <span class='kw'>=</span> <span class='fl'>0.001</span>, <span class='kw'>max.iter</span> <span class='kw'>=</span> <span class='fl'>50</span>, <span class='kw'>symmetric</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>warnings</span>
 <span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>fm</span> <span class='kw'>=</span> <span class='st'>"minres"</span>, <span class='kw'>alpha</span> <span class='kw'>=</span> <span class='fl'>0.1</span>, <span class='kw'>p</span> <span class='kw'>=</span> <span class='fl'>0.05</span>, <span class='kw'>oblique.scores</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>np.obs</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
 <span class='kw'>use</span> <span class='kw'>=</span><span class='st'>"pairwise"</span>, <span class='kw'>cor</span> <span class='kw'>=</span> <span class='st'>"cor"</span>, <span class='no'>...</span>)

<span class='fu'>fa.multi.diagram</span>(<span class='no'>multi.results</span>,<span class='kw'>sort</span><span class='kw'>=</span><span class='fl'>TRUE</span>,<span class='kw'>labels</span><span class='kw'>=</span><span class='kw'>NULL</span>,<span class='kw'>flabels</span><span class='kw'>=</span><span class='kw'>NULL</span>,<span class='kw'>cut</span><span class='kw'>=</span><span class='fl'>.2</span>,<span class='kw'>gcut</span><span class='kw'>=</span><span class='fl'>.2</span>,
    <span class='kw'>simple</span><span class='kw'>=</span><span class='fl'>TRUE</span>,<span class='kw'>errors</span><span class='kw'>=</span><span class='fl'>FALSE</span>,
    <span class='kw'>digits</span><span class='kw'>=</span><span class='fl'>1</span>,<span class='kw'>e.size</span><span class='kw'>=</span><span class='fl'>.1</span>,<span class='kw'>rsize</span><span class='kw'>=</span><span class='fl'>.15</span>,<span class='kw'>side</span><span class='kw'>=</span><span class='fl'>3</span>,<span class='kw'>main</span><span class='kw'>=</span><span class='kw'>NULL</span>,<span class='kw'>cex</span><span class='kw'>=</span><span class='kw'>NULL</span>,<span class='kw'>color.lines</span><span class='kw'>=</span><span class='fl'>TRUE</span>
    ,<span class='kw'>marg</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>.5</span>,<span class='fl'>.5</span>,<span class='fl'>1.5</span>,<span class='fl'>.5</span>),<span class='kw'>adj</span><span class='kw'>=</span><span class='fl'>2</span>, <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>r</th>
      <td><p>A correlation matrix or raw data matrix</p></td>
    </tr>
    <tr>
      <th>nfactors</th>
      <td><p>The desired number of factors for the lower level</p></td>
    </tr>
    <tr>
      <th>nfact2</th>
      <td><p>The desired number of factors for the higher level</p></td>
    </tr>
    <tr>
      <th>n.obs</th>
      <td><p>Number of observations used to find the correlation matrix if using a correlation matrix.  Used for finding the goodness of fit statistics. Must be specified if using a correlaton matrix and finding confidence intervals.</p></td>
    </tr>
    <tr>
      <th>np.obs</th>
      <td><p>The pairwise number of observations. Used if using a correlation matrix and asking for a minchi solution.</p></td>
    </tr>
    <tr>
      <th>rotate</th>
      <td><p>"none", "varimax", "quartimax",  "bentlerT", "equamax", "varimin", "geominT" and "bifactor" are orthogonal rotations.  "promax", "oblimin", "simplimax", "bentlerQ,  "geominQ" and "biquartimin" and "cluster" are possible oblique transformations of the solution.  The default is to do a oblimin transformation, although  versions prior to 2009 defaulted to varimax.</p></td>
    </tr>
    <tr>
      <th>n.iter</th>
      <td><p>Number of bootstrap interations to do in fa or fa.poly</p></td>
    </tr>
    <tr>
      <th>residuals</th>
      <td><p>Should the residual matrix be shown</p></td>
    </tr>
    <tr>
      <th>scores</th>
      <td><p>the default="regression" finds factor scores using regression.  Alternatives for  estimating factor scores include simple regression ("Thurstone"), correlaton preserving ("tenBerge") as well as "Anderson" and "Bartlett" using the appropriate algorithms (see factor.scores). Although scores="tenBerge" is probably preferred for most solutions, it will lead to problems with some improper correlation matrices.</p></td>
    </tr>
    <tr>
      <th>SMC</th>
      <td><p>Use squared multiple correlations (SMC=TRUE) or use 1  as initial communality estimate. Try using 1 if imaginary eigen values are reported. If SMC is a vector of length the number of variables, then these values are used as starting values in the case of fm='pa'.</p></td>
    </tr>
    <tr>
      <th>covar</th>
      <td><p>if covar is TRUE, factor the covariance matrix, otherwise factor the correlation matrix</p></td>
    </tr>
    <tr>
      <th>missing</th>
      <td><p>if scores are TRUE, and missing=TRUE, then impute missing values using either the median or the mean</p></td>
    </tr>
    <tr>
      <th>impute</th>
      <td><p>"median" or "mean" values are used to replace missing values</p></td>
    </tr>
    <tr>
      <th>min.err</th>
      <td><p>Iterate until the change in communalities is less than min.err</p></td>
    </tr>
    <tr>
      <th>max.iter</th>
      <td><p>Maximum number of iterations for convergence</p></td>
    </tr>
    <tr>
      <th>symmetric</th>
      <td><p>symmetric=TRUE forces symmetry by just looking at the lower off diagonal values</p></td>
    </tr>
    <tr>
      <th>warnings</th>
      <td><p>warnings=TRUE =&gt; warn if number of factors is too many</p></td>
    </tr>
    <tr>
      <th>fm</th>
      <td><p>factoring method  fm="minres" will do a minimum residual (OLS), fm="wls" will do a weighted least squares (WLS) solution, fm="gls" does a generalized weighted least squares (GLS), fm="pa" will do the principal factor solution, fm="ml" will do a maximum likelihood factor analysis. fm="minchi" will minimize the sample size weighted chi square when treating pairwise correlations with different number of subjects per pair.</p></td>
    </tr>
    <tr>
      <th>alpha</th>
      <td><p>alpha level for the confidence intervals for RMSEA</p></td>
    </tr>
    <tr>
      <th>p</th>
      <td><p>if doing iterations to find confidence intervals, what probability values should be found for the confidence intervals</p></td>
    </tr>
    <tr>
      <th>oblique.scores</th>
      <td><p>When factor scores are found, should they be based on the structure matrix (default) or the pattern matrix (oblique.scores=TRUE).</p></td>
    </tr>
    <tr>
      <th>use</th>
      <td><p>How to treat missing data, use="pairwise" is the default".  See cor for other options.</p></td>
    </tr>
    <tr>
      <th>cor</th>
      <td><p>How to find the correlations: "cor" is Pearson", "cov" is covariance, 
  "tet" is tetrachoric, "poly" is polychoric, "mixed" uses mixed cor for a mixture of tetrachorics, polychorics, Pearsons, biserials, and polyserials, Yuleb is Yulebonett, Yuleq and YuleY are the obvious Yule coefficients as appropriate</p></td>
    </tr>
    <tr>
      <th>multi.results</th>
      <td><p>The results from fa.multi</p></td>
    </tr>
    <tr>
      <th>labels</th>
      <td><p>variable labels</p></td>
    </tr>
    <tr>
      <th>flabels</th>
      <td><p>Labels for the factors (not counting g)</p></td>
    </tr>
    <tr>
      <th>size</th>
      <td><p>size of graphics window</p></td>
    </tr>
    <tr>
      <th>digits</th>
      <td><p>Precision of labels</p></td>
    </tr>
    <tr>
      <th>cex</th>
      <td><p>control font size</p></td>
    </tr>
    <tr>
      <th>color.lines</th>
      <td><p>Use black for positive, red for negative</p></td>
    </tr>
    <tr>
      <th>marg</th>
      <td><p>The margins for the figure are set to be wider than normal by default</p></td>
    </tr>
    <tr>
      <th>adj</th>
      <td><p>Adjust the location of the factor loadings to vary as factor mod 4 + 1</p></td>
    </tr>
    <tr>
      <th>main</th>
      <td><p>main figure caption</p></td>
    </tr>
    <tr>
      <th>&#8230;</th>
      <td><p>additional parameters, specifically, keys may be passed if using the target rotation, or delta if using geominQ, or whether to normalize if using Varimax.  In addition, for fa.multi.diagram, other options to pass into the graphics packages</p></td>
    </tr>
    <tr>
      <th>e.size</th>
      <td><p>the size to draw the ellipses for the factors. This is scaled by the  number of variables.</p></td>
    </tr>
    <tr>
      <th>cut</th>
      <td><p>Minimum path coefficient to draw</p></td>
    </tr>
    <tr>
      <th>gcut</th>
      <td><p>Minimum general factor path to draw</p></td>
    </tr>
    <tr>
      <th>simple</th>
      <td><p>draw just one path per item</p></td>
    </tr>
    <tr>
      <th>sort</th>
      <td><p>sort the solution before making the diagram</p></td>
    </tr>
    <tr>
      <th>side</th>
      <td><p>on which side should errors  be drawn?</p></td>
    </tr>
    <tr>
      <th>errors</th>
      <td><p>show the error estimates</p></td>
    </tr>
    <tr>
      <th>rsize</th>
      <td><p>size of the rectangles</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>See <code><a href='fa.html'>fa</a></code> and <code><a href='omega.html'>omega</a></code> for a discussion of factor analysis and of the case of one higher order factor.</p>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    

<dt>f1</dt><dd><p>The standard output from a factor analysis from  <code>fa</code> for the raw variables</p></dd>
<dt>f2</dt><dd><p>The standard output from a factor analysis from  <code>fa</code> for the correlation matrix of the level 1 solution.</p></dd>

    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Revelle, William. (in prep) An introduction to psychometric theory with applications in R. Springer.  Working draft available at <a href = 'http://personality-project.org/r/book/'>http://personality-project.org/r/book/</a></p>
    
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>This is clearly an early implementation (Feb 14 2016) which might be improved.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <p><code><a href='fa.html'>fa</a></code>, <code><a href='omega.html'>omega</a></code></p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='no'>f31</span> <span class='kw'>&lt;-</span> <span class='fu'>fa.multi</span>(<span class='no'>Thurstone</span>,<span class='fl'>3</span>,<span class='fl'>1</span>) <span class='co'>#compare with \code{\link{omega}}</span>
<span class='no'>f31</span></div><div class='output co'>#&gt; $f1
#&gt; Factor Analysis using method =  minres
#&gt; Call: fa(r = r, nfactors = nfactors, n.obs = n.obs, rotate = rotate, 
#&gt;     scores = scores, residuals = residuals, SMC = SMC, covar = covar, 
#&gt;     missing = missing, impute = impute, min.err = min.err, max.iter = max.iter, 
#&gt;     symmetric = symmetric, warnings = warnings, fm = fm, alpha = alpha, 
#&gt;     oblique.scores = oblique.scores, np.obs = np.obs, use = use, 
#&gt;     cor = cor)
#&gt; Standardized loadings (pattern matrix) based upon correlation matrix
#&gt;                     MR1   MR2   MR3   h2   u2 com
#&gt; Sentences          0.90 -0.03  0.04 0.82 0.18 1.0
#&gt; Vocabulary         0.89  0.06 -0.03 0.84 0.16 1.0
#&gt; Sent.Completion    0.84  0.03  0.00 0.74 0.26 1.0
#&gt; First.Letters      0.00  0.85  0.00 0.73 0.27 1.0
#&gt; Four.Letter.Words -0.02  0.75  0.10 0.63 0.37 1.0
#&gt; Suffixes           0.18  0.63 -0.08 0.50 0.50 1.2
#&gt; Letter.Series      0.03 -0.01  0.84 0.73 0.27 1.0
#&gt; Pedigrees          0.38 -0.05  0.46 0.51 0.49 2.0
#&gt; Letter.Group      -0.06  0.21  0.63 0.52 0.48 1.2
#&gt; 
#&gt;                        MR1  MR2  MR3
#&gt; SS loadings           2.65 1.87 1.49
#&gt; Proportion Var        0.29 0.21 0.17
#&gt; Cumulative Var        0.29 0.50 0.67
#&gt; Proportion Explained  0.44 0.31 0.25
#&gt; Cumulative Proportion 0.44 0.75 1.00
#&gt; 
#&gt;  With factor correlations of 
#&gt;      MR1  MR2  MR3
#&gt; MR1 1.00 0.59 0.53
#&gt; MR2 0.59 1.00 0.52
#&gt; MR3 0.53 0.52 1.00
#&gt; 
#&gt; Mean item complexity =  1.2
#&gt; Test of the hypothesis that 3 factors are sufficient.
#&gt; 
#&gt; The degrees of freedom for the null model are  36  and the objective function was  5.2
#&gt; The degrees of freedom for the model are 12  and the objective function was  0.01 
#&gt; 
#&gt; The root mean square of the residuals (RMSR) is  0.01 
#&gt; The df corrected root mean square of the residuals is  0.01 
#&gt; 
#&gt; Fit based upon off diagonal values = 1
#&gt; Measures of factor score adequacy             
#&gt;                                                 MR1  MR2  MR3
#&gt; Correlation of scores with factors             0.96 0.92 0.90
#&gt; Multiple R square of scores with factors       0.93 0.85 0.82
#&gt; Minimum correlation of possible factor scores  0.86 0.71 0.63
#&gt; 
#&gt; $f2
#&gt; Factor Analysis using method =  minres
#&gt; Call: fa(r = f1$Phi, nfactors = nfact2, rotate = rotate)
#&gt; Standardized loadings (pattern matrix) based upon correlation matrix
#&gt;      MR1   h2   u2 com
#&gt; MR1 0.78 0.61 0.39   1
#&gt; MR2 0.76 0.57 0.43   1
#&gt; MR3 0.68 0.46 0.54   1
#&gt; 
#&gt;                 MR1
#&gt; SS loadings    1.65
#&gt; Proportion Var 0.55
#&gt; 
#&gt; Mean item complexity =  1
#&gt; Test of the hypothesis that 1 factor is sufficient.
#&gt; 
#&gt; The degrees of freedom for the null model are  3  and the objective function was  0.86
#&gt; The degrees of freedom for the model are 0  and the objective function was  0 
#&gt; 
#&gt; The root mean square of the residuals (RMSR) is  0 
#&gt; The df corrected root mean square of the residuals is  NA 
#&gt; 
#&gt; Fit based upon off diagonal values = 1
#&gt; Measures of factor score adequacy             
#&gt;                                                 MR1
#&gt; Correlation of scores with factors             0.89
#&gt; Multiple R square of scores with factors       0.79
#&gt; Minimum correlation of possible factor scores  0.58
#&gt; </div><div class='input'><span class='fu'>fa.multi.diagram</span>(<span class='no'>f31</span>)</div><img src='faMulti-4.png' alt='' width='540' height='400' /></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#details">Details</a></li>

      <li><a href="#value">Value</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#note">Note</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    
William Revelle

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by William Revelle.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
