<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Perform bifactor, promax or targeted rotations and return the inter factor angles. — Promax • psych</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>

<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">psych</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Perform bifactor, promax or targeted rotations and return the inter factor angles.</h1>
    </div>

    
    <p>The bifactor rotation implements the rotation introduced by Jennrich and Bentler (2011) by calling GPForth in the GPArotation package.  promax is an oblique rotation function introduced by Hendrickson and White (1964) and implemented in the promax function in the stats package.  Unfortunately, promax does not report the inter factor correlations.  Promax does.  TargetQ does a target rotation with elements that can be missing (NA), or numeric (e.g., 0, 1).  It uses the GPArotation package. target.rot does general target rotations to an arbitrary target matrix. The default target rotation is for an independent cluster solution. equamax facilitates the call to GPArotation to do an equamax rotation.  Equamax, although available as a specific option within GPArotation is easier to call by name if using equamax.  The varimin rotation suggested by Ertl (2013) is implemented by appropriate calls to GPArotation.</p>
    

    <pre class="usage"><span class='fu'>bifactor</span>(<span class='no'>L</span>, <span class='kw'>Tmat</span><span class='kw'>=</span><span class='fu'>diag</span>(<span class='fu'>ncol</span>(<span class='no'>L</span>)), <span class='kw'>normalize</span><span class='kw'>=</span><span class='fl'>FALSE</span>, <span class='kw'>eps</span><span class='kw'>=</span><span class='fl'>1e-5</span>, <span class='kw'>maxit</span><span class='kw'>=</span><span class='fl'>1000</span>)
<span class='fu'>biquartimin</span>(<span class='no'>L</span>, <span class='kw'>Tmat</span><span class='kw'>=</span><span class='fu'>diag</span>(<span class='fu'>ncol</span>(<span class='no'>L</span>)), <span class='kw'>normalize</span><span class='kw'>=</span><span class='fl'>FALSE</span>, <span class='kw'>eps</span><span class='kw'>=</span><span class='fl'>1e-5</span>, <span class='kw'>maxit</span><span class='kw'>=</span><span class='fl'>1000</span>)
<span class='fu'>TargetQ</span>(<span class='no'>L</span>, <span class='kw'>Tmat</span><span class='kw'>=</span><span class='fu'>diag</span>(<span class='fu'>ncol</span>(<span class='no'>L</span>)), <span class='kw'>normalize</span><span class='kw'>=</span><span class='fl'>FALSE</span>, <span class='kw'>eps</span><span class='kw'>=</span><span class='fl'>1e-5</span>, <span class='kw'>maxit</span><span class='kw'>=</span><span class='fl'>1000</span>,<span class='kw'>Target</span><span class='kw'>=</span><span class='kw'>NULL</span>)
<span class='fu'>Promax</span>(<span class='no'>x</span>,<span class='kw'>m</span><span class='kw'>=</span><span class='fl'>4</span>, <span class='kw'>normalize</span><span class='kw'>=</span><span class='fl'>FALSE</span>, <span class='kw'>pro.m</span> <span class='kw'>=</span> <span class='fl'>4</span>)
<span class='fu'>target.rot</span>(<span class='no'>x</span>,<span class='kw'>keys</span><span class='kw'>=</span><span class='kw'>NULL</span>)
<span class='fu'>varimin</span>(<span class='no'>L</span>, <span class='kw'>Tmat</span> <span class='kw'>=</span> <span class='fu'>diag</span>(<span class='fu'>ncol</span>(<span class='no'>L</span>)), <span class='kw'>normalize</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>eps</span> <span class='kw'>=</span> <span class='fl'>1e-05</span>, <span class='kw'>maxit</span> <span class='kw'>=</span> <span class='fl'>1000</span>)
<span class='fu'>vgQ.bimin</span>(<span class='no'>L</span>)   <span class='co'>#called by bifactor</span>
<span class='fu'>vgQ.targetQ</span>(<span class='no'>L</span>,<span class='kw'>Target</span><span class='kw'>=</span><span class='kw'>NULL</span>)  <span class='co'>#called by TargetQ</span>
<span class='fu'>vgQ.varimin</span>(<span class='no'>L</span>)  <span class='co'>#called by varimin</span>
<span class='fu'>equamax</span>(<span class='no'>L</span>, <span class='kw'>Tmat</span><span class='kw'>=</span><span class='fu'>diag</span>(<span class='fu'>ncol</span>(<span class='no'>L</span>)), <span class='kw'>eps</span><span class='kw'>=</span><span class='fl'>1e-5</span>, <span class='kw'>maxit</span><span class='kw'>=</span><span class='fl'>1000</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>A loadings matrix</p></td>
    </tr>
    <tr>
      <th>m</th>
      <td><p>the power to which to raise the varimax loadings (for Promax)</p></td>
    </tr>
    <tr>
      <th>pro.m</th>
      <td><p>the power to which to raise the various loadings in Promax.</p></td>
    </tr>
    <tr>
      <th>keys</th>
      <td><p>An arbitrary target matrix, can be composed of  any weights, but probably -1,0, 1 weights.  If missing, the target is the independent cluster structure determined by assigning every item to it's highest loaded factor.</p></td>
    </tr>
    <tr>
      <th>L</th>
      <td><p>A loadings matrix</p></td>
    </tr>
    <tr>
      <th>Target</th>
      <td><p>A matrix of values (mainly 0s, some 1s, some NAs) to which the matrix is transformed.</p></td>
    </tr>
    <tr>
      <th>Tmat</th>
      <td><p>An initial rotation matrix</p></td>
    </tr>
    <tr>
      <th>normalize</th>
      <td><p>parameter passed to optimization routine (GPForth in the GPArotation package and Promax)</p></td>
    </tr>
    <tr>
      <th>eps</th>
      <td><p>parameter passed to optimization routine (GPForth in the GPArotation package)</p></td>
    </tr>
    <tr>
      <th>maxit</th>
      <td><p>parameter passed to optimization routine (GPForth in the GPArotation package)</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The two most useful of these six functions is probably biquartimin which implements the oblique bifactor rotation introduced by Jennrich and Bentler (2011). The second is TargetQ which allows for missing NA values in the target. Next best is the orthogonal case, bifactor.  None of these seem to be implemented in GPArotation (yet).</p>
<p>The difference between biquartimin and bifactor is just that the latter is the orthogonal case which is documented in Jennrich and Bentler (2011).  It seems as if these two functions are sensitive to the starting values and random  restarts (modifying T) might be called for.</p>
<p>bifactor output for the 24 cognitive variable of Holzinger matches that of Jennrich and Bentler as does output for the Chen et al. problem when fm="mle" is used and the Jennrich and Bentler solution is rescaled from covariances to correlations.</p>
<p>Promax is a very direct adaptation of the stats::promax function.  The addition is that it will return the interfactor correlations as well as the loadings and rotation matrix.</p>
<p>varimin implements the varimin criterion proposed by Suitbert Ertl (2013).  Rather than maximize the varimax criterion, it minimizes it.  For a discussion of the benefits of this procedure, consult Ertel (2013).</p>
<p>In addition, these functions will take output from either the factanal, <code><a href='fa.html'>fa</a></code> or earlier (<code><a href='deprecated.html'>factor.pa</a></code>, <code><a href='deprecated.html'>factor.minres</a></code> or <code><a href='principal.html'>principal</a></code>)  functions and select just the loadings matrix for analysis.</p>
<p>equamax is just a call to GPArotation's cFT function (for the Crawford Ferguson family of rotations.</p>
<p>TargetQ implements Michael Browne's algorithm and allows specification of NA values. The Target input is a list (see examples).  It is interesting to note how powerful specifying what a factor isn't works in defining a factor.  That is, by specifying the pattern of 0s and letting most other elements be NA, the factor structure is still clearly defined.</p>
<p>The target.rot function is an adaptation of a function of Michael Browne's to do rotations to arbitrary target matrices.  Suggested by Pat Shrout.</p>
<p>The default for target.rot is to rotate to an independent cluster structure (every items is assigned to a group with its highest loading.)</p>
<p>target.rot will not handle targets that have linear dependencies (e.g., a pure bifactor model where there is a g loading and a group factor for all variables).</p>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p></p>
<dt>loadings </dt><dd><p>Oblique factor loadings</p></dd>
  <dt>rotmat</dt><dd><p>The rotation matrix applied to the original loadings to produce the promax solution or the targeted matrix</p></dd>
  <dt>Phi</dt><dd><p>The interfactor correlation matrix</p></dd>

    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Ertel, S. (2013). Factor analysis: healing an ailing model. Universitatsverlag Gottingen.</p>
<p>Hendrickson, A. E. and  White, P. O, 1964, British Journal of Statistical Psychology, 17, 65-70.</p>
<p>Jennrich, Robert and Bentler, Peter (2011) Exploratory Bi-Factor Analysis. Psychometrika,  1-13</p>
    
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>A direct adaptation of the stats:promax function following suggestions to the R-help list by Ulrich Keller and John Fox. Further  modified to do  targeted rotation similar to a function of Michael Browne.</p>
<p>varimin is a direct application of the GPArotation GPForth function modified to do varimin.</p>
<p></p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <p><code>promax</code>, <code><a href='fa.html'>fa</a></code>, or <code><a href='principal.html'>principal</a></code> for examples of data analysis and   <code><a href='bifactor.html'>Holzinger</a></code> or <code><a href='bifactor.html'>Bechtoldt</a></code> for  examples of bifactor data. <code><a href='factor.rotate.html'>factor.rotate</a></code> for 'hand rotation'.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='no'>jen</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='sim.hierarchical.html'>sim.hierarchical</a></span>()
<span class='no'>f3</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='fa.html'>fa</a></span>(<span class='no'>jen</span>,<span class='fl'>3</span>,<span class='kw'>rotate</span><span class='kw'>=</span><span class='st'>"varimax"</span>)
<span class='no'>f3</span>   <span class='co'>#not a very clean solution</span></div><div class='output co'>#&gt; Factor Analysis using method =  minres
#&gt; Call: fa(r = jen, nfactors = 3, rotate = "varimax")
#&gt; Standardized loadings (pattern matrix) based upon correlation matrix
#&gt;     MR1  MR3  MR2   h2   u2 com
#&gt; V1 0.70 0.30 0.26 0.64 0.36 1.6
#&gt; V2 0.61 0.26 0.22 0.49 0.51 1.6
#&gt; V3 0.52 0.22 0.19 0.36 0.64 1.6
#&gt; V4 0.24 0.63 0.18 0.49 0.51 1.5
#&gt; V5 0.21 0.54 0.16 0.36 0.64 1.5
#&gt; V6 0.17 0.45 0.13 0.25 0.75 1.5
#&gt; V7 0.17 0.15 0.56 0.36 0.64 1.3
#&gt; V8 0.14 0.12 0.46 0.25 0.75 1.3
#&gt; V9 0.11 0.10 0.37 0.16 0.84 1.3
#&gt; 
#&gt;                        MR1  MR3  MR2
#&gt; SS loadings           1.32 1.15 0.89
#&gt; Proportion Var        0.15 0.13 0.10
#&gt; Cumulative Var        0.15 0.27 0.37
#&gt; Proportion Explained  0.39 0.34 0.27
#&gt; Cumulative Proportion 0.39 0.73 1.00
#&gt; 
#&gt; Mean item complexity =  1.5
#&gt; Test of the hypothesis that 3 factors are sufficient.
#&gt; 
#&gt; The degrees of freedom for the null model are  36  and the objective function was  1.71
#&gt; The degrees of freedom for the model are 12  and the objective function was  0 
#&gt; 
#&gt; The root mean square of the residuals (RMSR) is  0 
#&gt; The df corrected root mean square of the residuals is  0 
#&gt; 
#&gt; Fit based upon off diagonal values = 1
#&gt; Measures of factor score adequacy             
#&gt;                                                 MR1  MR3   MR2
#&gt; Correlation of scores with factors             0.78 0.73  0.67
#&gt; Multiple R square of scores with factors       0.61 0.53  0.45
#&gt; Minimum correlation of possible factor scores  0.22 0.07 -0.10</div><div class='input'><span class='fu'>Promax</span>(<span class='no'>f3</span>)</div><div class='output co'>#&gt; 
#&gt; Call: NULL
#&gt; Standardized loadings (pattern matrix) based upon correlation matrix
#&gt;     MR1  MR3  MR2   h2   u2
#&gt; V1 0.76 0.04 0.03 0.64 0.36
#&gt; V2 0.66 0.03 0.02 0.49 0.51
#&gt; V3 0.57 0.03 0.02 0.36 0.64
#&gt; V4 0.01 0.69 0.01 0.49 0.51
#&gt; V5 0.01 0.59 0.01 0.36 0.64
#&gt; V6 0.01 0.49 0.01 0.25 0.75
#&gt; V7 0.00 0.00 0.60 0.36 0.64
#&gt; V8 0.00 0.00 0.50 0.25 0.75
#&gt; V9 0.00 0.00 0.40 0.16 0.84
#&gt; 
#&gt;                        MR1  MR3  MR2
#&gt; SS loadings           1.43 1.13 0.80
#&gt; Proportion Var        0.16 0.13 0.09
#&gt; Cumulative Var        0.16 0.28 0.37
#&gt; Proportion Explained  0.42 0.34 0.24
#&gt; Cumulative Proportion 0.42 0.76 1.00
#&gt;      MR1  MR3  MR2
#&gt; MR1 1.00 0.68 0.60
#&gt; MR3 0.68 1.00 0.55
#&gt; MR2 0.60 0.55 1.00</div><div class='input'><span class='fu'>target.rot</span>(<span class='no'>f3</span>)</div><div class='output co'>#&gt; 
#&gt; Call: NULL
#&gt; Standardized loadings (pattern matrix) based upon correlation matrix
#&gt;    MR1 MR3 MR2   h2   u2
#&gt; V1 0.8 0.0 0.0 0.64 0.36
#&gt; V2 0.7 0.0 0.0 0.49 0.51
#&gt; V3 0.6 0.0 0.0 0.36 0.64
#&gt; V4 0.0 0.7 0.0 0.49 0.51
#&gt; V5 0.0 0.6 0.0 0.36 0.64
#&gt; V6 0.0 0.5 0.0 0.25 0.75
#&gt; V7 0.0 0.0 0.6 0.36 0.64
#&gt; V8 0.0 0.0 0.5 0.25 0.75
#&gt; V9 0.0 0.0 0.4 0.16 0.84
#&gt; 
#&gt;                        MR1  MR3  MR2
#&gt; SS loadings           1.49 1.10 0.77
#&gt; Proportion Var        0.17 0.12 0.09
#&gt; Cumulative Var        0.17 0.29 0.37
#&gt; Proportion Explained  0.44 0.33 0.23
#&gt; Cumulative Proportion 0.44 0.77 1.00
#&gt;      MR1  MR3  MR2
#&gt; MR1 1.00 0.72 0.63
#&gt; MR3 0.72 1.00 0.56
#&gt; MR2 0.63 0.56 1.00</div><div class='input'><span class='no'>m3</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='fa.html'>fa</a></span>(<span class='no'>jen</span>,<span class='kw'>nfactors</span><span class='kw'>=</span><span class='fl'>3</span>)
<span class='fu'>Promax</span>(<span class='no'>m3</span>)  <span class='co'>#example of taking the output from factanal</span></div><div class='output co'>#&gt; 
#&gt; Call: NULL
#&gt; Standardized loadings (pattern matrix) based upon correlation matrix
#&gt;    MR1 MR3 MR2   h2   u2
#&gt; V1 0.8 0.0 0.0 0.64 0.36
#&gt; V2 0.7 0.0 0.0 0.49 0.51
#&gt; V3 0.6 0.0 0.0 0.36 0.64
#&gt; V4 0.0 0.7 0.0 0.49 0.51
#&gt; V5 0.0 0.6 0.0 0.36 0.64
#&gt; V6 0.0 0.5 0.0 0.25 0.75
#&gt; V7 0.0 0.0 0.6 0.36 0.64
#&gt; V8 0.0 0.0 0.5 0.25 0.75
#&gt; V9 0.0 0.0 0.4 0.16 0.84
#&gt; 
#&gt;                        MR1  MR3  MR2
#&gt; SS loadings           1.49 1.10 0.77
#&gt; Proportion Var        0.17 0.12 0.09
#&gt; Cumulative Var        0.17 0.29 0.37
#&gt; Proportion Explained  0.44 0.33 0.23
#&gt; Cumulative Proportion 0.44 0.77 1.00
#&gt;     MR1 MR3 MR2
#&gt; MR1   1   0   0
#&gt; MR3   0   1   0
#&gt; MR2   0   0   1</div><div class='input'><span class='co'>#compare this rotation with the solution from a targeted rotation aimed for </span>
<span class='co'>#an independent cluster solution</span>
<span class='fu'>target.rot</span>(<span class='no'>m3</span>)</div><div class='output co'>#&gt; 
#&gt; Call: NULL
#&gt; Standardized loadings (pattern matrix) based upon correlation matrix
#&gt;    MR1 MR3 MR2   h2   u2
#&gt; V1 0.8 0.0 0.0 0.64 0.36
#&gt; V2 0.7 0.0 0.0 0.49 0.51
#&gt; V3 0.6 0.0 0.0 0.36 0.64
#&gt; V4 0.0 0.7 0.0 0.49 0.51
#&gt; V5 0.0 0.6 0.0 0.36 0.64
#&gt; V6 0.0 0.5 0.0 0.25 0.75
#&gt; V7 0.0 0.0 0.6 0.36 0.64
#&gt; V8 0.0 0.0 0.5 0.25 0.75
#&gt; V9 0.0 0.0 0.4 0.16 0.84
#&gt; 
#&gt;                        MR1  MR3  MR2
#&gt; SS loadings           1.49 1.10 0.77
#&gt; Proportion Var        0.17 0.12 0.09
#&gt; Cumulative Var        0.17 0.29 0.37
#&gt; Proportion Explained  0.44 0.33 0.23
#&gt; Cumulative Proportion 0.44 0.77 1.00
#&gt;     MR1 MR3 MR2
#&gt; MR1   1   0   0
#&gt; MR3   0   1   0
#&gt; MR2   0   0   1</div><div class='input'><span class='co'>#now try a bifactor solution</span>
<span class='no'>fb</span> <span class='kw'>&lt;-</span><span class='fu'><a href='fa.html'>fa</a></span>(<span class='no'>jen</span>,<span class='fl'>3</span>,<span class='kw'>rotate</span><span class='kw'>=</span><span class='st'>"bifactor"</span>)
<span class='no'>fq</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='fa.html'>fa</a></span>(<span class='no'>jen</span>,<span class='fl'>3</span>,<span class='kw'>rotate</span><span class='kw'>=</span><span class='st'>"biquartimin"</span>)
<span class='co'>#Suitbert Ertel has suggested varimin</span>
<span class='no'>fm</span> <span class='kw'>&lt;-</span>  <span class='fu'><a href='fa.html'>fa</a></span>(<span class='no'>jen</span>,<span class='fl'>3</span>,<span class='kw'>rotate</span><span class='kw'>=</span><span class='st'>"varimin"</span>) <span class='co'>#the Ertel varimin</span>
<span class='no'>fn</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='fa.html'>fa</a></span>(<span class='no'>jen</span>,<span class='fl'>3</span>,<span class='kw'>rotate</span><span class='kw'>=</span><span class='st'>"none"</span>)  <span class='co'>#just the unrotated factors</span>
<span class='co'>#compare them</span>
<span class='fu'><a href='factor.congruence.html'>factor.congruence</a></span>(<span class='fu'>list</span>(<span class='no'>f3</span>,<span class='no'>fb</span>,<span class='no'>fq</span>,<span class='no'>fm</span>,<span class='no'>fn</span>))</div><div class='output co'>#&gt;       MR1   MR3  MR2  MR1   MR3   MR2   MR1   MR3   MR2  MR1   MR2   MR3  MR1
#&gt; MR1  1.00  0.71 0.66 0.87  0.93 -0.02  0.92  0.93 -0.01 0.87  0.78  0.63 0.92
#&gt; MR3  0.71  1.00 0.61 0.92  0.42 -0.36  0.89  0.42 -0.34 0.88  0.75 -0.08 0.89
#&gt; MR2  0.66  0.61 1.00 0.84  0.41  0.52  0.82  0.41  0.54 0.88  0.16  0.40 0.82
#&gt; MR1  0.87  0.92 0.84 1.00  0.61  0.00  0.99  0.61  0.01 1.00  0.65  0.27 0.99
#&gt; MR3  0.93  0.42 0.41 0.61  1.00  0.00  0.71  1.00  0.00 0.62  0.73  0.80 0.71
#&gt; MR2 -0.02 -0.36 0.52 0.00  0.00  1.00 -0.01  0.00  1.00 0.09 -0.63  0.53 0.00
#&gt; MR1  0.92  0.89 0.82 0.99  0.71 -0.01  1.00  0.71  0.01 0.99  0.70  0.37 1.00
#&gt; MR3  0.93  0.42 0.41 0.61  1.00  0.00  0.71  1.00  0.00 0.62  0.73  0.80 0.71
#&gt; MR2 -0.01 -0.34 0.54 0.01  0.00  1.00  0.01  0.00  1.00 0.11 -0.63  0.52 0.01
#&gt; MR1  0.87  0.88 0.88 1.00  0.62  0.09  0.99  0.62  0.11 1.00  0.59  0.33 0.99
#&gt; MR2  0.78  0.75 0.16 0.65  0.73 -0.63  0.70  0.73 -0.63 0.59  1.00  0.18 0.70
#&gt; MR3  0.63 -0.08 0.40 0.27  0.80  0.53  0.37  0.80  0.52 0.33  0.18  1.00 0.37
#&gt; MR1  0.92  0.89 0.82 0.99  0.71  0.00  1.00  0.71  0.01 0.99  0.70  0.37 1.00
#&gt; MR2 -0.01 -0.36 0.52 0.00  0.02  1.00  0.00  0.02  1.00 0.09 -0.62  0.55 0.00
#&gt; MR3 -0.38  0.28 0.25 0.13 -0.70  0.02  0.00 -0.70  0.03 0.12 -0.35 -0.75 0.00
#&gt;       MR2   MR3
#&gt; MR1 -0.01 -0.38
#&gt; MR3 -0.36  0.28
#&gt; MR2  0.52  0.25
#&gt; MR1  0.00  0.13
#&gt; MR3  0.02 -0.70
#&gt; MR2  1.00  0.02
#&gt; MR1  0.00  0.00
#&gt; MR3  0.02 -0.70
#&gt; MR2  1.00  0.03
#&gt; MR1  0.09  0.12
#&gt; MR2 -0.62 -0.35
#&gt; MR3  0.55 -0.75
#&gt; MR1  0.00  0.00
#&gt; MR2  1.00  0.00
#&gt; MR3  0.00  1.00</div><div class='input'><span class='co'># compare an oblimin with a target rotation using the Browne algorithm</span>
 <span class='co'>#note that we are changing the factor #order (this is for demonstration only)</span>
 <span class='no'>Targ</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='make.keys.html'>make.keys</a></span>(<span class='fl'>9</span>,<span class='fu'>list</span>(<span class='kw'>f1</span><span class='kw'>=</span><span class='fl'>1</span>:<span class='fl'>3</span>,<span class='kw'>f2</span><span class='kw'>=</span><span class='fl'>7</span>:<span class='fl'>9</span>,<span class='kw'>f3</span><span class='kw'>=</span><span class='fl'>4</span>:<span class='fl'>6</span>))
 <span class='no'>Targ</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='scrub.html'>scrub</a></span>(<span class='no'>Targ</span>,<span class='kw'>isvalue</span><span class='kw'>=</span><span class='fl'>1</span>)  <span class='co'>#fix the 0s, allow the NAs to be estimated</span>
 <span class='no'>Targ</span> <span class='kw'>&lt;-</span> <span class='fu'>list</span>(<span class='no'>Targ</span>)  <span class='co'>#input must be a list</span>
<span class='co'>#show the target</span>
 <span class='no'>Targ</span></div><div class='output co'>#&gt; [[1]]
#&gt;       f1 f2 f3
#&gt;  [1,] NA  0  0
#&gt;  [2,] NA  0  0
#&gt;  [3,] NA  0  0
#&gt;  [4,]  0  0 NA
#&gt;  [5,]  0  0 NA
#&gt;  [6,]  0  0 NA
#&gt;  [7,]  0 NA  0
#&gt;  [8,]  0 NA  0
#&gt;  [9,]  0 NA  0
#&gt; </div><div class='input'> <span class='fu'><a href='fa.html'>fa</a></span>(<span class='no'>Thurstone</span>,<span class='fl'>3</span>,<span class='kw'>rotate</span><span class='kw'>=</span><span class='st'>"TargetQ"</span>,<span class='kw'>Target</span><span class='kw'>=</span><span class='no'>Targ</span>)  <span class='co'>#targeted rotation</span></div><div class='output co'>#&gt; Factor Analysis using method =  minres
#&gt; Call: fa(r = Thurstone, nfactors = 3, rotate = "TargetQ", Target = Targ)
#&gt; Standardized loadings (pattern matrix) based upon correlation matrix
#&gt;                     MR1   MR3   MR2   h2   u2 com
#&gt; Sentences          0.86 -0.01  0.08 0.82 0.18 1.0
#&gt; Vocabulary         0.85  0.10  0.00 0.84 0.16 1.0
#&gt; Sent.Completion    0.80  0.06  0.04 0.74 0.26 1.0
#&gt; First.Letters     -0.01  0.86  0.00 0.73 0.27 1.0
#&gt; Four.Letter.Words -0.04  0.75  0.11 0.63 0.37 1.0
#&gt; Suffixes           0.17  0.64 -0.08 0.50 0.50 1.2
#&gt; Letter.Series     -0.05 -0.07  0.92 0.73 0.27 1.0
#&gt; Pedigrees          0.32 -0.07  0.52 0.51 0.49 1.7
#&gt; Letter.Group      -0.12  0.17  0.68 0.52 0.48 1.2
#&gt; 
#&gt;                        MR1  MR3  MR2
#&gt; SS loadings           2.41 1.88 1.71
#&gt; Proportion Var        0.27 0.21 0.19
#&gt; Cumulative Var        0.27 0.48 0.67
#&gt; Proportion Explained  0.40 0.31 0.28
#&gt; Cumulative Proportion 0.40 0.72 1.00
#&gt; 
#&gt;  With factor correlations of 
#&gt;      MR1  MR3  MR2
#&gt; MR1 1.00 0.57 0.58
#&gt; MR3 0.57 1.00 0.59
#&gt; MR2 0.58 0.59 1.00
#&gt; 
#&gt; Mean item complexity =  1.1
#&gt; Test of the hypothesis that 3 factors are sufficient.
#&gt; 
#&gt; The degrees of freedom for the null model are  36  and the objective function was  5.2
#&gt; The degrees of freedom for the model are 12  and the objective function was  0.01 
#&gt; 
#&gt; The root mean square of the residuals (RMSR) is  0.01 
#&gt; The df corrected root mean square of the residuals is  0.01 
#&gt; 
#&gt; Fit based upon off diagonal values = 1
#&gt; Measures of factor score adequacy             
#&gt;                                                 MR1  MR3  MR2
#&gt; Correlation of scores with factors             0.96 0.92 0.92
#&gt; Multiple R square of scores with factors       0.92 0.86 0.84
#&gt; Minimum correlation of possible factor scores  0.84 0.71 0.69</div><div class='input'><span class='co'>#compare with oblimin</span>
<span class='fu'><a href='fa.html'>fa</a></span>(<span class='no'>Thurstone</span>,<span class='fl'>3</span>)</div><div class='output co'>#&gt; Factor Analysis using method =  minres
#&gt; Call: fa(r = Thurstone, nfactors = 3)
#&gt; Standardized loadings (pattern matrix) based upon correlation matrix
#&gt;                     MR1   MR2   MR3   h2   u2 com
#&gt; Sentences          0.90 -0.03  0.04 0.82 0.18 1.0
#&gt; Vocabulary         0.89  0.06 -0.03 0.84 0.16 1.0
#&gt; Sent.Completion    0.84  0.03  0.00 0.74 0.26 1.0
#&gt; First.Letters      0.00  0.85  0.00 0.73 0.27 1.0
#&gt; Four.Letter.Words -0.02  0.75  0.10 0.63 0.37 1.0
#&gt; Suffixes           0.18  0.63 -0.08 0.50 0.50 1.2
#&gt; Letter.Series      0.03 -0.01  0.84 0.73 0.27 1.0
#&gt; Pedigrees          0.38 -0.05  0.46 0.51 0.49 2.0
#&gt; Letter.Group      -0.06  0.21  0.63 0.52 0.48 1.2
#&gt; 
#&gt;                        MR1  MR2  MR3
#&gt; SS loadings           2.65 1.87 1.49
#&gt; Proportion Var        0.29 0.21 0.17
#&gt; Cumulative Var        0.29 0.50 0.67
#&gt; Proportion Explained  0.44 0.31 0.25
#&gt; Cumulative Proportion 0.44 0.75 1.00
#&gt; 
#&gt;  With factor correlations of 
#&gt;      MR1  MR2  MR3
#&gt; MR1 1.00 0.59 0.53
#&gt; MR2 0.59 1.00 0.52
#&gt; MR3 0.53 0.52 1.00
#&gt; 
#&gt; Mean item complexity =  1.2
#&gt; Test of the hypothesis that 3 factors are sufficient.
#&gt; 
#&gt; The degrees of freedom for the null model are  36  and the objective function was  5.2
#&gt; The degrees of freedom for the model are 12  and the objective function was  0.01 
#&gt; 
#&gt; The root mean square of the residuals (RMSR) is  0.01 
#&gt; The df corrected root mean square of the residuals is  0.01 
#&gt; 
#&gt; Fit based upon off diagonal values = 1
#&gt; Measures of factor score adequacy             
#&gt;                                                 MR1  MR2  MR3
#&gt; Correlation of scores with factors             0.96 0.92 0.90
#&gt; Multiple R square of scores with factors       0.93 0.85 0.82
#&gt; Minimum correlation of possible factor scores  0.86 0.71 0.63</div><div class='input'>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#details">Details</a></li>

      <li><a href="#value">Value</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#note">Note</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    William Revelle 
  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by William Revelle.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
